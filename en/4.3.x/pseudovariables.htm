
<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>cookbooks:4.2.x:pseudovariables [Kamailio SIP Server Wiki]</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="cookbooks,4.2.x,pseudovariables"/>
<link rel="search" type="application/opensearchdescription+xml" href="/wiki/lib/exe/opensearch.php" title="Kamailio SIP Server Wiki"/>
<link rel="start" href="/wiki/"/>
<link rel="contents" href="/wiki/cookbooks/4.2.x/pseudovariables?do=index" title="Sitemap"/>
<link rel="alternate" type="application/rss+xml" title="Recent changes" href="/wiki/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current namespace" href="/wiki/feed.php?mode=list&amp;ns=cookbooks:4.2.x"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="/wiki/_export/xhtml/cookbooks/4.2.x/pseudovariables"/>
<link rel="alternate" type="text/plain" title="Wiki Markup" href="/wiki/_export/raw/cookbooks/4.2.x/pseudovariables"/>
<link rel="canonical" href="http://www.kamailio.org/wiki/cookbooks/4.2.x/pseudovariables"/>
<link rel="stylesheet" type="text/css" href="/wiki/lib/exe/css.php?t=dokuwiki&amp;tseed=31a24d7ffe415049536e293898fc9d2f"/>
<script type="text/javascript">/*<![CDATA[*/var NS='cookbooks:4.2.x';var JSINFO = {"id":"cookbooks:4.2.x:pseudovariables","namespace":"cookbooks:4.2.x"};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="/wiki/lib/exe/js.php?tseed=31a24d7ffe415049536e293898fc9d2f"></script>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="shortcut icon" href="/wiki/lib/tpl/dokuwiki/images/favicon.ico" />
<link rel="apple-touch-icon" href="/wiki/lib/tpl/dokuwiki/images/apple-touch-icon.png" />
    </head>

<body>
    <!--[if lte IE 7 ]><div id="IE7"><![endif]--><!--[if IE 8 ]><div id="IE8"><![endif]-->
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_dokuwiki    showSidebar hasSidebar">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header"><div class="pad group">

    
    <div class="headings group">
        <ul class="a11y skip">
            <li><a href="#dokuwiki__content">skip to content</a></li>
        </ul>

        <h1><a href="/wiki/start"  accesskey="h" title="[H]"><img src="/wiki/lib/tpl/dokuwiki/images/logo.png" width="64" height="64" alt="" /> <span>Kamailio SIP Server Wiki</span></a></h1>
            </div>

    <div class="tools group">
        <!-- USER TOOLS -->
                    <div id="dokuwiki__usertools">
                <h3 class="a11y">User Tools</h3>
                <ul>
                    <li><a href="/wiki/cookbooks/4.2.x/pseudovariables?do=register"  class="action register" rel="nofollow" title="Register">Register</a></li><li><a href="/wiki/cookbooks/4.2.x/pseudovariables?do=login&amp;sectok=558c40251c68d531f923d969af598d3a"  class="action login" rel="nofollow" title="Login">Login</a></li>                </ul>
            </div>
        
        <!-- SITE TOOLS -->
        <div id="dokuwiki__sitetools">
            <h3 class="a11y">Site Tools</h3>
            <form action="/wiki/start" accept-charset="utf-8" class="search" id="dw__search" method="get" role="search"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><input type="submit" value="Search" class="button" title="Search" /><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>            <div class="mobileTools">
                <form action="/wiki/doku.php" method="get" accept-charset="utf-8"><div class="no"><input type="hidden" name="id" value="cookbooks:4.2.x:pseudovariables" /><select name="do" class="edit quickselect" title="Tools"><option value="">Tools</option><optgroup label="Page Tools"><option value="edit">Show pagesource</option><option value="revisions">Old revisions</option><option value="backlink">Backlinks</option></optgroup><optgroup label="Site Tools"><option value="recent">Recent changes</option><option value="media">Media Manager</option><option value="index">Sitemap</option></optgroup><optgroup label="User Tools"><option value="login">Login</option><option value="register">Register</option></optgroup></select><input type="submit" value="&gt;" /></div></form>            </div>
            <ul>
                <li><a href="/wiki/cookbooks/4.2.x/pseudovariables?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Recent changes [R]">Recent changes</a></li><li><a href="/wiki/cookbooks/4.2.x/pseudovariables?do=media&amp;ns=cookbooks%3A4.2.x"  class="action media" rel="nofollow" title="Media Manager">Media Manager</a></li><li><a href="/wiki/cookbooks/4.2.x/pseudovariables?do=index"  class="action index" accesskey="x" rel="nofollow" title="Sitemap [X]">Sitemap</a></li>            </ul>
        </div>

    </div>

    <!-- BREADCRUMBS -->
            <div class="breadcrumbs">
                                        <div class="trace"><span class="bchead">Trace:</span> <span class="bcsep">?</span> <bdi><a href="/wiki/cookbooks/4.2.x/core"  class="breadcrumbs" title="cookbooks:4.2.x:core">core</a></bdi> <span class="bcsep">?</span> <span class="curid"><bdi><a href="/wiki/cookbooks/4.2.x/pseudovariables"  class="breadcrumbs" title="cookbooks:4.2.x:pseudovariables">pseudovariables</a></bdi></span></div>
                    </div>
    
    
    <hr class="a11y" />
</div></div><!-- /header -->

        <div class="wrapper group">

                            <!-- ********** ASIDE ********** -->
                <div id="dokuwiki__aside"><div class="pad aside include group">
                    <h3 class="toggle">Sidebar</h3>
                    <div class="content">
                                                                        <ul>
<li class="level1"><div class="li"> <a href="/wiki/start" class="wikilink1" title="start">Wiki Home</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://www.kamailio.org" class="urlextern" title="http://www.kamailio.org"  rel="nofollow">Kamailio Site</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://www.kamailio.org/docs/" class="urlextern" title="http://www.kamailio.org/docs/"  rel="nofollow">Docs Index</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://www.kamailio.org/docs/modules/" class="urlextern" title="http://www.kamailio.org/docs/modules/"  rel="nofollow">Modules Docs</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://www.kamailio.org/dokuwiki/" class="urlextern" title="http://www.kamailio.org/dokuwiki/"  rel="nofollow">Old Wiki</a></div>
</li>
<li class="level1"><div class="li"> <a href="/wiki/wiki/dokuwiki" class="wikilink1" title="wiki:dokuwiki">Wiki Help</a></div>
</li>
<li class="level1"><div class="li"> <a href="/wiki/wiki/syntax" class="wikilink1" title="wiki:syntax">Wiki Syntax</a></div>
</li>
</ul>
                                            </div>
                </div></div><!-- /aside -->
            
            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">

                <div class="pageId"><span>cookbooks:4.2.x:pseudovariables</span></div>

                <div class="page group">
                                                            <!-- wikipage start -->
                    <!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="#kamailio_sip_server_v42x_stablepseudo-variables">Kamailio SIP Server v4.2.x (stable): Pseudo-Variables</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="#introduction">Introduction</a></div></li>
<li class="level2"><div class="li"><a href="#pseudo-variables_usage">Pseudo-variables usage</a></div></li>
<li class="level2"><div class="li"><a href="#the_list_of_pseudo-variables">The list of pseudo-variables</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#pseudo-variable_marker">$$ - Pseudo-variable marker</a></div></li>
<li class="level3"><div class="li"><a href="#s_format_-_evaluate_dynamic_format">$_s(format) - Evaluate dynamic format</a></div></li>
<li class="level3"><div class="li"><a href="#ai_-_uri_inp-asserted-identity_header">$ai - URI inP-Asserted-Identity header</a></div></li>
<li class="level3"><div class="li"><a href="#adu_-_auth_digest_uri">$adu - Auth Digest URI</a></div></li>
<li class="level3"><div class="li"><a href="#aa_-_auth_algorithm">$aa - Auth algorithm</a></div></li>
<li class="level3"><div class="li"><a href="#ar_-_auth_realm">$ar - Auth realm</a></div></li>
<li class="level3"><div class="li"><a href="#au_-_auth_username_user">$au - Auth username user</a></div></li>
<li class="level3"><div class="li"><a href="#ad_-_auth_username_domain">$ad - Auth username domain</a></div></li>
<li class="level3"><div class="li"><a href="#au_-_auth_whole_username">$aU - Auth whole username</a></div></li>
<li class="level3"><div class="li"><a href="#au_-_acc_username">$Au - Acc username</a></div></li>
<li class="level3"><div class="li"><a href="#branch_name_-_branch_attributes">$branch(name) - Branch attributes</a></div></li>
<li class="level3"><div class="li"><a href="#br_-_request_s_first_branch">$br - Request&#039;s first branch</a></div></li>
<li class="level3"><div class="li"><a href="#br_-_request_s_all_branches">$bR - Request&#039;s all branches</a></div></li>
<li class="level3"><div class="li"><a href="#bf_-_branch_flags">$bf - Branch flags</a></div></li>
<li class="level3"><div class="li"><a href="#bf_-_branch_flags1">$bF - Branch flags</a></div></li>
<li class="level3"><div class="li"><a href="#bs_-_body_size">$bs - Body size</a></div></li>
<li class="level3"><div class="li"><a href="#ci_-_call-id">$ci - Call-Id</a></div></li>
<li class="level3"><div class="li"><a href="#cl_-_content-length">$cl - Content-Length</a></div></li>
<li class="level3"><div class="li"><a href="#cnt_pv_-_count_number_of_pvs">$cnt(pv) - Count number of pvs</a></div></li>
<li class="level3"><div class="li"><a href="#conid_-_tcp_connection_id">$conid - TCP Connection ID</a></div></li>
<li class="level3"><div class="li"><a href="#cs_-_cseq">$cs - CSeq</a></div></li>
<li class="level3"><div class="li"><a href="#ct_-_contact_header">$ct - Contact header</a></div></li>
<li class="level3"><div class="li"><a href="#ct_-_content-type">$cT - Content-Type</a></div></li>
<li class="level3"><div class="li"><a href="#dd_-_domain_of_destination_uri">$dd - Domain of destination URI</a></div></li>
<li class="level3"><div class="li"><a href="#di_-_diversion_header_uri">$di - Diversion header URI</a></div></li>
<li class="level3"><div class="li"><a href="#dip_-_diversion_privacy_parameter">$dip - Diversion &quot;privacy&quot; parameter</a></div></li>
<li class="level3"><div class="li"><a href="#dir_-_diversion_reason_parameter">$dir - Diversion &quot;reason&quot; parameter</a></div></li>
<li class="level3"><div class="li"><a href="#dic_-_diversion_counter_parameter">$dic - Diversion &quot;counter&quot; parameter</a></div></li>
<li class="level3"><div class="li"><a href="#dp_-_port_of_destination_uri">$dp - Port of destination URI</a></div></li>
<li class="level3"><div class="li"><a href="#dp_-_transport_protocol_of_destination_uri">$dP - Transport protocol of destination URI</a></div></li>
<li class="level3"><div class="li"><a href="#ds_-_destination_set">$ds - Destination set</a></div></li>
<li class="level3"><div class="li"><a href="#du_-_destination_uri">$du - Destination URI</a></div></li>
<li class="level3"><div class="li"><a href="#fd_-_from_uri_domain">$fd - From URI domain</a></div></li>
<li class="level3"><div class="li"><a href="#fn_-_from_display_name">$fn - From display name</a></div></li>
<li class="level3"><div class="li"><a href="#fs_-_forced_socket">$fs - Forced socket</a></div></li>
<li class="level3"><div class="li"><a href="#ft_-_from_tag">$ft - From tag</a></div></li>
<li class="level3"><div class="li"><a href="#fu_-_from_uri">$fu - From URI</a></div></li>
<li class="level3"><div class="li"><a href="#fu_-_from_uri_username">$fU - From URI username</a></div></li>
<li class="level3"><div class="li"><a href="#mb_-_sip_message_buffer">$mb - SIP message buffer</a></div></li>
<li class="level3"><div class="li"><a href="#mf_-_flags">$mf - Flags</a></div></li>
<li class="level3"><div class="li"><a href="#mf_-_flags_in_hexadecimal">$mF - Flags in hexadecimal</a></div></li>
<li class="level3"><div class="li"><a href="#mi_-_sip_message_id">$mi - SIP message id</a></div></li>
<li class="level3"><div class="li"><a href="#ml_-_sip_message_length">$ml - SIP message length</a></div></li>
<li class="level3"><div class="li"><a href="#mt_-_sip_message_type">$mt - SIP Message Type</a></div></li>
<li class="level3"><div class="li"><a href="#od_-_domain_original_r-uri">$od - Domain original R-URI</a></div></li>
<li class="level3"><div class="li"><a href="#op_-_port_in_original_r-uri">$op - Port in original R-URI</a></div></li>
<li class="level3"><div class="li"><a href="#op_-_protocol_of_original_r-uri">$oP - Protocol of original R-URI</a></div></li>
<li class="level3"><div class="li"><a href="#ou_-_original_r-uri">$ou - Original R-URI</a></div></li>
<li class="level3"><div class="li"><a href="#ou_-_username_in_original_r-uri">$oU - Username in original R-URI</a></div></li>
<li class="level3"><div class="li"><a href="#pd_-_domain_in_p-preferred-identity_header_uri">$pd - Domain in P-Preferred-Identity header URI</a></div></li>
<li class="level3"><div class="li"><a href="#pn_-_display_name_in_p-preferred-identity_header">$pn - Display Name in P-Preferred-Identity header</a></div></li>
<li class="level3"><div class="li"><a href="#pp_-_process_id">$pp - Process id</a></div></li>
<li class="level3"><div class="li"><a href="#pr_-_protocol_of_received_message">$pr - Protocol of received message</a></div></li>
<li class="level3"><div class="li"><a href="#pu_-_user_in_p-preferred-identity_header_uri">$pU - User in P-Preferred-Identity header URI</a></div></li>
<li class="level3"><div class="li"><a href="#pu_-_uri_in_p-preferred-identity_header">$pu - URI in P-Preferred-Identity header</a></div></li>
<li class="level3"><div class="li"><a href="#rd_-_domain_in_r-uri">$rd - Domain in R-URI</a></div></li>
<li class="level3"><div class="li"><a href="#rb_-_body_of_requestreply">$rb - Body of request/reply</a></div></li>
<li class="level3"><div class="li"><a href="#rc_-_returned_code">$rc - Returned code</a></div></li>
<li class="level3"><div class="li"><a href="#re_-_remote-party-id_header_uri">$re - Remote-Party-ID header URI</a></div></li>
<li class="level3"><div class="li"><a href="#rm_-_sip_method">$rm - SIP method</a></div></li>
<li class="level3"><div class="li"><a href="#rmid_-_sip_method_id">$rmid - SIP Method ID</a></div></li>
<li class="level3"><div class="li"><a href="#route_uri_-_uri_in_first_route_header">$route_uri - URI in first Route header</a></div></li>
<li class="level3"><div class="li"><a href="#rp_-_port_in_r-uri">$rp - Port in R-URI</a></div></li>
<li class="level3"><div class="li"><a href="#rp_-_protocol_of_r-uri">$rP - Protocol of R-URI</a></div></li>
<li class="level3"><div class="li"><a href="#rr_-_sip_reply_reason_phrase">$rr - SIP reply reason phrase</a></div></li>
<li class="level3"><div class="li"><a href="#rs_-_sip_reply_code">$rs - SIP reply code</a></div></li>
<li class="level3"><div class="li"><a href="#rt_-_refer-to_uri">$rt - Refer-to URI</a></div></li>
<li class="level3"><div class="li"><a href="#ru_-_request_uri">$ru - Request URI</a></div></li>
<li class="level3"><div class="li"><a href="#ru_-_username_in_r-uri">$rU - Username in R-URI</a></div></li>
<li class="level3"><div class="li"><a href="#ruid_-_record_internal_unique_id">$ruid - Record internal Unique ID</a></div></li>
<li class="level3"><div class="li"><a href="#rz_-_uri_scheme_of_r-uri">$rz - URI Scheme of R-URI</a></div></li>
<li class="level3"><div class="li"><a href="#ri_-_received_ip_address">$Ri - Received IP address</a></div></li>
<li class="level3"><div class="li"><a href="#rp_-_received_port">$Rp - Received port</a></div></li>
<li class="level3"><div class="li"><a href="#sf_-_script_flags">$sf - Script flags</a></div></li>
<li class="level3"><div class="li"><a href="#sf_-_script_flags1">$sF - Script flags</a></div></li>
<li class="level3"><div class="li"><a href="#si_-_source_ip_address">$si - Source IP address</a></div></li>
<li class="level3"><div class="li"><a href="#sp_-_source_port">$sp - Source port</a></div></li>
<li class="level3"><div class="li"><a href="#stat_name_-_statistics">$stat(name) - Statistics</a></div></li>
<li class="level3"><div class="li"><a href="#td_-_to_uri_domain">$td - To URI Domain</a></div></li>
<li class="level3"><div class="li"><a href="#tn_-_to_display_name">$tn - To display name</a></div></li>
<li class="level3"><div class="li"><a href="#tt_-_to_tag">$tt - To tag</a></div></li>
<li class="level3"><div class="li"><a href="#tu_-_to_uri">$tu - To URI</a></div></li>
<li class="level3"><div class="li"><a href="#tu_-_to_uri_username">$tU - To URI Username</a></div></li>
<li class="level3"><div class="li"><a href="#tb_-_startup_timestamp">$Tb - Startup timestamp</a></div></li>
<li class="level3"><div class="li"><a href="#tf_-_string_formatted_time_-_cached">$Tf - String formatted time - cached</a></div></li>
<li class="level3"><div class="li"><a href="#tf_-_string_formatted_time_-_current">$TF - String formatted time - current</a></div></li>
<li class="level3"><div class="li"><a href="#ts_-_unix_time_stamp_-_cached">$Ts - Unix time stamp - cached</a></div></li>
<li class="level3"><div class="li"><a href="#ts_-_unix_time_stamp_-_current">$TS - Unix time stamp - current</a></div></li>
<li class="level3"><div class="li"><a href="#ua_-_user_agent_header">$ua - User agent header</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#avp_id_-_avps">$avp(id) - AVPs</a></div></li>
<li class="level2"><div class="li"><a href="#xavp_id_-_xavps">$xavp(id) - XAVPs</a></div></li>
<li class="level2"><div class="li"><a href="#hdr_name_-_headers">$hdr(name) - Headers</a></div></li>
<li class="level2"><div class="li"><a href="#var_name_-_private_memory_variables">$var(name) - Private memory variables</a></div></li>
<li class="level2"><div class="li"><a href="#shv_name_-_shared_memory_variables">$shv(name) - Shared memory variables</a></div></li>
<li class="level2"><div class="li"><a href="#time_name_-_broken-down_time">$time(name) - Broken-down time</a></div></li>
<li class="level2"><div class="li"><a href="#timef_format_-_strftime_formatted_time">$timef(format) - Strftime Formatted Time</a></div></li>
<li class="level2"><div class="li"><a href="#sel_name_-_selects">$sel(name) - Selects</a></div></li>
<li class="level2"><div class="li"><a href="#send_address_attributes">Send Address Attributes</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#sndfrom_name">$sndfrom(name)</a></div></li>
<li class="level3"><div class="li"><a href="#sndto_name">$sndto(name)</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#benchmark_module_pseudo-variables">Benchmark module Pseudo-Variables</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#bm_time_diff">$BM_time_diff</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#dialog_module_pseudo-variables">Dialog module Pseudo-Variables</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#dlg_attr">$dlg(attr)</a></div></li>
<li class="level3"><div class="li"><a href="#dlg_ctx_attr">$dlg_ctx(attr)</a></div></li>
<li class="level3"><div class="li"><a href="#dlg_var_key">$dlg_var(key)</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#htable_module_pseudo-variables">HTable module Pseudo-Variables</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#sht_htable_key">$sht(htable=&gt;key)</a></div></li>
<li class="level3"><div class="li"><a href="#shtex_htable_key">$shtex(htable=&gt;key)</a></div></li>
<li class="level3"><div class="li"><a href="#shtcn_htable_exp">$shtcn(htable=&gt;exp)</a></div></li>
<li class="level3"><div class="li"><a href="#shtcv_htable_exp">$shtcv(htable=&gt;exp)</a></div></li>
<li class="level3"><div class="li"><a href="#shtinc_htable_key">$shtinc(htable=&gt;key)</a></div></li>
<li class="level3"><div class="li"><a href="#shtdec_htable_key">$shtdec(htable=&gt;key)</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#memcached_module_pseudo-variables">Memcached module Pseudo-Variables</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#mct_key">$mct(key)</a></div></li>
<li class="level3"><div class="li"><a href="#mct_key_expiry">$mct(key=&gt;expiry)</a></div></li>
<li class="level3"><div class="li"><a href="#mcinc_key">$mcinc(key)</a></div></li>
<li class="level3"><div class="li"><a href="#mcdec_key">$mcdec(key)</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#xmlops_pseudo-variables">XMLOPS Pseudo-Variables</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#xml_name_spec">$xml(name=&gt;spec)</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#tmx_module_pseudo-variables">TMX module Pseudo-Variables</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#t_branch_idx">$T_branch_idx</a></div></li>
<li class="level3"><div class="li"><a href="#t_reply_ruid">$T_reply_ruid</a></div></li>
<li class="level3"><div class="li"><a href="#t_reply_code">$T_reply_code</a></div></li>
<li class="level3"><div class="li"><a href="#t_req_pv">$T_req(pv)</a></div></li>
<li class="level3"><div class="li"><a href="#t_rpl_pv">$T_rpl(pv)</a></div></li>
<li class="level3"><div class="li"><a href="#t_inv_pv">$T_inv(pv)</a></div></li>
<li class="level3"><div class="li"><a href="#t_name">$T(name)</a></div></li>
<li class="level3"><div class="li"><a href="#t_branch_name">$T_branch(name)</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#uac_module_pseudo-variables">UAC module Pseudo-Variables</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#uac_req_key">$uac_req(key)</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#nathelper_module_pseudo-variables">Nathelper module Pseudo-Variables</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#rr_count">$rr_count</a></div></li>
<li class="level3"><div class="li"><a href="#rr_top_count">$rr_top_count</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#mqueue_module_pseudo-variables">MQueue module Pseudo-Variables</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#mqk_q">$mqk(q)</a></div></li>
<li class="level3"><div class="li"><a href="#mqv_q">$mqv(q)</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#timeval">TimeVal</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#tv_name">$TV(name)</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#next_hop_address">Next hop address</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#nh_key">$nh(key)</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#geoip_module_pseudo-variables">GeoIP module Pseudo-Variables</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#gip_pvc_key">$gip(pvc=&gt;key)</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#tls_module_pseudo-variables">TLS module Pseudo-Variables</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#tls_version">$tls_version</a></div></li>
<li class="level3"><div class="li"><a href="#tls_description">$tls_description</a></div></li>
<li class="level3"><div class="li"><a href="#tls_cipher_info">$tls_cipher_info</a></div></li>
<li class="level3"><div class="li"><a href="#tls_cipher_bits">$tls_cipher_bits</a></div></li>
<li class="level3"><div class="li"><a href="#tls_peer_version">$tls_peer_version</a></div></li>
<li class="level3"><div class="li"><a href="#tls_my_version">$tls_my_version</a></div></li>
<li class="level3"><div class="li"><a href="#tls_peer_serial">$tls_peer_serial</a></div></li>
<li class="level3"><div class="li"><a href="#tls_my_serial">$tls_my_serial</a></div></li>
<li class="level3"><div class="li"><a href="#tls_peer_subject">$tls_peer_subject</a></div></li>
<li class="level3"><div class="li"><a href="#tls_peer_issuer">$tls_peer_issuer</a></div></li>
<li class="level3"><div class="li"><a href="#tls_my_subject">$tls_my_subject</a></div></li>
<li class="level3"><div class="li"><a href="#tls_my_issuer">$tls_my_issuer</a></div></li>
<li class="level3"><div class="li"><a href="#tls_peer_subject_cn">$tls_peer_subject_cn</a></div></li>
<li class="level3"><div class="li"><a href="#tls_peer_issuer_cn">$tls_peer_issuer_cn</a></div></li>
<li class="level3"><div class="li"><a href="#tls_my_subject_cn">$tls_my_subject_cn</a></div></li>
<li class="level3"><div class="li"><a href="#tls_my_issuer_cn">$tls_my_issuer_cn</a></div></li>
<li class="level3"><div class="li"><a href="#tls_peer_subject_locality">$tls_peer_subject_locality</a></div></li>
<li class="level3"><div class="li"><a href="#tls_peer_issuer_locality">$tls_peer_issuer_locality</a></div></li>
<li class="level3"><div class="li"><a href="#tls_my_subject_locality">$tls_my_subject_locality</a></div></li>
<li class="level3"><div class="li"><a href="#tls_my_issuer_locality">$tls_my_issuer_locality</a></div></li>
<li class="level3"><div class="li"><a href="#tls_peer_subject_country">$tls_peer_subject_country</a></div></li>
<li class="level3"><div class="li"><a href="#tls_peer_issuer_country">$tls_peer_issuer_country</a></div></li>
<li class="level3"><div class="li"><a href="#tls_my_subject_country">$tls_my_subject_country</a></div></li>
<li class="level3"><div class="li"><a href="#tls_my_issuer_country">$tls_my_issuer_country</a></div></li>
<li class="level3"><div class="li"><a href="#tls_peer_subject_state">$tls_peer_subject_state</a></div></li>
<li class="level3"><div class="li"><a href="#tls_peer_issuer_state">$tls_peer_issuer_state</a></div></li>
<li class="level3"><div class="li"><a href="#tls_my_subject_state">$tls_my_subject_state</a></div></li>
<li class="level3"><div class="li"><a href="#tls_my_issuer_state">$tls_my_issuer_state</a></div></li>
<li class="level3"><div class="li"><a href="#tls_peer_subject_organization">$tls_peer_subject_organization</a></div></li>
<li class="level3"><div class="li"><a href="#tls_peer_issuer_organization">$tls_peer_issuer_organization</a></div></li>
<li class="level3"><div class="li"><a href="#tls_my_subject_organization">$tls_my_subject_organization</a></div></li>
<li class="level3"><div class="li"><a href="#tls_my_issuer_organization">$tls_my_issuer_organization</a></div></li>
<li class="level3"><div class="li"><a href="#tls_peer_subject_unit">$tls_peer_subject_unit</a></div></li>
<li class="level3"><div class="li"><a href="#tls_peer_issuer_unit">$tls_peer_issuer_unit</a></div></li>
<li class="level3"><div class="li"><a href="#tls_my_subject_unit">$tls_my_subject_unit</a></div></li>
<li class="level3"><div class="li"><a href="#tls_my_issuer_unit">$tls_my_issuer_unit</a></div></li>
<li class="level3"><div class="li"><a href="#tls_peer_san_email">$tls_peer_san_email</a></div></li>
<li class="level3"><div class="li"><a href="#tls_my_san_email">$tls_my_san_email</a></div></li>
<li class="level3"><div class="li"><a href="#tls_peer_san_hostname">$tls_peer_san_hostname</a></div></li>
<li class="level3"><div class="li"><a href="#tls_my_san_hostname">$tls_my_san_hostname</a></div></li>
<li class="level3"><div class="li"><a href="#tls_peer_san_uri">$tls_peer_san_uri</a></div></li>
<li class="level3"><div class="li"><a href="#tls_my_san_uri">$tls_my_san_uri</a></div></li>
<li class="level3"><div class="li"><a href="#tls_peer_san_ip">$tls_peer_san_ip</a></div></li>
<li class="level3"><div class="li"><a href="#tls_my_san_ip">$tls_my_san_ip</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#xhttp_module_pseudo-variables">XHTTP module Pseudo-Variables</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#hu">$hu</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#msrp_module_pseudo_variables">MSRP Module Pseudo Variables</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#msrp_buf">$msrp(buf)</a></div></li>
<li class="level3"><div class="li"><a href="#msrp_body">$msrp(body)</a></div></li>
<li class="level3"><div class="li"><a href="#msrp_code">$msrp(code)</a></div></li>
<li class="level3"><div class="li"><a href="#msrp_hdrs">$msrp(hdrs)</a></div></li>
<li class="level3"><div class="li"><a href="#msrp_msgid">$msrp(msgid)</a></div></li>
<li class="level3"><div class="li"><a href="#msrp_method">$msrp(method)</a></div></li>
<li class="level3"><div class="li"><a href="#msrp_buflen">$msrp(buflen)</a></div></li>
<li class="level3"><div class="li"><a href="#msrp_sessid">$msrp(sessid)</a></div></li>
<li class="level3"><div class="li"><a href="#msrp_reason">$msrp(reason)</a></div></li>
<li class="level3"><div class="li"><a href="#msrp_crthop">$msrp(crthop)</a></div></li>
<li class="level3"><div class="li"><a href="#msrp_bodylen">$msrp(bodylen)</a></div></li>
<li class="level3"><div class="li"><a href="#msrp_transid">$msrp(transid)</a></div></li>
<li class="level3"><div class="li"><a href="#msrp_prevhop">$msrp(prevhop)</a></div></li>
<li class="level3"><div class="li"><a href="#msrp_nexthop">$msrp(nexthop)</a></div></li>
<li class="level3"><div class="li"><a href="#msrp_lasthop">$msrp(lasthop)</a></div></li>
<li class="level3"><div class="li"><a href="#msrp_srcaddr">$msrp(srcaddr)</a></div></li>
<li class="level3"><div class="li"><a href="#msrp_srcsock">$msrp(srcsock)</a></div></li>
<li class="level3"><div class="li"><a href="#msrp_firsthop">$msrp(firsthop)</a></div></li>
<li class="level3"><div class="li"><a href="#msrp_prevhops">$msrp(prevhops)</a></div></li>
<li class="level3"><div class="li"><a href="#msrp_nexthops">$msrp(nexthops)</a></div></li>
<li class="level3"><div class="li"><a href="#msrp_conid">$msrp(conid)</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#sipt_module_pseudo-variables">SIPT module Pseudo-Variables</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#sipt_calling_party_numberpresentationsipt_presentation">$sipt(calling_party_number.presentation) / $sipt_presentation</a></div></li>
<li class="level3"><div class="li"><a href="#sipt_calling_party_numberscreeningsipt_screening">$sipt(calling_party_number.screening) / $sipt_screening</a></div></li>
<li class="level3"><div class="li"><a href="#sipt_hop_countersipt_hop_counter">$sipt(hop_counter) / $sipt_hop_counter</a></div></li>
<li class="level3"><div class="li"><a href="#sipt_calling_party_categorysipt_cpcsipt_cpc">$sipt(calling_party_category) / $sipt(cpc) / $sipt_cpc</a></div></li>
<li class="level3"><div class="li"><a href="#sipt_calling_party_numbernature_of_addresssipt_calling_party_numbernaisipt_calling_party_nai">$sipt(calling_party_number.nature_of_address) / $sipt.(calling_party_number.nai) / $sipt_calling_party_nai</a></div></li>
<li class="level3"><div class="li"><a href="#sipt_called_party_numbernature_of_addresssipt_called_party_numbernaisipt_called_party_nai">$sipt(called_party_number.nature_of_address) / $sipt(called_party_number.nai) / $sipt_called_party_nai</a></div></li>
<li class="level3"><div class="li"><a href="#sipt_event_info">$sipt(event_info)</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#cfg_key_-_config_file_attributes">$cfg(key) - Config File Attributes</a></div></li>
<li class="level2"><div class="li"><a href="#dns_pvid_key_-_dns_query_result">$dns(pvid=&gt;key) - DNS Query Result</a></div></li>
<li class="level2"><div class="li"><a href="#hn_key_-_hostname_details">$HN(key) - Hostname details</a></div></li>
<li class="level2"><div class="li"><a href="#c_xy_-_foreground_and_background_colors">$C(xy) - Foreground and background colors</a></div></li>
<li class="level2"><div class="li"><a href="#examples">Examples</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#request-uri_and_destination-uri_parsing">Request-URI and Destination-URI parsing</a></div></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="kamailio_sip_server_v42x_stablepseudo-variables">Kamailio SIP Server v4.2.x (stable): Pseudo-Variables</h1>
<div class="level1">

</div>

<h2 class="sectionedit2" id="introduction">Introduction</h2>
<div class="level2">

<p>
The term ¡°pseudo-variable¡± is used for special tokens that can be given as parameters to different script functions and they will be replaced with a value before the execution of the function.
</p>

<p>
The beginning of a ¡°pseudo-variable¡± is marked by the character ¡°$¡±. If you want to have the character ¡°$¡± just double it ¡°$$¡±.
</p>

<p>
There is a set of predefined pseudo-variables, which have the name composed from one or more characters, and special pseudo-variables that are references to dynamic fields (AVP and Headers).
</p>

<p>
Pseudo-Variables are implemented by various modules, most of them are provided by <strong>pv</strong>.
</p>

</div>

<h2 class="sectionedit3" id="pseudo-variables_usage">Pseudo-variables usage</h2>
<div class="level2">

<p>
Pseudo-variables can be used with many modules, among them:
</p>
<ul>
<li class="level1"><div class="li"> acc</div>
</li>
<li class="level1"><div class="li"> avpops</div>
</li>
<li class="level1"><div class="li"> htable</div>
</li>
<li class="level1"><div class="li"> textops</div>
</li>
<li class="level1"><div class="li"> uac</div>
</li>
<li class="level1"><div class="li"> xlog </div>
</li>
</ul>

</div>

<h2 class="sectionedit4" id="the_list_of_pseudo-variables">The list of pseudo-variables</h2>
<div class="level2">

<p>
Predefined pseudo-variables are listed in alphabetical order.
</p>

</div>

<h3 class="sectionedit5" id="pseudo-variable_marker">$$ - Pseudo-variable marker</h3>
<div class="level3">

<p>
<strong>$$</strong> - represents the character &#039;$&#039;
</p>

</div>

<h3 class="sectionedit6" id="s_format_-_evaluate_dynamic_format">$_s(format) - Evaluate dynamic format</h3>
<div class="level3">

<p>
<strong>$_s(format)</strong> - returns the string after evaluating all pseudo-variables in format
</p>
<pre class="code">    $var(x) = &quot;sip:&quot; + $rU + &quot;@&quot; + $fd;

    # is equivalent of:

    $var(x) = $_s(sip:$rU@$fd);</pre>

</div>

<h3 class="sectionedit7" id="ai_-_uri_inp-asserted-identity_header">$ai - URI inP-Asserted-Identity header</h3>
<div class="level3">

<p>
<strong>$ai</strong> - reference to <abbr title="Uniform Resource Identifier">URI</abbr> in request&#039;s P-Asserted-Identity header (see <abbr title="Request for Comments">RFC</abbr> 3325)
</p>

</div>

<h3 class="sectionedit8" id="adu_-_auth_digest_uri">$adu - Auth Digest URI</h3>
<div class="level3">

<p>
<strong>$adu</strong> - <abbr title="Uniform Resource Identifier">URI</abbr> from Authorization or Proxy-Authorization header. This <abbr title="Uniform Resource Identifier">URI</abbr> is used when calculating the HTTP Digest Response.
</p>

</div>

<h3 class="sectionedit9" id="aa_-_auth_algorithm">$aa - Auth algorithm</h3>
<div class="level3">

<p>
<strong>$aa</strong> - algorithm from Authorization or Proxy-Authorization header.
</p>

</div>

<h3 class="sectionedit10" id="ar_-_auth_realm">$ar - Auth realm</h3>
<div class="level3">

<p>
<strong>$ar</strong> - realm from Authorization or Proxy-Authorization header
</p>

</div>

<h3 class="sectionedit11" id="au_-_auth_username_user">$au - Auth username user</h3>
<div class="level3">

<p>
<strong>$au</strong> - user part of username from Authorization or Proxy-Authorization header
</p>

</div>

<h3 class="sectionedit12" id="ad_-_auth_username_domain">$ad - Auth username domain</h3>
<div class="level3">

<p>
<strong>$ad</strong> - domain part of username from Authorization or Proxy-Authorization header
</p>

</div>

<h3 class="sectionedit13" id="au_-_auth_whole_username">$aU - Auth whole username</h3>
<div class="level3">

<p>
<strong>$aU</strong> - whole username from Authorization or Proxy-Authorization header
</p>

</div>

<h3 class="sectionedit14" id="au_-_acc_username">$Au - Acc username</h3>
<div class="level3">

<p>
<strong>$Au</strong> - username for accounting purposes. It&#039;s a selective pseudo variable (inherited from acc module). It returns $au if exits or From username otherwise.
</p>

</div>

<h3 class="sectionedit15" id="branch_name_-_branch_attributes">$branch(name) - Branch attributes</h3>
<div class="level3">

<p>
<strong>$branch(name)</strong> - reference to attribute &#039;name&#039; of a branch
</p>

<p>
This pseudo variable gives you access to the ¡°additional branches¡± only, not to the ¡°main branch¡±. E.g. if there are 3 clients registered for the same AoR, after lookup() you will have one contact in the ¡°main branch¡± and two ¡°additional branches¡±. Using $branch() you can access the additional branches, the main branch can be accessed using $ru and $du. (Note: In branch_routes there is no distinction between the main and the additional branches - the branch_route will be called once for each one of them.)
</p>

<p>
The &#039;name&#039; can be:
</p>
<ul>
<li class="level1"><div class="li"> uri - return <abbr title="Uniform Resource Identifier">URI</abbr> of the branch</div>
</li>
<li class="level1"><div class="li"> dst_uri - return destination <abbr title="Uniform Resource Identifier">URI</abbr> (next hop address)</div>
</li>
<li class="level1"><div class="li"> path - return the path vector for the branch</div>
</li>
<li class="level1"><div class="li"> q - return the q value of the branch</div>
</li>
<li class="level1"><div class="li"> send_socket - return the socket to be used to send the branch</div>
</li>
<li class="level1"><div class="li"> count - return the number of the branches</div>
</li>
<li class="level1"><div class="li"> flags - return the branch flags value</div>
</li>
<li class="level1"><div class="li"> ruid - return the ruid of the branch (Record internal Unique ID from usrloc)</div>
</li>
</ul>

<p>
The PV can take an index to access a specif branch: $(branch(name)[index])
</p>

<p>
Example:
</p>
<pre class="code c">$var<span class="br0">&#40;</span>i<span class="br0">&#41;</span><span class="sy0">=</span><span class="nu0">0</span><span class="sy0">;</span>
<span class="kw1">while</span><span class="br0">&#40;</span>$var<span class="br0">&#40;</span>i<span class="br0">&#41;</span><span class="sy0">&lt;</span>$branch<span class="br0">&#40;</span>count<span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
   xlog<span class="br0">&#40;</span><span class="st0">&quot;$(branch(uri)[$var(i)])<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
   $var<span class="br0">&#40;</span>i<span class="br0">&#41;</span> <span class="sy0">=</span> $var<span class="br0">&#40;</span>i<span class="br0">&#41;</span> <span class="sy0">+</span> <span class="nu0">1</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

<p>
Starting with 3.1.0, you can assign value per attribute. Index can be used to update a specific branch:
</p>
<pre class="code c">$<span class="br0">&#40;</span>branch<span class="br0">&#40;</span>attr<span class="br0">&#41;</span><span class="br0">&#91;</span>index<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="sy0">=</span> value<span class="sy0">;</span></pre>

<p>
If index is missing, first branch is used. If index is -1 the last branch is used.
</p>

<p>
Assigning $null to the uri attribute will drop the branch, for the rest of attributes will just set the value to null.
</p>
<pre class="code c">$<span class="br0">&#40;</span>branch<span class="br0">&#40;</span>uri<span class="br0">&#41;</span><span class="br0">&#91;</span><span class="nu0">2</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="sy0">=</span> <span class="st0">&quot;sip:test@kamailio.org;transport=sctp&quot;</span><span class="sy0">;</span></pre>

</div>

<h3 class="sectionedit16" id="br_-_request_s_first_branch">$br - Request&#039;s first branch</h3>
<div class="level3">

<p>
<strong>$br</strong> - reference to request&#039;s first branch
</p>

<p>
<span style="color: #0000ff">It is a R/W variable, you can assign values to it directly in configuration file (will add a new branch).</span>
</p>

</div>

<h3 class="sectionedit17" id="br_-_request_s_all_branches">$bR - Request&#039;s all branches</h3>
<div class="level3">

<p>
<strong>$bR</strong> - reference to request&#039;s all branches
</p>

</div>

<h3 class="sectionedit18" id="bf_-_branch_flags">$bf - Branch flags</h3>
<div class="level3">

<p>
<strong>$bf</strong> - reference to branch flags of branch 0 (RURI) - decimal output
</p>

<p>
<span style="color: #0000ff">It is a R/W variable (you can assign values to it directly in configuration file)</span>
</p>

</div>

<h3 class="sectionedit19" id="bf_-_branch_flags1">$bF - Branch flags</h3>
<div class="level3">

<p>
<strong>$bF</strong> - reference to branch flags of branch 0 (RURI) - hexa output
</p>

<p>
<span style="color: #0000ff">It is a R/W variable (you can assign values to it directly in configuration file)</span>
</p>

</div>

<h3 class="sectionedit20" id="bs_-_body_size">$bs - Body size</h3>
<div class="level3">

<p>
<strong>$bs</strong> - body size
</p>

</div>

<h3 class="sectionedit21" id="ci_-_call-id">$ci - Call-Id</h3>
<div class="level3">

<p>
<strong>$ci</strong> - reference to body of call-id header
</p>

</div>

<h3 class="sectionedit22" id="cl_-_content-length">$cl - Content-Length</h3>
<div class="level3">

<p>
<strong>$cl</strong> - reference to body of content-length header
</p>

</div>

<h3 class="sectionedit23" id="cnt_pv_-_count_number_of_pvs">$cnt(pv) - Count number of pvs</h3>
<div class="level3">

<p>
<strong>$cnt(avp)</strong> - return the number of avps
</p>
<pre class="code c">xlog<span class="br0">&#40;</span><span class="st0">&quot;$$avp(x) found $cnt($avp(x)) times<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

</div>

<h3 class="sectionedit24" id="conid_-_tcp_connection_id">$conid - TCP Connection ID</h3>
<div class="level3">

<p>
<strong>$conid</strong> - The TCP connection ID of the connection the current message arrived on for TCP, TLS, WS, and WSS.  Set to $null for SCTP and UDP.
</p>

</div>

<h3 class="sectionedit25" id="cs_-_cseq">$cs - CSeq</h3>
<div class="level3">

<p>
<strong>$cs</strong> - reference to the sequence number in the cseq header. The method in the CSeq header is identical to the request method, thus use $rm to get the method (works also for responses).
</p>

</div>

<h3 class="sectionedit26" id="ct_-_contact_header">$ct - Contact header</h3>
<div class="level3">

<p>
<strong>$ct</strong> - reference to body of contact header
</p>

</div>

<h3 class="sectionedit27" id="ct_-_content-type">$cT - Content-Type</h3>
<div class="level3">

<p>
<strong>$cT</strong> - reference to body of content-type header
</p>

</div>

<h3 class="sectionedit28" id="dd_-_domain_of_destination_uri">$dd - Domain of destination URI</h3>
<div class="level3">

<p>
<strong>$dd</strong> - reference to domain of destination <abbr title="Uniform Resource Identifier">URI</abbr> (without port)
</p>

</div>

<h3 class="sectionedit29" id="di_-_diversion_header_uri">$di - Diversion header URI</h3>
<div class="level3">

<p>
<strong>$di</strong> - reference to Diversion header <abbr title="Uniform Resource Identifier">URI</abbr>
</p>

</div>

<h3 class="sectionedit30" id="dip_-_diversion_privacy_parameter">$dip - Diversion &quot;privacy&quot; parameter</h3>
<div class="level3">

<p>
<strong>$dip</strong> - reference to Diversion header ¡°privacy¡± parameter value
</p>

</div>

<h3 class="sectionedit31" id="dir_-_diversion_reason_parameter">$dir - Diversion &quot;reason&quot; parameter</h3>
<div class="level3">

<p>
<strong>$dir</strong> - reference to Diversion header ¡°reason¡± parameter value
</p>

</div>

<h3 class="sectionedit32" id="dic_-_diversion_counter_parameter">$dic - Diversion &quot;counter&quot; parameter</h3>
<div class="level3">

<p>
<strong>$dic</strong> - reference to Diversion header ¡°counter¡± parameter value
</p>

</div>

<h3 class="sectionedit33" id="dp_-_port_of_destination_uri">$dp - Port of destination URI</h3>
<div class="level3">

<p>
<strong>$dp</strong> - reference to port of destination <abbr title="Uniform Resource Identifier">URI</abbr>
</p>

</div>

<h3 class="sectionedit34" id="dp_-_transport_protocol_of_destination_uri">$dP - Transport protocol of destination URI</h3>
<div class="level3">

<p>
<strong>$dP</strong> - reference to transport protocol of destination <abbr title="Uniform Resource Identifier">URI</abbr>
</p>

</div>

<h3 class="sectionedit35" id="ds_-_destination_set">$ds - Destination set</h3>
<div class="level3">

<p>
<strong>$ds</strong> - reference to destination set
</p>

</div>

<h3 class="sectionedit36" id="du_-_destination_uri">$du - Destination URI</h3>
<div class="level3">

<p>
<strong>$du</strong> - reference to destination <abbr title="Uniform Resource Identifier">URI</abbr>
</p>

<p>
If loose_route() returns TRUE a destination <abbr title="Uniform Resource Identifier">URI</abbr> is set according to the first Route header.
$du is also set if lookup() function of &#039;registrar&#039; module finds contact(s) behind NAT.
</p>

<p>
<span style="color: #0000ff">It is a R/W variable (you can assign values to it directly in configuration file)</span>
</p>

<p>
To reset $du:
</p>
<pre class="code">$du = null;</pre>

</div>

<h3 class="sectionedit37" id="fd_-_from_uri_domain">$fd - From URI domain</h3>
<div class="level3">

<p>
<strong>$fd</strong> - reference to domain in <abbr title="Uniform Resource Identifier">URI</abbr> of &#039;From&#039; header
</p>

</div>

<h3 class="sectionedit38" id="fn_-_from_display_name">$fn - From display name</h3>
<div class="level3">

<p>
<strong>$fn</strong> - reference to display name of &#039;From&#039; header
</p>

</div>

<h3 class="sectionedit39" id="fs_-_forced_socket">$fs - Forced socket</h3>
<div class="level3">

<p>
<strong>$fs</strong> - reference to the forced socket for message sending (if any) in the form proto:ip:port
</p>

<p>
<span style="color: #0000ff">It is a R/W variable (you can assign values to it directly in configuration file). Transport proto can be omitted when assigning value, in which case it is taken from destination <abbr title="Uniform Resource Identifier">URI</abbr> of the message.</span>
</p>

</div>

<h3 class="sectionedit40" id="ft_-_from_tag">$ft - From tag</h3>
<div class="level3">

<p>
<strong>$ft</strong> - reference to tag parameter of &#039;From&#039; header
</p>

</div>

<h3 class="sectionedit41" id="fu_-_from_uri">$fu - From URI</h3>
<div class="level3">

<p>
<strong>$fu</strong> - reference to <abbr title="Uniform Resource Identifier">URI</abbr> of &#039;From&#039; header
</p>

<p>
<span style="color: #0000ff">It is a R/W variable (you can assign values to it directly in configuration file)</span>
</p>

<p>
Note that changing the From: header may break backwards compatibility with SIP 1.0 devices.
</p>

</div>

<h3 class="sectionedit42" id="fu_-_from_uri_username">$fU - From URI username</h3>
<div class="level3">

<p>
<strong>$fU</strong> - reference to username in <abbr title="Uniform Resource Identifier">URI</abbr> of &#039;From&#039; header
</p>

<p>
<span style="color: #0000ff">It is a R/W variable (you can assign values to it directly in configuration file)</span>
</p>

<p>
Note that changing the From: header may break backwards compatibility with SIP 1.0 devices.
</p>

</div>

<h3 class="sectionedit43" id="mb_-_sip_message_buffer">$mb - SIP message buffer</h3>
<div class="level3">

<p>
<strong>$mb</strong> - reference to SIP message buffer
</p>

</div>

<h3 class="sectionedit44" id="mf_-_flags">$mf - Flags</h3>
<div class="level3">

<p>
<strong>$mf</strong> - reference to message/transaction flags set for current SIP request
</p>

<p>
<span style="color: #0000ff">It is a R/W variable (you can assign values to it directly in configuration file)</span>
</p>

</div>

<h3 class="sectionedit45" id="mf_-_flags_in_hexadecimal">$mF - Flags in hexadecimal</h3>
<div class="level3">

<p>
<strong>$mF</strong> -reference to message/transaction flags set for current SIP request in hexa-decimal
</p>

<p>
<span style="color: #0000ff">It is a R/W variable (you can assign values to it directly in configuration file)</span>
</p>

</div>

<h3 class="sectionedit46" id="mi_-_sip_message_id">$mi - SIP message id</h3>
<div class="level3">

<p>
<strong>$mi</strong> - reference to SIP message id
</p>

</div>

<h3 class="sectionedit47" id="ml_-_sip_message_length">$ml - SIP message length</h3>
<div class="level3">

<p>
<strong>$ml</strong> - reference to SIP message length
</p>

</div>

<h3 class="sectionedit48" id="mt_-_sip_message_type">$mt - SIP Message Type</h3>
<div class="level3">

<p>
<strong>$mt</strong> - returns 1 if the sip message is a request, returns 2 if the sip message is a reply
</p>

</div>

<h3 class="sectionedit49" id="od_-_domain_original_r-uri">$od - Domain original R-URI</h3>
<div class="level3">

<p>
<strong>$od</strong> - reference to domain in request&#039;s original R-<abbr title="Uniform Resource Identifier">URI</abbr>
</p>

</div>

<h3 class="sectionedit50" id="op_-_port_in_original_r-uri">$op - Port in original R-URI</h3>
<div class="level3">

<p>
<strong>$op</strong> - reference to port of original R-<abbr title="Uniform Resource Identifier">URI</abbr>
</p>

</div>

<h3 class="sectionedit51" id="op_-_protocol_of_original_r-uri">$oP - Protocol of original R-URI</h3>
<div class="level3">

<p>
<strong>$oP</strong> - reference to transport protocol of original R-<abbr title="Uniform Resource Identifier">URI</abbr>
</p>

</div>

<h3 class="sectionedit52" id="ou_-_original_r-uri">$ou - Original R-URI</h3>
<div class="level3">

<p>
<strong>$ou</strong> - reference to request&#039;s original <abbr title="Uniform Resource Identifier">URI</abbr>
</p>

</div>

<h3 class="sectionedit53" id="ou_-_username_in_original_r-uri">$oU - Username in original R-URI</h3>
<div class="level3">

<p>
<strong>$oU</strong> - reference to username in request&#039;s original <abbr title="Uniform Resource Identifier">URI</abbr>
</p>

</div>

<h3 class="sectionedit54" id="pd_-_domain_in_p-preferred-identity_header_uri">$pd - Domain in P-Preferred-Identity header URI</h3>
<div class="level3">

<p>
<strong>$pd</strong> - reference to domain in request&#039;s P-Preferred-Identity header <abbr title="Uniform Resource Identifier">URI</abbr> (see <abbr title="Request for Comments">RFC</abbr> 3325)
</p>

</div>

<h3 class="sectionedit55" id="pn_-_display_name_in_p-preferred-identity_header">$pn - Display Name in P-Preferred-Identity header</h3>
<div class="level3">

<p>
<strong>$pn</strong> - reference to Display Name in request&#039;s P-Preferred-Identity header (see <abbr title="Request for Comments">RFC</abbr> 3325)
</p>

</div>

<h3 class="sectionedit56" id="pp_-_process_id">$pp - Process id</h3>
<div class="level3">

<p>
<strong>$pp</strong> - reference to process id (pid)
</p>

</div>

<h3 class="sectionedit57" id="pr_-_protocol_of_received_message">$pr - Protocol of received message</h3>
<div class="level3">

<p>
<strong>$pr</strong> or <strong>$proto</strong> - protocol of received message (udp, tcp, tls, sctp, ws, wss)
</p>

</div>

<h3 class="sectionedit58" id="pu_-_user_in_p-preferred-identity_header_uri">$pU - User in P-Preferred-Identity header URI</h3>
<div class="level3">

<p>
<strong>$pU</strong> - reference to user in request&#039;s P-Preferred-Identity header <abbr title="Uniform Resource Identifier">URI</abbr> (see <abbr title="Request for Comments">RFC</abbr> 3325)
</p>

</div>

<h3 class="sectionedit59" id="pu_-_uri_in_p-preferred-identity_header">$pu - URI in P-Preferred-Identity header</h3>
<div class="level3">

<p>
<strong>$pu</strong> - reference to <abbr title="Uniform Resource Identifier">URI</abbr> in request&#039;s P-Preferred-Identity header (see <abbr title="Request for Comments">RFC</abbr> 3325)
</p>

</div>

<h3 class="sectionedit60" id="rd_-_domain_in_r-uri">$rd - Domain in R-URI</h3>
<div class="level3">

<p>
<strong>$rd</strong> - reference to domain in request&#039;s <abbr title="Uniform Resource Identifier">URI</abbr> (without port) or to the Namespace Specific String of a URN (see <abbr title="Request for Comments">RFC</abbr> 2141)
</p>

<p>
<span style="color: #0000ff">It is a R/W variable (you can assign values to it directly in configuration file)</span>
</p>

</div>

<h3 class="sectionedit61" id="rb_-_body_of_requestreply">$rb - Body of request/reply</h3>
<div class="level3">

<p>
<strong>$rb</strong> - reference to message body
</p>

</div>

<h3 class="sectionedit62" id="rc_-_returned_code">$rc - Returned code</h3>
<div class="level3">

<p>
<strong>$rc</strong> - reference to returned code by last invoked function
</p>

<p>
<strong>$retcode</strong> - same as <strong>$rc</strong>
</p>

</div>

<h3 class="sectionedit63" id="re_-_remote-party-id_header_uri">$re - Remote-Party-ID header URI</h3>
<div class="level3">

<p>
<strong>$re</strong> - reference to Remote-Party-ID header <abbr title="Uniform Resource Identifier">URI</abbr>
</p>

</div>

<h3 class="sectionedit64" id="rm_-_sip_method">$rm - SIP method</h3>
<div class="level3">

<p>
<strong>$rm</strong> - reference to request&#039;s method. Works also for replies (by using the CSeq header)
</p>

</div>

<h3 class="sectionedit65" id="rmid_-_sip_method_id">$rmid - SIP Method ID</h3>
<div class="level3">

<p>
<strong>$rmid</strong> - returns internal integer representation of SIP method type
</p>

</div>

<h3 class="sectionedit66" id="route_uri_-_uri_in_first_route_header">$route_uri - URI in first Route header</h3>
<div class="level3">

<p>
<strong>$route_uri</strong> - returns the string with <abbr title="Uniform Resource Identifier">URI</abbr> field in the first Route header
</p>

</div>

<h3 class="sectionedit67" id="rp_-_port_in_r-uri">$rp - Port in R-URI</h3>
<div class="level3">

<p>
<strong>$rp</strong> - reference to port of R-<abbr title="Uniform Resource Identifier">URI</abbr>
</p>

<p>
<span style="color: #0000ff">It is a R/W variable (you can assign values to it directly in configuration file)</span>
</p>

</div>

<h3 class="sectionedit68" id="rp_-_protocol_of_r-uri">$rP - Protocol of R-URI</h3>
<div class="level3">

<p>
<strong>$rP</strong> - reference to transport protocol of R-<abbr title="Uniform Resource Identifier">URI</abbr>
</p>

</div>

<h3 class="sectionedit69" id="rr_-_sip_reply_reason_phrase">$rr - SIP reply reason phrase</h3>
<div class="level3">

<p>
<strong>$rr</strong> - reference to reply&#039;s reason phrase (the text after reply code)
</p>

</div>

<h3 class="sectionedit70" id="rs_-_sip_reply_code">$rs - SIP reply code</h3>
<div class="level3">

<p>
<strong>$rs</strong> - reference to reply&#039;s status (status-code, response-code, reply-code)
</p>

</div>

<h3 class="sectionedit71" id="rt_-_refer-to_uri">$rt - Refer-to URI</h3>
<div class="level3">

<p>
<strong>$rt</strong> - reference to <abbr title="Uniform Resource Identifier">URI</abbr> of refer-to header
</p>

</div>

<h3 class="sectionedit72" id="ru_-_request_uri">$ru - Request URI</h3>
<div class="level3">

<p>
<strong>$ru</strong> - reference to request&#039;s <abbr title="Uniform Resource Identifier">URI</abbr> (address in the first line of a SIP request)
</p>

<p>
<span style="color: #0000ff">It is a R/W variable (you can assign values to it directly in configuration file)</span>
</p>

</div>

<h3 class="sectionedit73" id="ru_-_username_in_r-uri">$rU - Username in R-URI</h3>
<div class="level3">

<p>
<strong>$rU</strong> - reference to username in request&#039;s <abbr title="Uniform Resource Identifier">URI</abbr> or to the Namespace Identifier of a URN (see <abbr title="Request for Comments">RFC</abbr> 2141)
</p>

<p>
<span style="color: #0000ff">It is a R/W variable (you can assign values to it directly in configuration file)</span>
</p>

</div>

<h3 class="sectionedit74" id="ruid_-_record_internal_unique_id">$ruid - Record internal Unique ID</h3>
<div class="level3">

<p>
<strong>$ruid</strong> - the Record internal Unique ID for the location record selected by calling registrar:lookup()
</p>

</div>

<h3 class="sectionedit75" id="rz_-_uri_scheme_of_r-uri">$rz - URI Scheme of R-URI</h3>
<div class="level3">

<p>
<strong>$rz</strong> - returns R-<abbr title="Uniform Resource Identifier">URI</abbr> scheme, possible values: sip, sips, tel, tels and urn, R-<abbr title="Uniform Resource Identifier">URI</abbr> scheme parsing error should be reflected by value: none
</p>

</div>

<h3 class="sectionedit76" id="ri_-_received_ip_address">$Ri - Received IP address</h3>
<div class="level3">

<p>
<strong>$Ri</strong> - reference to IP address of the interface where the request has been received
</p>

</div>

<h3 class="sectionedit77" id="rp_-_received_port">$Rp - Received port</h3>
<div class="level3">

<p>
<strong>$Rp</strong> - reference to the port where the message was received
</p>

</div>

<h3 class="sectionedit78" id="sf_-_script_flags">$sf - Script flags</h3>
<div class="level3">

<p>
<strong>$sf</strong> - reference to script flags - decimal output
</p>

</div>

<h3 class="sectionedit79" id="sf_-_script_flags1">$sF - Script flags</h3>
<div class="level3">

<p>
<strong>$sF</strong> - reference to script flags - hexa output
</p>

</div>

<h3 class="sectionedit80" id="si_-_source_ip_address">$si - Source IP address</h3>
<div class="level3">

<p>
<strong>$si</strong> - reference to IP source address of the message
</p>

</div>

<h3 class="sectionedit81" id="sp_-_source_port">$sp - Source port</h3>
<div class="level3">

<p>
<strong>$sp</strong> - reference to the source port of the message
</p>

</div>

<h3 class="sectionedit82" id="stat_name_-_statistics">$stat(name) - Statistics</h3>
<div class="level3">

<p>
<strong>$stat(name)</strong> - return the value of statistic item specified by &#039;name&#039;
</p>

</div>

<h3 class="sectionedit83" id="td_-_to_uri_domain">$td - To URI Domain</h3>
<div class="level3">

<p>
<strong>$td</strong> - reference to domain in <abbr title="Uniform Resource Identifier">URI</abbr> of &#039;To&#039; header
</p>

</div>

<h3 class="sectionedit84" id="tn_-_to_display_name">$tn - To display name</h3>
<div class="level3">

<p>
<strong>$tn</strong> - reference to display name of &#039;To&#039; header
</p>

</div>

<h3 class="sectionedit85" id="tt_-_to_tag">$tt - To tag</h3>
<div class="level3">

<p>
<strong>$tt</strong> - reference to tag parameter of &#039;To&#039; header
</p>

</div>

<h3 class="sectionedit86" id="tu_-_to_uri">$tu - To URI</h3>
<div class="level3">

<p>
<strong>$tu</strong> - reference to <abbr title="Uniform Resource Identifier">URI</abbr> of &#039;To&#039; header
</p>

</div>

<h3 class="sectionedit87" id="tu_-_to_uri_username">$tU - To URI Username</h3>
<div class="level3">

<p>
<strong>$tU</strong> - reference to username in <abbr title="Uniform Resource Identifier">URI</abbr> of &#039;To&#039; header
</p>

</div>

<h3 class="sectionedit88" id="tb_-_startup_timestamp">$Tb - Startup timestamp</h3>
<div class="level3">

<p>
<strong>$Tb</strong> - reference to unix timestamp of the time at which kamailio was started (boot time)
</p>

</div>

<h3 class="sectionedit89" id="tf_-_string_formatted_time_-_cached">$Tf - String formatted time - cached</h3>
<div class="level3">

<p>
<strong>$Tf</strong> - reference string formatted time
</p>

<p>
Note: the system time is retrieved only once for each processed SIP message. Subsequent calls of $Tf for same SIP message will return same value.
</p>

</div>

<h3 class="sectionedit90" id="tf_-_string_formatted_time_-_current">$TF - String formatted time - current</h3>
<div class="level3">

<p>
<strong>$TF</strong> - reference string formatted time
</p>

<p>
Note: the system time is computed for each call of $TF. Subsequent calls of $TF for same SIP message may return different values.
</p>

</div>

<h3 class="sectionedit91" id="ts_-_unix_time_stamp_-_cached">$Ts - Unix time stamp - cached</h3>
<div class="level3">

<p>
<strong>$Ts</strong> - reference to unix time stamp
</p>

<p>
Note: the system time is retrieved only once for each processed SIP message. Subsequent calls of $Ts for same SIP message will return same value. 
</p>

</div>

<h3 class="sectionedit92" id="ts_-_unix_time_stamp_-_current">$TS - Unix time stamp - current</h3>
<div class="level3">

<p>
<strong>$TS</strong> - reference to unix time stamp
</p>

<p>
Note: the system time is computed for each call of $TS. Subsequent calls of $TS for same SIP message may return different values.
</p>

</div>

<h3 class="sectionedit93" id="ua_-_user_agent_header">$ua - User agent header</h3>
<div class="level3">

<p>
<strong>$ua</strong> - reference to user agent header field
</p>

</div>

<h2 class="sectionedit94" id="avp_id_-_avps">$avp(id) - AVPs</h2>
<div class="level2">

<p>
<strong>$avp(id)</strong> - the value of the AVP identified by &#039;id&#039;.
</p>

<p>
<strong>$(avp(id)[N])</strong> - represents the value of N-th AVP identified by &#039;id&#039;.
</p>

<p>
The &#039;id&#039; can be:
</p>
<ul>
<li class="level1"><div class="li"> ¡°[(s|i):]name¡± - name is the id of an AVP; &#039;s&#039; and &#039;i&#039; specifies if the id is string or integer. If missing, it is considered to be string.</div>
</li>
<li class="level1"><div class="li"> ¡°name¡± - the name is an AVP alias, or if the alias is not found, it is a string name</div>
</li>
<li class="level1"><div class="li"> pseudo variable - if value of pv is integer, id is integer, if string, id is string</div>
</li>
</ul>

<p>
$(avp(id)[0]) can be written in shorter form as $avp(id) and $avp(s:name) as $avp(name).
</p>

<p>
AVPs are special variables that are attached to SIP transactions. It is a list of pairs (name,value). Before the transaction is created, the AVP list is attached to SIP request. Note that the AVP list works like a stack, last added value is retrieved first, and there can be many values for same AVP name, an assignment to the same AVP name does not overwrite old value, it will add the new value in the list.
</p>

<p>
To delete the first AVP with name &#039;id&#039; you have to assign to it &#039;$null&#039;:
</p>
<pre class="code c">$avp<span class="br0">&#40;</span>id<span class="br0">&#41;</span> <span class="sy0">=</span> $null<span class="sy0">;</span></pre>

<p>
To delete all the AVP with name &#039;id&#039; you have to assign $null to the index &#039;*&#039;:
</p>
<pre class="code c">$<span class="br0">&#40;</span>avp<span class="br0">&#40;</span>id<span class="br0">&#41;</span><span class="br0">&#91;</span><span class="sy0">*</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="sy0">=</span> $null<span class="sy0">;</span></pre>

<p>
To overwrite the value of the AVP with name &#039;id&#039; you have to assign the new value to the index &#039;*&#039;:
</p>
<pre class="code c">$<span class="br0">&#40;</span>avp<span class="br0">&#40;</span>id<span class="br0">&#41;</span><span class="br0">&#91;</span><span class="sy0">*</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="sy0">=</span> newvalue<span class="sy0">;</span></pre>

<p>
The value of an AVP can be integer or string. To assign a value as string, it has to be enclosed in double quotes. To assign the value as integer, it has to be a valid number given without quotes.
</p>

<p>
Example of usage:
</p>
<pre class="code c">$avp<span class="br0">&#40;</span>x<span class="br0">&#41;</span> <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span>  <span class="co2"># assign of integer value</span>
$avp<span class="br0">&#40;</span>x<span class="br0">&#41;</span> <span class="sy0">=</span> <span class="nu0">2</span><span class="sy0">;</span>
$avp<span class="br0">&#40;</span>y<span class="br0">&#41;</span> <span class="sy0">=</span> <span class="st0">&quot;abc&quot;</span><span class="sy0">;</span> <span class="co2"># assign of string value</span>
<span class="kw1">if</span><span class="br0">&#40;</span>$<span class="br0">&#40;</span>avp<span class="br0">&#40;</span>x<span class="br0">&#41;</span><span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">==</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
  ...
<span class="br0">&#125;</span>
$<span class="br0">&#40;</span>avp<span class="br0">&#40;</span>x<span class="br0">&#41;</span><span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="sy0">=</span> $null<span class="sy0">;</span></pre>

<p>
It is a R/W variable (you can assign values to it directly in configuration file).
</p>

</div>

<h2 class="sectionedit95" id="xavp_id_-_xavps">$xavp(id) - XAVPs</h2>
<div class="level2">

<p>
xavp - extended AVP&#039;s - are structures that can store multiple values. They work like a stack, much like AVPs, and are attached to SIP transactions. Each xavp has a name and can contain multiple named values, the structure name and the value name are separated by &#039;?&#039; like $xavp(root?branch) where ¡°root¡± is the name of the structure and branch is a named value. To assign a value use
</p>
<pre class="code c">$xavp<span class="br0">&#40;</span>root<span class="sy0">=&gt;</span>branch<span class="br0">&#41;</span><span class="sy0">=</span><span class="st0">&quot;value&quot;</span><span class="sy0">;</span></pre>

<p>
Like avps, xavp act like a stack. To refer to an existing value, use an index. The newest xavp has index zero [0].
</p>
<pre class="code c">$xavp<span class="br0">&#40;</span>root<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">=&gt;</span>newbranch<span class="br0">&#41;</span><span class="sy0">=</span><span class="nu0">12</span><span class="sy0">;</span></pre>

<p>
If you assign a value without an index, a new xavp is allocated and the old one is pushed up the stack, becoming index [1]. Old index [1] becomes [2] etc.
</p>
<pre class="code c">$xavp<span class="br0">&#40;</span>example<span class="sy0">=&gt;</span>name<span class="br0">&#41;</span><span class="sy0">=</span><span class="st0">&quot;one&quot;</span><span class="sy0">;</span>
<span class="co2">#create new</span>
$xavp<span class="br0">&#40;</span>example<span class="sy0">=&gt;</span>name<span class="br0">&#41;</span><span class="sy0">=</span><span class="st0">&quot;two&quot;</span><span class="sy0">;</span>
<span class="co2">#add extra value to &quot;two&quot;</span>
$xavp<span class="br0">&#40;</span>example<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">=&gt;</span>value<span class="br0">&#41;</span><span class="sy0">=</span><span class="st0">&quot;John&quot;</span><span class="sy0">;</span>
<span class="co2">#add value to first variable - &quot;one&quot;</span>
$xavp<span class="br0">&#40;</span>example<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">=&gt;</span>value<span class="br0">&#41;</span><span class="sy0">=</span><span class="st0">&quot;Anna&quot;</span><span class="sy0">;</span></pre>

<p>
Another example:
</p>
<pre class="code c"><span class="co2"># Create new xavp</span>
$xavp<span class="br0">&#40;</span>sf<span class="sy0">=&gt;</span>uri<span class="br0">&#41;</span><span class="sy0">=</span><span class="st0">&quot;sip:10.10.10.10&quot;</span><span class="sy0">;</span>
&nbsp;
<span class="co2">#assign values</span>
$xavp<span class="br0">&#40;</span>sf<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">=&gt;</span>fr_timer<span class="br0">&#41;</span><span class="sy0">=</span><span class="nu0">10</span><span class="sy0">;</span>
$xavp<span class="br0">&#40;</span>sf<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">=&gt;</span>fr_inv_timer<span class="br0">&#41;</span><span class="sy0">=</span><span class="nu0">15</span><span class="sy0">;</span>
$xavp<span class="br0">&#40;</span>sf<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">=&gt;</span>headers<span class="br0">&#41;</span><span class="sy0">=</span><span class="st0">&quot;X-CustomerID: 1234<span class="es1">\r</span><span class="es1">\n</span>&quot;</span><span class="sy0">;</span>
&nbsp;
<span class="co2">#create new xavp, moving previous one to sf[1]</span>
$xavp<span class="br0">&#40;</span>sf<span class="sy0">=&gt;</span>uri<span class="br0">&#41;</span><span class="sy0">=</span><span class="st0">&quot;sip:10.10.10.11&quot;</span><span class="sy0">;</span>
$xavp<span class="br0">&#40;</span>sf<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">=&gt;</span>fr_timer<span class="br0">&#41;</span><span class="sy0">=</span><span class="nu0">20</span><span class="sy0">;</span>
$xavp<span class="br0">&#40;</span>sf<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">=&gt;</span>fr_inv_timer<span class="br0">&#41;</span><span class="sy0">=</span><span class="nu0">35</span><span class="sy0">;</span>
&nbsp;
<span class="co2">#Create a third xavp</span>
$xavp<span class="br0">&#40;</span>sf<span class="sy0">=&gt;</span>uri<span class="br0">&#41;</span><span class="sy0">=</span><span class="st0">&quot;sip:10.10.10.12&quot;</span><span class="sy0">;</span>
$xavp<span class="br0">&#40;</span>sf<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">=&gt;</span>fr_timer<span class="br0">&#41;</span><span class="sy0">=</span><span class="nu0">10</span><span class="sy0">;</span>
$xavp<span class="br0">&#40;</span>sf<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">=&gt;</span>fr_inv_timer<span class="br0">&#41;</span><span class="sy0">=</span><span class="nu0">15</span><span class="sy0">;</span>
$xavp<span class="br0">&#40;</span>sf<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">=&gt;</span>headers<span class="br0">&#41;</span><span class="sy0">=</span><span class="st0">&quot;X-CustomerID: pw45<span class="es1">\r</span><span class="es1">\n</span>&quot;</span><span class="sy0">;</span></pre>

<p>
xavps are read and write variables. You can create multilevel xavps, as xavps may contain xavps.
</p>

</div>

<h2 class="sectionedit96" id="hdr_name_-_headers">$hdr(name) - Headers</h2>
<div class="level2">

<p>
<strong>$hdr(name)</strong> - represents the body of first header identified by &#039;name&#039;
</p>

<p>
<strong>$(hdr(name)[N])</strong> - represents the body of the N-th header identified by &#039;name&#039;.
</p>

<p>
If [N] is omitted then the body of the first header is printed. The first header is got when N=0, for the second N=1, a.s.o. In case of a comma-separated multi-body headers, it returns all the bodies, comma-separated. To print the last header of that type, use -1, or other negative values to count from the end. No white spaces are allowed inside the specifier (before }, before or after {, [, ] symbols). When N=&#039;*&#039;, all headers of that type are printed.
</p>

<p>
The module should identify compact header names. It is recommended to use dedicated specifiers for headers (e.g., $ua for user agent header), if they are available ¨C they are faster.
</p>

<p>
Example of usage:
</p>
<pre class="code c"><span class="kw1">if</span><span class="br0">&#40;</span>$hdr<span class="br0">&#40;</span>From<span class="br0">&#41;</span><span class="sy0">=</span>~<span class="st0">&quot;sip-router\.org&quot;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
...
<span class="br0">&#125;</span></pre>

<p>
<span style="color: #0000ff">It is read-only variable. You can remove or add headers using functions from textops module.</span>
</p>

</div>

<h2 class="sectionedit97" id="var_name_-_private_memory_variables">$var(name) - Private memory variables</h2>
<div class="level2">

<p>
<strong>$var(name)</strong> - refers to variables that can be used in configuration script, having integer or string value. This kind of variables are faster the AVPs, being referenced directly to memory location. The value of script variables persists over the processing of SIP messages, being specific per each SIP-Router process.
</p>

<p>
Example of usage:
</p>
<pre class="code">$var(a) = 2; -- sets the value of variable &#039;a&#039; to integer &#039;2&#039;
$var(a) = &quot;2&quot;; -- sets the value of variable &#039;a&#039; to string &#039;2&#039;
$var(a) = 3 + (7&amp;(~2));
$var(a) = &quot;sip:&quot; + $au + &quot;@&quot; + $fd; -- compose a value from authentication username and From URI domain

if( [ $var(a) &amp; 4 ] ) {
  xlog(&quot;var a has third bit set\n&quot;);
}</pre>

<p>
Setting a variable to null is actually initializing the value to integer &#039;0&#039;. Script variables don&#039;t have NULL value.
</p>

<p>
<strong>Note:</strong> A script variable persists over the SIP-Router process in which it was initialized, so be sure of giving it a new value before reading it or you&#039;ll get the value asigned in any other previous message processed by the same SIP-Router process (pid).
</p>

<p>
<span style="color: #0000FF">It is a R/W variable (you can assign values to it directly in configuration file)</span>
</p>

<p>
<strong>pv</strong> module can be used to initialize the script variables.
</p>

</div>

<h2 class="sectionedit98" id="shv_name_-_shared_memory_variables">$shv(name) - Shared memory variables</h2>
<div class="level2">

<p>
<strong>$shv(name)</strong>  - it is a class of pseudo-variables stored in shared memory. The value of $shv(name) is visible across all openser processes. Each ¡°shv¡± has single value and it is initialised to integer 0. You can use ¡°shvset¡± parameter of <strong>pv module</strong> to initialize the shared variable. The module exports a set of MI functions to get/set the value of shared variables.
</p>

<p>
Example - shv(name) pseudo-variable usage:
</p>
<pre class="code">...
modparam(&quot;pv&quot;, &quot;shvset&quot;, &quot;debug=i:1&quot;)
...
if ($shv(debug) == 1) {
	xlog(&quot;request: $rm from $fu to $ru\n&quot;);
}
...</pre>

<p>
<span style="color: #0000ff">It is a R/W variable (you can assign values to it directly in configuration file)</span>
</p>

</div>

<h2 class="sectionedit99" id="time_name_-_broken-down_time">$time(name) - Broken-down time</h2>
<div class="level2">

<p>
<strong>$time(name)</strong> - the PV provides access to broken-down time attributes.
</p>

<p>
The &#039;name&#039; can be:
</p>
<ul>
<li class="level1"><div class="li"> sec - return seconds (int 0-59)</div>
</li>
<li class="level1"><div class="li"> min - return minutes (int 0-59)</div>
</li>
<li class="level1"><div class="li"> hour - return hours (int 0-23)</div>
</li>
<li class="level1"><div class="li"> mday - return the day of month (int 0-59)</div>
</li>
<li class="level1"><div class="li"> mon - return the month (int 1-12)</div>
</li>
<li class="level1"><div class="li"> year - return the year (int, e.g., 2008)</div>
</li>
<li class="level1"><div class="li"> wday - return the day of week (int, 1=Sunday - 7=Saturday)</div>
</li>
<li class="level1"><div class="li"> yday - return the day of year (int, 1-366)</div>
</li>
<li class="level1"><div class="li"> isdst - return daylight saving time status (int, 0 - DST off, &gt;0 DST on)</div>
</li>
</ul>

<p>
Example - time(name) pseudo-variable usage:
</p>
<pre class="code c">...
<span class="kw1">if</span> <span class="br0">&#40;</span>$time<span class="br0">&#40;</span>year<span class="br0">&#41;</span> <span class="sy0">==</span> <span class="nu0">2008</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    xlog<span class="br0">&#40;</span><span class="st0">&quot;request: $rm from $fu to $ru in year 2008<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span>
...</pre>

</div>

<h2 class="sectionedit100" id="timef_format_-_strftime_formatted_time">$timef(format) - Strftime Formatted Time</h2>
<div class="level2">

<p>
<strong>$timef(format)</strong> - return current time as formatted by strftime &#039;format&#039;. See &#039;man strftime&#039; to see the available time attribute specifiers.
</p>

<p>
Example:
</p>
<pre class="code c">xlog<span class="br0">&#40;</span><span class="st0">&quot;Today is $timef(%m/%d/%y)<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

</div>

<h2 class="sectionedit101" id="sel_name_-_selects">$sel(name) - Selects</h2>
<div class="level2">

<p>
<strong>$sel(name)</strong> - return the value of <strong>select</strong> specified by name. <strong>select</strong> refers a class of config variables introduced by SER 2.0, allowing to select and return parts of sip messages and not only.
</p>

<p>
List of available selects:
</p>
<ul>
<li class="level1"><div class="li"> <a href="http://sip-router.org/wiki/cookbooks/selects/devel" class="urlextern" title="http://sip-router.org/wiki/cookbooks/selects/devel"  rel="nofollow">http://sip-router.org/wiki/cookbooks/selects/devel</a></div>
</li>
</ul>

<p>
Example:
</p>
<pre class="code c"><span class="kw1">if</span><span class="br0">&#40;</span>$sel<span class="br0">&#40;</span>via<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">host</span><span class="br0">&#41;</span><span class="sy0">==</span><span class="st0">&quot;10.10.10.10&quot;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
  ...
<span class="br0">&#125;</span></pre>

</div>

<h2 class="sectionedit102" id="send_address_attributes">Send Address Attributes</h2>
<div class="level2">

</div>

<h3 class="sectionedit103" id="sndfrom_name">$sndfrom(name)</h3>
<div class="level3">

<p>
<strong>$snd(name)</strong> - return attributes of the address from where the request is going to be sent (local socket).
</p>

<p>
<strong>$sndfrom(name)</strong> - return attributes of the address from where the request is going to be sent (local socket, same as $snd(name)).
</p>

<p>
The name can have same values as for $sndto(¡­).
</p>

</div>

<h3 class="sectionedit104" id="sndto_name">$sndto(name)</h3>
<div class="level3">

<p>
<strong>$sndto(name)</strong> - return attributes of the address to where the request is going to be sent (remote socket).
</p>

<p>
They are available in <strong>onsend_route</strong>. The name can be:
</p>
<ul>
<li class="level1"><div class="li"> ip - IP address of destination</div>
</li>
<li class="level1"><div class="li"> af - address family to be used to send (numeric)</div>
</li>
<li class="level1"><div class="li"> port - port of destination address</div>
</li>
<li class="level1"><div class="li"> proto - transport protocol to be used to send (numeric)</div>
</li>
<li class="level1"><div class="li"> buf - entire send buffer as string</div>
</li>
<li class="level1"><div class="li"> len - length of outgoing packet (length of above buf)</div>
</li>
</ul>

<p>
Example:
</p>
<pre class="code c">onsend_route <span class="br0">&#123;</span>
  <span class="kw1">if</span><span class="br0">&#40;</span>$snd<span class="br0">&#40;</span>ip<span class="br0">&#41;</span><span class="sy0">==</span><span class="st0">&quot;10.10.10.10&quot;</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    ...
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>

</div>

<h2 class="sectionedit105" id="benchmark_module_pseudo-variables">Benchmark module Pseudo-Variables</h2>
<div class="level2">

</div>

<h3 class="sectionedit106" id="bm_time_diff">$BM_time_diff</h3>
<div class="level3">

<p>
$BM_time_diff - the time difference elapsed between calls of bm_start_timer(name) and bm_log_timer(name). The value is 0 if no bm_log_timer() was called. 
</p>

</div>

<h2 class="sectionedit107" id="dialog_module_pseudo-variables">Dialog module Pseudo-Variables</h2>
<div class="level2">

</div>

<h3 class="sectionedit108" id="dlg_attr">$dlg(attr)</h3>
<div class="level3">

<p>
Return the attribute of the current processed dialog.
</p>

<p>
<span style="color: #0000ff">It is R/O variable.</span>
</p>

<p>
The &#039;attr&#039; can be:
</p>
<ul>
<li class="level1"><div class="li"> h_id - hash id</div>
</li>
<li class="level1"><div class="li"> h_entry - hash entry</div>
</li>
<li class="level1"><div class="li"> ref - reference count</div>
</li>
<li class="level1"><div class="li"> state - state of dialog</div>
</li>
<li class="level1"><div class="li"> to_rs - To route set</div>
</li>
<li class="level1"><div class="li"> from_rs - From route set</div>
</li>
<li class="level1"><div class="li"> dflags - dialog internal flags</div>
</li>
<li class="level1"><div class="li"> sflags - dialog script flags</div>
</li>
<li class="level1"><div class="li"> callid - sip call id</div>
</li>
<li class="level1"><div class="li"> to_uri - To <abbr title="Uniform Resource Identifier">URI</abbr></div>
</li>
<li class="level1"><div class="li"> to_tag - To tag</div>
</li>
<li class="level1"><div class="li"> from_uri - From <abbr title="Uniform Resource Identifier">URI</abbr></div>
</li>
<li class="level1"><div class="li"> from_tag - From tag</div>
</li>
<li class="level1"><div class="li"> toroute - timeout route</div>
</li>
<li class="level1"><div class="li"> lifetime - timeout inteval</div>
</li>
<li class="level1"><div class="li"> start_ts - start timestamp</div>
</li>
<li class="level1"><div class="li"> to_cseq - To CSeq</div>
</li>
<li class="level1"><div class="li"> from_cseq - From CSeq</div>
</li>
<li class="level1"><div class="li"> to_contact - To contact address</div>
</li>
<li class="level1"><div class="li"> from_contact - From contact address</div>
</li>
<li class="level1"><div class="li"> to_bindaddr - To bind address</div>
</li>
<li class="level1"><div class="li"> from_bindaddr - From bind address</div>
</li>
</ul>

</div>

<h3 class="sectionedit109" id="dlg_ctx_attr">$dlg_ctx(attr)</h3>
<div class="level3">

<p>
Return the attribute of the context for current processed dialog.
</p>

<p>
<span style="color: #0000ff">It is a R/W variable.</span>
</p>

<p>
The &#039;attr&#039; can be:
</p>
<ul>
<li class="level1"><div class="li"> set</div>
</li>
<li class="level1"><div class="li"> flags</div>
</li>
<li class="level1"><div class="li"> timeout_route</div>
</li>
<li class="level1"><div class="li"> timeout_bye</div>
</li>
</ul>

</div>

<h3 class="sectionedit110" id="dlg_var_key">$dlg_var(key)</h3>
<div class="level3">

<p>
Store and retrieve custom variable for current processed dialog.
</p>

<p>
<span style="color: #0000ff">It is a R/W variable.</span>
</p>

<p>
The &#039;key&#039; can be any string.
</p>

</div>

<h2 class="sectionedit111" id="htable_module_pseudo-variables">HTable module Pseudo-Variables</h2>
<div class="level2">

</div>

<h3 class="sectionedit112" id="sht_htable_key">$sht(htable=&gt;key)</h3>
<div class="level3">

<p>
Access hash table entries.
</p>

<p>
<span style="color: #0000ff">It is a R/W variable, you can assign values to it directly in configuration file.</span>
</p>

<p>
The ¡°htname¡± must be a hash table name defined via ¡°htable¡± parameter.
</p>

<p>
The ¡°key¡± can be:
</p>
<ul>
<li class="level1"><div class="li"> static string - set of characters without pseudo-variables</div>
</li>
<li class="level1"><div class="li"> dynamic string - set of characters that include pseudo-variables. The pseudo-variables will be evaluated at runtime.</div>
</li>
</ul>
<pre class="code">...
modparam(&quot;htable&quot;, &quot;htable&quot;, &quot;a=&gt;size=4;&quot;)
...
$sht(a=&gt;$au) = 1;
$sht(a=&gt;$ru) = $fu;
...</pre>

</div>

<h3 class="sectionedit113" id="shtex_htable_key">$shtex(htable=&gt;key)</h3>
<div class="level3">

<p>
Access hash table entry expire value. Value represents the seconds until the htable entry will expire and be deleted from htable.
</p>

<p>
<span style="color: #0000ff">It is a R/W variable, you can assign values to it directly in configuration file.</span>
</p>

<p>
The ¡°htname¡± must be a hash table name defined via ¡°htable¡± parameter and have auto-expire greater than 0.
</p>

<p>
The ¡°key¡± can be:
</p>
<ul>
<li class="level1"><div class="li"> static string - set of characters without pseudo-variables</div>
</li>
<li class="level1"><div class="li"> dynamic string - set of characters that include pseudo-variables. The pseudo-variables will be evaluated at runtime.</div>
</li>
</ul>
<pre class="code">...
modparam(&quot;htable&quot;, &quot;htable&quot;, &quot;a=&gt;size=4;autoexpire=120;&quot;)
...
$sht(a=&gt;$au) = 1;
$shtex(a=&gt;$au) = 10;
...</pre>

</div>

<h3 class="sectionedit114" id="shtcn_htable_exp">$shtcn(htable=&gt;exp)</h3>
<div class="level3">

<p>
Count items matching the name by regexp.
</p>

<p>
The ¡°htname¡± must be a hash table name defined via ¡°htable¡± parameter.
</p>

<p>
The <strong>exp</strong> can be:
</p>
<ul>
<li class="level1"><div class="li"> reqexp - match by regular expression &#039;regexp&#039;</div>
</li>
<li class="level1"><div class="li"> ~~regexp - match by regular expression &#039;regexp&#039;</div>
</li>
<li class="level1"><div class="li"> ~%prefix - match by right prefix</div>
</li>
<li class="level1"><div class="li"> %~prefix - match by left prefix</div>
</li>
<li class="level1"><div class="li"> ==value - match by string value</div>
</li>
<li class="level1"><div class="li"> eqvalue - match by integer value</div>
</li>
<li class="level1"><div class="li"> * * - (two asterisks next to each other) - count all items</div>
</li>
</ul>

<p>
The <strong>exp</strong> can contain pseudo-variables.
</p>
<pre class="code">...
modparam(&quot;htable&quot;, &quot;htable&quot;, &quot;a=&gt;size=4;&quot;)
...
$sht(a=&gt;abc) = 1;
$shtex(a=&gt;ade) = 10;
xlog(&quot;$shtcn(a=&gt;a.*)&quot;);
...</pre>

</div>

<h3 class="sectionedit115" id="shtcv_htable_exp">$shtcv(htable=&gt;exp)</h3>
<div class="level3">

<p>
Count items matching the value by regexp.
</p>

<p>
The ¡°htname¡± must be a hash table name defined via ¡°htable¡± parameter.
</p>

<p>
The <strong>exp</strong> must follow same rules as for <strong>$shtcn(¡­)</strong>.
</p>
<pre class="code">...
modparam(&quot;htable&quot;, &quot;htable&quot;, &quot;a=&gt;size=4;&quot;)
...
$sht(a=&gt;abc) = &quot;xyz&quot;;
$shtex(a=&gt;ade) = &quot;xwt&quot;;
xlog(&quot;$shtcv(a=&gt;x.*)&quot;);
...</pre>

</div>

<h3 class="sectionedit116" id="shtinc_htable_key">$shtinc(htable=&gt;key)</h3>
<div class="level3">

<p>
Atomic increment of the value for the hash table item.
</p>
<pre class="code">...
modparam(&quot;htable&quot;, &quot;htable&quot;, &quot;a=&gt;size=4;&quot;)
...
$sht(a=&gt;$au) = 1;
xlog(&quot;==== $shtinc(a=&gt;$au)\n&quot;);
...</pre>

</div>

<h3 class="sectionedit117" id="shtdec_htable_key">$shtdec(htable=&gt;key)</h3>
<div class="level3">

<p>
Atomic decrement of the value for the hash table item.
</p>
<pre class="code">...
modparam(&quot;htable&quot;, &quot;htable&quot;, &quot;a=&gt;size=4;&quot;)
...
$sht(a=&gt;$au) = 1;
xlog(&quot;==== $shtdec(a=&gt;$au)\n&quot;);
...</pre>

</div>

<h2 class="sectionedit118" id="memcached_module_pseudo-variables">Memcached module Pseudo-Variables</h2>
<div class="level2">

</div>

<h3 class="sectionedit119" id="mct_key">$mct(key)</h3>
<div class="level3">

<p>
Access hash table entries stored in the memcached server.
</p>

<p>
<span style="color: #0000ff">It is a R/W variable, you can assign values to it directly in configuration file.</span>
</p>

<p>
The ¡°key¡± can be:
</p>
<ul>
<li class="level1"><div class="li"> static string - set of characters without pseudo-variables</div>
</li>
<li class="level1"><div class="li"> dynamic string - set of characters that include pseudo-variables. The pseudo-variables will be evaluated at runtime.</div>
</li>
</ul>

<p>
When assigning values, the default expiry will be used.
</p>
<pre class="code">...
$mct($au) = 1;
$mct($ru) = $fu;
$mct(test) = 1;
xlog(&quot;stored value is $mct(test)&quot;);
$mct(test) = null; # delete it
xlog(&quot;stored value is $mct(test)&quot;); # will return &lt;null&gt;
...</pre>

</div>

<h3 class="sectionedit120" id="mct_key_expiry">$mct(key=&gt;expiry)</h3>
<div class="level3">

<p>
Using this alternative format, the default expiry may be overidden by including a custom value at time of assignment.
</p>
<pre class="code">...
$mct(test=&gt;30) = 1; # set expire time to 30 seconds
xlog(&quot;stored value is $mct(test)&quot;);
# sleep 30 seconds
xlog(&quot;stored value is $mct(test)&quot;); # will return &lt;null&gt;
...</pre>

</div>

<h3 class="sectionedit121" id="mcinc_key">$mcinc(key)</h3>
<div class="level3">

<p>
Do a atomic increment operation on the value stored in memcached. You need to add a value previously.
</p>

<p>
<span style="color: #0000ff">It is a R/W variable, you can assign values to it directly in configuration file.</span>
</p>

<p>
The ¡°key¡± can be:
</p>
<ul>
<li class="level1"><div class="li"> static string - set of characters without pseudo-variables</div>
</li>
<li class="level1"><div class="li"> dynamic string - set of characters that include pseudo-variables. The pseudo-variables will be evaluated at runtime.</div>
</li>
</ul>
<pre class="code">...
$mct(cnt) = 1;
$mcinc(cnt) = 2; # increment by 2
xlog(&quot;counter is now $mct(cnt)&quot;);
...</pre>

</div>

<h3 class="sectionedit122" id="mcdec_key">$mcdec(key)</h3>
<div class="level3">

<p>
Do a atomic decrement operation on the value stored in memcached. You need to add a value previously.
</p>

<p>
<span style="color: #0000ff">It is a R/W variable, you can assign values to it directly in configuration file.</span>
</p>

<p>
The ¡°key¡± can be:
</p>
<ul>
<li class="level1"><div class="li"> static string - set of characters without pseudo-variables</div>
</li>
<li class="level1"><div class="li"> dynamic string - set of characters that include pseudo-variables. The pseudo-variables will be evaluated at runtime.</div>
</li>
</ul>
<pre class="code">...
$mct(cnt) = 10;
$mcdec(cnt) = 2; # decrement by 2
xlog(&quot;counter is now $mct(cnt)&quot;);
...</pre>

</div>

<h2 class="sectionedit123" id="xmlops_pseudo-variables">XMLOPS Pseudo-Variables</h2>
<div class="level2">

</div>

<h3 class="sectionedit124" id="xml_name_spec">$xml(name=&gt;spec)</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> name - id to refer the documet</div>
</li>
<li class="level1"><div class="li"> <abbr title="specification">spec</abbr> - specifier:</div>
<ul>
<li class="level2"><div class="li"> doc - set/get the document as text</div>
</li>
<li class="level2"><div class="li"> xpath:xpath-expression - evaluate xpath expression</div>
</li>
</ul>
</li>
</ul>

<p>
Example:
</p>
<pre class="code">$xml(x=&gt;doc) = &#039;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;a&gt;&lt;b&gt;test&lt;/b&gt;&lt;/a&gt;&#039;;
xlog(&quot;content of node b: $xml(x=&gt;xpath:/a/b/text())\n&quot;);
$xml(x=&gt;xpath:/a/b) = &quot;1234&quot;;</pre>

</div>

<h2 class="sectionedit125" id="tmx_module_pseudo-variables">TMX module Pseudo-Variables</h2>
<div class="level2">

</div>

<h3 class="sectionedit126" id="t_branch_idx">$T_branch_idx</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> the index (starting with 1 for the first branch) of the branch for which is executed the branch_route[]. If used outside of branch_route[] block, the value is &#039;0&#039;.</div>
</li>
</ul>

</div>

<h3 class="sectionedit127" id="t_reply_ruid">$T_reply_ruid</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> the ruid stored in the current branch of the transaction. The ruid is stored in a branch from the details in a contact binding. In a event_route[tm:branch-failure] block, this is the ruid of the branch that sent a failure reply. In a failure_route[] block, this is the ruid of the winning failure response.</div>
</li>
</ul>

</div>

<h3 class="sectionedit128" id="t_reply_code">$T_reply_code</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> the code of the reply, as follows: in request_route will be the last stateful sent reply; in reply_route will be the current processed reply; in failure_route will be the negative winning reply. In case of no-reply or error, &#039;0&#039; value is returned</div>
</li>
</ul>

</div>

<h3 class="sectionedit129" id="t_req_pv">$T_req(pv)</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> can be used in reply routes or inside the modules to get access to attributes of the request belonging to same transaction as the reply</div>
</li>
</ul>
<pre class="code">route {
  t_on_reply(&quot;1&quot;);
  t_relay();
}

onreply_route[1] {
  xlog(&quot;Request SRCIP:PORT = $T_req($si):$T_req($sp)\n&quot;);
}</pre>

</div>

<h3 class="sectionedit130" id="t_rpl_pv">$T_rpl(pv)</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> can be used in failure routes or inside the modules to get access to attributes of the winning reply belonging to same transaction as the request</div>
</li>
</ul>
<pre class="code">route {
  t_on_failure(&quot;1&quot;);
  t_relay();
}

failure_route[1] {
  xlog(&quot;Reply SRCIP:PORT = $T_rpl($si):$T_rpl($sp)\n&quot;);
}</pre>

</div>

<h3 class="sectionedit131" id="t_inv_pv">$T_inv(pv)</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> can be used in request routes or inside the modules to get access to attributes of the INVITE request while processing a CANCEL.</div>
</li>
</ul>
<pre class="code">route {
  if(is_method(&quot;CANCEL&quot;))
  {
     if($T_inv($mf) &amp; 1 )
     {
        # first flag is set in the INVITE transaction
     }
  }
}</pre>

</div>

<h3 class="sectionedit132" id="t_name">$T(name)</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> pseudo-variable class to access TM attributes</div>
</li>
</ul>

<p>
The <strong>name</strong> can be:
</p>
<ul>
<li class="level1"><div class="li"> id_index - return the internal index of current transaction</div>
</li>
<li class="level1"><div class="li"> id_label - return the internal label of current transaction</div>
</li>
<li class="level1"><div class="li"> reply_code - alias to $T_reply_code</div>
</li>
<li class="level1"><div class="li"> branch_index - alias to $T_branch_idx</div>
</li>
<li class="level1"><div class="li"> reply_type - 1 if it is a local generated reply, 0 - if no reply for transaction or it is a received reply</div>
</li>
</ul>

<p>
Note: the pair (id_index,id_label) uniquely identifies a transaction.
</p>

</div>

<h3 class="sectionedit133" id="t_branch_name">$T_branch(name)</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> pseudo-variable class to access TM branch attributes</div>
</li>
</ul>

<p>
The <strong>name</strong> can be:
</p>
<ul>
<li class="level1"><div class="li"> flags - Flags of the branch. In a event_route[tm:branch-failure] block, this is the flags of the branch that sent a failure reply. In a failure_route[] block, this is the flags of the winning failure response.</div>
</li>
</ul>

</div>

<h2 class="sectionedit134" id="uac_module_pseudo-variables">UAC module Pseudo-Variables</h2>
<div class="level2">

</div>

<h3 class="sectionedit135" id="uac_req_key">$uac_req(key)</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> used to build the input for uac_send_req() function of UAC module</div>
</li>
</ul>

<p>
key can be:
</p>
<ul>
<li class="level1"><div class="li"> method - SIP method</div>
</li>
<li class="level1"><div class="li"> ruri - request <abbr title="Uniform Resource Identifier">URI</abbr></div>
</li>
<li class="level1"><div class="li"> furi - From <abbr title="Uniform Resource Identifier">URI</abbr></div>
</li>
<li class="level1"><div class="li"> turi - To <abbr title="Uniform Resource Identifier">URI</abbr></div>
</li>
<li class="level1"><div class="li"> ouri - Outbound proxy <abbr title="Uniform Resource Identifier">URI</abbr></div>
</li>
<li class="level1"><div class="li"> hdrs - SIP Headers</div>
</li>
<li class="level1"><div class="li"> body - Body</div>
</li>
<li class="level1"><div class="li"> auser - authentication username</div>
</li>
<li class="level1"><div class="li"> apasswd - authentication password</div>
</li>
<li class="level1"><div class="li"> sock - local socket to be used for sending (proto:address:port)</div>
</li>
<li class="level1"><div class="li"> all - alias useful to reset all fields - $uac_req(all) = $null;</div>
</li>
</ul>
<pre class="code c">$uac_req<span class="br0">&#40;</span>method<span class="br0">&#41;</span><span class="sy0">=</span><span class="st0">&quot;OPTIONS&quot;</span><span class="sy0">;</span>
$uac_req<span class="br0">&#40;</span>ruri<span class="br0">&#41;</span><span class="sy0">=</span><span class="st0">&quot;sip:kamailio.org&quot;</span><span class="sy0">;</span>
$uac_req<span class="br0">&#40;</span>furi<span class="br0">&#41;</span><span class="sy0">=</span><span class="st0">&quot;sip:kamailio.org&quot;</span><span class="sy0">;</span>
$uac_req<span class="br0">&#40;</span>turi<span class="br0">&#41;</span><span class="sy0">=</span><span class="st0">&quot;sip:kamailio.org&quot;</span><span class="sy0">;</span>
uac_req_send<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

</div>

<h2 class="sectionedit136" id="nathelper_module_pseudo-variables">Nathelper module Pseudo-Variables</h2>
<div class="level2">

</div>

<h3 class="sectionedit137" id="rr_count">$rr_count</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> Number of Record Routes in received SIP request or reply.</div>
</li>
</ul>

</div>

<h3 class="sectionedit138" id="rr_top_count">$rr_top_count</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> If topmost Record Route in received SIP request or reply is a double Record Route, value of $rr_top_count is 2. If it a single Record Route, value of $rr_top_count is 1. If there is no Record Route(s), value of $rr_top_count is 0.</div>
</li>
</ul>

</div>

<h2 class="sectionedit139" id="mqueue_module_pseudo-variables">MQueue module Pseudo-Variables</h2>
<div class="level2">

</div>

<h3 class="sectionedit140" id="mqk_q">$mqk(q)</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> return the key of fetched item from queue q</div>
</li>
</ul>

</div>

<h3 class="sectionedit141" id="mqv_q">$mqv(q)</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> return the value of fetched item from queue q</div>
</li>
</ul>
<pre class="code c">...
<span class="me1">mq_add</span><span class="br0">&#40;</span><span class="st0">&quot;myq&quot;</span><span class="sy0">,</span> <span class="st0">&quot;$rU&quot;</span><span class="sy0">,</span> <span class="st0">&quot;call from $fU at $Tf&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
...
<span class="kw1">while</span><span class="br0">&#40;</span>mq_fetch<span class="br0">&#40;</span><span class="st0">&quot;myq&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
   xlog<span class="br0">&#40;</span><span class="st0">&quot;$mqk(myq) - $mqv(myq)<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span>
...</pre>

</div>

<h2 class="sectionedit142" id="timeval">TimeVal</h2>
<div class="level2">

</div>

<h3 class="sectionedit143" id="tv_name">$TV(name)</h3>
<div class="level3">

<p>
Seconds and microseconds taken from struct timeval.
</p>
<ul>
<li class="level1"><div class="li"> $TV(s) - seconds (cached at first call per sip message)</div>
</li>
<li class="level1"><div class="li"> $TV(u) - microseconds (cached at first call per sip message)</div>
</li>
<li class="level1"><div class="li"> $TV(sn) - seconds (not cached)</div>
</li>
<li class="level1"><div class="li"> $TV(un) - microseconds (not cached)</div>
</li>
<li class="level1"><div class="li"> $TV(Sn) - string representation seconds.microseconds (not cached)</div>
</li>
</ul>

</div>

<h2 class="sectionedit144" id="next_hop_address">Next hop address</h2>
<div class="level2">

</div>

<h3 class="sectionedit145" id="nh_key">$nh(key)</h3>
<div class="level3">

<p>
Return attributes of next hop for the SIP request. Address is taken from dst_uri, if set, if not from new r-uri or original r-uri.
</p>
<ul>
<li class="level1"><div class="li"> $nh(u) - uri (lower case u)</div>
</li>
<li class="level1"><div class="li"> $nh(U) - username (upper case u)</div>
</li>
<li class="level1"><div class="li"> $nh(d) - domain</div>
</li>
<li class="level1"><div class="li"> $nh(p) - port (lower case p)</div>
</li>
<li class="level1"><div class="li"> $nh(P) - transport protocol (upper case p)</div>
</li>
</ul>

</div>

<h2 class="sectionedit146" id="geoip_module_pseudo-variables">GeoIP module Pseudo-Variables</h2>
<div class="level2">

</div>

<h3 class="sectionedit147" id="gip_pvc_key">$gip(pvc=&gt;key)</h3>
<div class="level3">

<p>
Variables exported by GeoIP module, returning geo-location attributes. The attributes are populated upon calling function <strong>geoip_match(ipaddr, pvc)</strong>.
</p>

<p>
<strong>pvc</strong> (container id) is second parameter of geoip_match(..) and <strong>key</strong> can be:
</p>
<ul>
<li class="level1"><div class="li"> cc - country code</div>
</li>
<li class="level1"><div class="li"> tz - time zone</div>
</li>
<li class="level1"><div class="li"> zip - postal code</div>
</li>
<li class="level1"><div class="li"> lat - latitude</div>
</li>
<li class="level1"><div class="li"> lon - longitude</div>
</li>
<li class="level1"><div class="li"> dma - dma code</div>
</li>
<li class="level1"><div class="li"> ips - ip start</div>
</li>
<li class="level1"><div class="li"> ipe - ip end</div>
</li>
<li class="level1"><div class="li"> city - city</div>
</li>
<li class="level1"><div class="li"> area - area code</div>
</li>
<li class="level1"><div class="li"> regc - region</div>
</li>
<li class="level1"><div class="li"> regn - region name</div>
</li>
<li class="level1"><div class="li"> metro - metro code</div>
</li>
</ul>

<p>
You can call several time <strong>geoip_match(ipaddr, pvc)</strong> with different ip address and containers in your config, to compare, for example, attributes of source and destination of a call.
</p>
<pre class="code c">geoip_match<span class="br0">&#40;</span><span class="st0">&quot;$si&quot;</span><span class="sy0">,</span> <span class="st0">&quot;src&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
geoip_match<span class="br0">&#40;</span><span class="st0">&quot;$nh(d)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;dst&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">if</span><span class="br0">&#40;</span>$gip<span class="br0">&#40;</span>src<span class="sy0">=&gt;</span>cc<span class="br0">&#41;</span><span class="sy0">==</span>$gip<span class="br0">&#40;</span>dst<span class="sy0">=&gt;</span>cc<span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    <span class="co2"># source and destination from same country</span>
<span class="br0">&#125;</span></pre>

</div>

<h2 class="sectionedit148" id="tls_module_pseudo-variables">TLS module Pseudo-Variables</h2>
<div class="level2">

</div>

<h3 class="sectionedit149" id="tls_version">$tls_version</h3>
<div class="level3">

</div>

<h3 class="sectionedit150" id="tls_description">$tls_description</h3>
<div class="level3">

</div>

<h3 class="sectionedit151" id="tls_cipher_info">$tls_cipher_info</h3>
<div class="level3">

</div>

<h3 class="sectionedit152" id="tls_cipher_bits">$tls_cipher_bits</h3>
<div class="level3">

</div>

<h3 class="sectionedit153" id="tls_peer_version">$tls_peer_version</h3>
<div class="level3">

</div>

<h3 class="sectionedit154" id="tls_my_version">$tls_my_version</h3>
<div class="level3">

</div>

<h3 class="sectionedit155" id="tls_peer_serial">$tls_peer_serial</h3>
<div class="level3">

</div>

<h3 class="sectionedit156" id="tls_my_serial">$tls_my_serial</h3>
<div class="level3">

</div>

<h3 class="sectionedit157" id="tls_peer_subject">$tls_peer_subject</h3>
<div class="level3">

</div>

<h3 class="sectionedit158" id="tls_peer_issuer">$tls_peer_issuer</h3>
<div class="level3">

</div>

<h3 class="sectionedit159" id="tls_my_subject">$tls_my_subject</h3>
<div class="level3">

</div>

<h3 class="sectionedit160" id="tls_my_issuer">$tls_my_issuer</h3>
<div class="level3">

</div>

<h3 class="sectionedit161" id="tls_peer_subject_cn">$tls_peer_subject_cn</h3>
<div class="level3">

</div>

<h3 class="sectionedit162" id="tls_peer_issuer_cn">$tls_peer_issuer_cn</h3>
<div class="level3">

</div>

<h3 class="sectionedit163" id="tls_my_subject_cn">$tls_my_subject_cn</h3>
<div class="level3">

</div>

<h3 class="sectionedit164" id="tls_my_issuer_cn">$tls_my_issuer_cn</h3>
<div class="level3">

</div>

<h3 class="sectionedit165" id="tls_peer_subject_locality">$tls_peer_subject_locality</h3>
<div class="level3">

</div>

<h3 class="sectionedit166" id="tls_peer_issuer_locality">$tls_peer_issuer_locality</h3>
<div class="level3">

</div>

<h3 class="sectionedit167" id="tls_my_subject_locality">$tls_my_subject_locality</h3>
<div class="level3">

</div>

<h3 class="sectionedit168" id="tls_my_issuer_locality">$tls_my_issuer_locality</h3>
<div class="level3">

</div>

<h3 class="sectionedit169" id="tls_peer_subject_country">$tls_peer_subject_country</h3>
<div class="level3">

</div>

<h3 class="sectionedit170" id="tls_peer_issuer_country">$tls_peer_issuer_country</h3>
<div class="level3">

</div>

<h3 class="sectionedit171" id="tls_my_subject_country">$tls_my_subject_country</h3>
<div class="level3">

</div>

<h3 class="sectionedit172" id="tls_my_issuer_country">$tls_my_issuer_country</h3>
<div class="level3">

</div>

<h3 class="sectionedit173" id="tls_peer_subject_state">$tls_peer_subject_state</h3>
<div class="level3">

</div>

<h3 class="sectionedit174" id="tls_peer_issuer_state">$tls_peer_issuer_state</h3>
<div class="level3">

</div>

<h3 class="sectionedit175" id="tls_my_subject_state">$tls_my_subject_state</h3>
<div class="level3">

</div>

<h3 class="sectionedit176" id="tls_my_issuer_state">$tls_my_issuer_state</h3>
<div class="level3">

</div>

<h3 class="sectionedit177" id="tls_peer_subject_organization">$tls_peer_subject_organization</h3>
<div class="level3">

</div>

<h3 class="sectionedit178" id="tls_peer_issuer_organization">$tls_peer_issuer_organization</h3>
<div class="level3">

</div>

<h3 class="sectionedit179" id="tls_my_subject_organization">$tls_my_subject_organization</h3>
<div class="level3">

</div>

<h3 class="sectionedit180" id="tls_my_issuer_organization">$tls_my_issuer_organization</h3>
<div class="level3">

</div>

<h3 class="sectionedit181" id="tls_peer_subject_unit">$tls_peer_subject_unit</h3>
<div class="level3">

</div>

<h3 class="sectionedit182" id="tls_peer_issuer_unit">$tls_peer_issuer_unit</h3>
<div class="level3">

</div>

<h3 class="sectionedit183" id="tls_my_subject_unit">$tls_my_subject_unit</h3>
<div class="level3">

</div>

<h3 class="sectionedit184" id="tls_my_issuer_unit">$tls_my_issuer_unit</h3>
<div class="level3">

</div>

<h3 class="sectionedit185" id="tls_peer_san_email">$tls_peer_san_email</h3>
<div class="level3">

</div>

<h3 class="sectionedit186" id="tls_my_san_email">$tls_my_san_email</h3>
<div class="level3">

</div>

<h3 class="sectionedit187" id="tls_peer_san_hostname">$tls_peer_san_hostname</h3>
<div class="level3">

</div>

<h3 class="sectionedit188" id="tls_my_san_hostname">$tls_my_san_hostname</h3>
<div class="level3">

</div>

<h3 class="sectionedit189" id="tls_peer_san_uri">$tls_peer_san_uri</h3>
<div class="level3">

</div>

<h3 class="sectionedit190" id="tls_my_san_uri">$tls_my_san_uri</h3>
<div class="level3">

</div>

<h3 class="sectionedit191" id="tls_peer_san_ip">$tls_peer_san_ip</h3>
<div class="level3">

</div>

<h3 class="sectionedit192" id="tls_my_san_ip">$tls_my_san_ip</h3>
<div class="level3">

</div>

<h2 class="sectionedit193" id="xhttp_module_pseudo-variables">XHTTP module Pseudo-Variables</h2>
<div class="level2">

</div>

<h3 class="sectionedit194" id="hu">$hu</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> <abbr title="Uniform Resource Locator">URL</abbr> of http request.</div>
</li>
</ul>

</div>

<h2 class="sectionedit195" id="msrp_module_pseudo_variables">MSRP Module Pseudo Variables</h2>
<div class="level2">

<p>
This class of pseudo-variables is exported by MSRP module and give access to attributes of MSRP frames.
</p>

</div>

<h3 class="sectionedit196" id="msrp_buf">$msrp(buf)</h3>
<div class="level3">

<p>
The entire content of MSRP frame - first line, headers, body and end-line.
</p>

</div>

<h3 class="sectionedit197" id="msrp_body">$msrp(body)</h3>
<div class="level3">

<p>
The body of MSRP frame.
</p>

</div>

<h3 class="sectionedit198" id="msrp_code">$msrp(code)</h3>
<div class="level3">

<p>
The code of MSRP replies.
</p>

</div>

<h3 class="sectionedit199" id="msrp_hdrs">$msrp(hdrs)</h3>
<div class="level3">

<p>
The headers in a MSRP frame.
</p>

</div>

<h3 class="sectionedit200" id="msrp_msgid">$msrp(msgid)</h3>
<div class="level3">

<p>
The body of Message-Id header.
</p>

</div>

<h3 class="sectionedit201" id="msrp_method">$msrp(method)</h3>
<div class="level3">

<p>
The method of a MSRP request.
</p>

</div>

<h3 class="sectionedit202" id="msrp_buflen">$msrp(buflen)</h3>
<div class="level3">

<p>
The length of entire MSRP frame.
</p>

</div>

<h3 class="sectionedit203" id="msrp_sessid">$msrp(sessid)</h3>
<div class="level3">

<p>
The session id for MSRP frame. It is taken from the first MSRP <abbr title="Uniform Resource Identifier">URI</abbr> in To-Path header.
</p>

</div>

<h3 class="sectionedit204" id="msrp_reason">$msrp(reason)</h3>
<div class="level3">

<p>
The reason text in a MSRP reply.
</p>

</div>

<h3 class="sectionedit205" id="msrp_crthop">$msrp(crthop)</h3>
<div class="level3">

<p>
The <abbr title="Uniform Resource Identifier">URI</abbr> for current hop - it is the first <abbr title="Uniform Resource Identifier">URI</abbr> in To-Path header.
</p>

</div>

<h3 class="sectionedit206" id="msrp_bodylen">$msrp(bodylen)</h3>
<div class="level3">

<p>
The length of the body in MSRP frame.
</p>

</div>

<h3 class="sectionedit207" id="msrp_transid">$msrp(transid)</h3>
<div class="level3">

<p>
The transaction ID from the first line of MSRP frame.
</p>

</div>

<h3 class="sectionedit208" id="msrp_prevhop">$msrp(prevhop)</h3>
<div class="level3">

<p>
The MSRP <abbr title="Uniform Resource Identifier">URI</abbr> of the previous hop - the first address in From-Path header.
</p>

</div>

<h3 class="sectionedit209" id="msrp_nexthop">$msrp(nexthop)</h3>
<div class="level3">

<p>
The <abbr title="Uniform Resource Identifier">URI</abbr> of the next hop - the second address in To-Path header.
</p>

</div>

<h3 class="sectionedit210" id="msrp_lasthop">$msrp(lasthop)</h3>
<div class="level3">

<p>
The last hop <abbr title="Uniform Resource Identifier">URI</abbr> - the last address in To-Path header.
</p>

</div>

<h3 class="sectionedit211" id="msrp_srcaddr">$msrp(srcaddr)</h3>
<div class="level3">

<p>
The address of the previous hop set as MSRP <abbr title="Uniform Resource Identifier">URI</abbr> using received source IP and port.
</p>

</div>

<h3 class="sectionedit212" id="msrp_srcsock">$msrp(srcsock)</h3>
<div class="level3">

<p>
The local socket where the MSRP frame was received, set as **proto:ipaddr:port¡°.
</p>

</div>

<h3 class="sectionedit213" id="msrp_firsthop">$msrp(firsthop)</h3>
<div class="level3">

<p>
The <abbr title="Uniform Resource Identifier">URI</abbr> of the first hop - the last address in From-Path header.
</p>

</div>

<h3 class="sectionedit214" id="msrp_prevhops">$msrp(prevhops)</h3>
<div class="level3">

<p>
The number of previous hops - it is the number of addresses in From-Path header.
</p>

</div>

<h3 class="sectionedit215" id="msrp_nexthops">$msrp(nexthops)</h3>
<div class="level3">

<p>
The number of next hops - it is the number of addresses in To-Path header minus 1 (the first address in To-Path is current hop).
</p>

</div>

<h3 class="sectionedit216" id="msrp_conid">$msrp(conid)</h3>
<div class="level3">

<p>
The internal integer id for TCP/TLS connection.
</p>

</div>

<h2 class="sectionedit217" id="sipt_module_pseudo-variables">SIPT module Pseudo-Variables</h2>
<div class="level2">

</div>

<h3 class="sectionedit218" id="sipt_calling_party_numberpresentationsipt_presentation">$sipt(calling_party_number.presentation) / $sipt_presentation</h3>
<div class="level3">

<p>
Returns the value of the Address presentation restricted indicator contained in the Calling Party Number header of the IAM message if it exists. Returns -1 if there isn&#039;t a Calling Party Number header.
</p>

</div>

<h3 class="sectionedit219" id="sipt_calling_party_numberscreeningsipt_screening">$sipt(calling_party_number.screening) / $sipt_screening</h3>
<div class="level3">

<p>
Returns the value of the Screening Indicator contained in the Calling Party Number header of the IAM message if it exists. Returns -1 if there isn&#039;t a Calling Party Number header.
</p>

</div>

<h3 class="sectionedit220" id="sipt_hop_countersipt_hop_counter">$sipt(hop_counter) / $sipt_hop_counter</h3>
<div class="level3">

<p>
Returns the value of the Hop Counter for the IAM message if it exists. Returns -1 if there isn&#039;t a hop counter.
</p>

</div>

<h3 class="sectionedit221" id="sipt_calling_party_categorysipt_cpcsipt_cpc">$sipt(calling_party_category) / $sipt(cpc) / $sipt_cpc</h3>
<div class="level3">

<p>
Returns the value of the Calling Party Category for the IAM message. Returns -1 if there is a parsing error.
</p>

</div>

<h3 class="sectionedit222" id="sipt_calling_party_numbernature_of_addresssipt_calling_party_numbernaisipt_calling_party_nai">$sipt(calling_party_number.nature_of_address) / $sipt.(calling_party_number.nai) / $sipt_calling_party_nai</h3>
<div class="level3">

<p>
Returns the value of the Nature of Address Indicator of the Calling Party for the IAM message. Returns -1 if there is a parsing error or if the Calling Party Number is not present.
</p>

</div>

<h3 class="sectionedit223" id="sipt_called_party_numbernature_of_addresssipt_called_party_numbernaisipt_called_party_nai">$sipt(called_party_number.nature_of_address) / $sipt(called_party_number.nai) / $sipt_called_party_nai</h3>
<div class="level3">

<p>
Returns the value of the Nature of Address Indicator of the Called Party for the IAM message. Returns -1 if there is a parsing error.
</p>

</div>

<h3 class="sectionedit224" id="sipt_event_info">$sipt(event_info)</h3>
<div class="level3">

<p>
Returns the value  of the Event Info header of the CPG message. Returns -1 if there is a parsing error.
</p>

</div>

<h2 class="sectionedit225" id="cfg_key_-_config_file_attributes">$cfg(key) - Config File Attributes</h2>
<div class="level2">

<p>
Attributes related to configuration file.
</p>

<p>
The key can be:
</p>

<p>
* line - return current line in config
* name - return the name of current config file
</p>

<p>
Example:
</p>
<pre class="code c">send_reply<span class="br0">&#40;</span><span class="st0">&quot;404&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Not found at line $cfg(line)&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

</div>

<h2 class="sectionedit226" id="dns_pvid_key_-_dns_query_result">$dns(pvid=&gt;key) - DNS Query Result</h2>
<div class="level2">

<p>
This variable stores the <abbr title="Domain Name System">DNS</abbr> result details after a call of dns_query(hostname, pvid) function from ipops module.
</p>
<ul>
<li class="level1"><div class="li"> pvid can be any string</div>
</li>
<li class="level1"><div class="li"> key can be:</div>
<ul>
<li class="level2"><div class="li"> count - number of addresses</div>
</li>
<li class="level2"><div class="li"> ipv4 - set to 1 if at least one ipv4 address (otherwise 0)</div>
</li>
<li class="level2"><div class="li"> ipv6 - set to 1 if at least one ipv6 address (otherwise 0)</div>
</li>
<li class="level2"><div class="li"> addr[index] - the address as string from position index in the list (0 based indexing)</div>
</li>
<li class="level2"><div class="li"> type[index] - the type of address from position index in the list (0 based indexing), the value is 4 for ipv4 and 6 for ipv6</div>
</li>
</ul>
</li>
</ul>

<p>
The index can be an integer or a variable with integer value. First address has the index 0. If negative value, the returned address is counted from the end of the list, -1 being the last address. If no index is provided, then the first address is returned.
</p>
<pre class="code c"><span class="kw1">if</span><span class="br0">&#40;</span>dns_query<span class="br0">&#40;</span><span class="st0">&quot;test.com&quot;</span><span class="sy0">,</span> <span class="st0">&quot;xyz&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    xlog<span class="br0">&#40;</span><span class="st0">&quot; number of addresses: $dns(xyz=&gt;count)<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    xlog<span class="br0">&#40;</span><span class="st0">&quot; ipv4 address found: $dns(xyz=&gt;ipv4)<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    xlog<span class="br0">&#40;</span><span class="st0">&quot; ipv6 address found: $dns(xyz=&gt;ipv6)<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    $var<span class="br0">&#40;</span>i<span class="br0">&#41;</span> <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span>
    <span class="kw1">while</span><span class="br0">&#40;</span>$var<span class="br0">&#40;</span>i<span class="br0">&#41;</span><span class="sy0">&amp;</span>lt<span class="sy0">;</span>$dns<span class="br0">&#40;</span>xyz<span class="sy0">=&gt;</span>count<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        xlog<span class="br0">&#40;</span><span class="st0">&quot; #[$var(i)] type ($dns(xyz=&gt;type[$var(i)]))&quot;</span>
             <span class="st0">&quot; addr [$dns(xyz=&gt;addr[$var(i)])]<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        $var<span class="br0">&#40;</span>i<span class="br0">&#41;</span> <span class="sy0">=</span> $var<span class="br0">&#40;</span>i<span class="br0">&#41;</span> <span class="sy0">+</span> <span class="nu0">1</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>

</div>

<h2 class="sectionedit227" id="hn_key_-_hostname_details">$HN(key) - Hostname details</h2>
<div class="level2">

<p>
Give local hostname details (implemented by ipops module).
</p>

<p>
The key can be:
</p>
<ul>
<li class="level1"><div class="li"> n - the hostname</div>
</li>
<li class="level1"><div class="li"> f - the fullname</div>
</li>
<li class="level1"><div class="li"> d - the domain</div>
</li>
<li class="level1"><div class="li"> i - the ip address</div>
</li>
</ul>
<pre class="code c">xlog<span class="br0">&#40;</span><span class="st0">&quot;local hostanme is $HN(n)<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

</div>

<h2 class="sectionedit228" id="c_xy_-_foreground_and_background_colors">$C(xy) - Foreground and background colors</h2>
<div class="level2">

<p>
$C(xy) - reference to an escape sequence. ¡°x¡± represents the foreground color and ¡°y¡± represents the background color.
</p>

<p>
Colors could be:
</p>
<ul>
<li class="level1"><div class="li"> x : default color of the terminal</div>
</li>
<li class="level1"><div class="li"> s : Black</div>
</li>
<li class="level1"><div class="li"> r : Red</div>
</li>
<li class="level1"><div class="li"> g : Green</div>
</li>
<li class="level1"><div class="li"> y : Yellow</div>
</li>
<li class="level1"><div class="li"> b : Blue</div>
</li>
<li class="level1"><div class="li"> p : Purple</div>
</li>
<li class="level1"><div class="li"> c : Cyan</div>
</li>
<li class="level1"><div class="li"> w : White </div>
</li>
</ul>

</div>

<h2 class="sectionedit229" id="examples">Examples</h2>
<div class="level2">

<p>
A few examples of usage.
</p>

<p>
Example 1. Pseudo-variables usage
</p>
<pre class="code c">...
<span class="me1">avp_aliases</span><span class="sy0">=</span><span class="st0">&quot;uuid=I:50&quot;</span>
...
<span class="me1">route</span> <span class="br0">&#123;</span>
...
    $avp<span class="br0">&#40;</span>uuid<span class="br0">&#41;</span><span class="sy0">=</span><span class="st0">&quot;caller_id&quot;</span><span class="sy0">;</span>
    $avp<span class="br0">&#40;</span>i<span class="sy0">:</span><span class="nu0">20</span><span class="br0">&#41;</span><span class="sy0">=</span> $avp<span class="br0">&#40;</span>uuid<span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">&quot;: &quot;</span> <span class="sy0">+</span> $fu<span class="sy0">;</span>
    xdbg<span class="br0">&#40;</span><span class="st0">&quot;$(C(bg))avp(i:20)$(C(xx)) [$avp(i:20)] $(C(br))cseq$(C(xx))=[$hdr(cseq)]<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
...
<span class="br0">&#125;</span>
...</pre>

</div>

<h3 class="sectionedit230" id="request-uri_and_destination-uri_parsing">Request-URI and Destination-URI parsing</h3>
<div class="level3">

<p>
Following are some examples how RURI and DURI are parsed, for SIP-URIs, tel-URIs and Service-URNs:
</p>
<pre class="code"> === Request URI contains SIP URI ===
$ru = &quot;sip:example.com&quot;
$rz = &quot;sip&quot;
$rU = &quot;&lt;null&gt;&quot;
$rd = &quot;example.com&quot;
$rp = &quot;5060&quot;
$rP = &quot;UDP&quot;

=== Request URI contains SIP URI ===
$ru = &quot;sips:john.q.public:hispw@example.com:6061;transport=tls;foo=bar&quot;
  $rz = &quot;sips&quot;
  $rU = &quot;john.q.public&quot;
  $rd = &quot;example.com&quot;
  $rp = &quot;6061&quot;
  $rP = &quot;tls&quot;

=== Request URI contains service URN ===
$ru = &quot;urn:service:sos.fire&quot;
  $rz = &quot;urn&quot;
  $rU = &quot;service&quot;
  $rd = &quot;sos.fire&quot;
  $rp = &quot;5060&quot;
  $rP = &quot;UDP&quot;

=== Request URI contains tel: URI ===
$ru = &quot;tel:+1-201-555-0123&quot;
  $rz = &quot;tel&quot;
  $rU = &quot;+1-201-555-0123&quot;
  $rd = &quot;&lt;null&gt;&quot;
  $rp = &quot;5060&quot;
  $rP = &quot;UDP&quot;

=== Request URI contains tel: URI with phone-context ===
$ru = &quot;tel:7042;phone-context=example.com&quot;
  $rz = &quot;tel&quot;
  $rU = &quot;7042&quot;
  $rd = &quot;&lt;null&gt;&quot;
  $rp = &quot;5060&quot;
  $rP = &quot;UDP&quot;

=== Destination URI (must be a SIP(S) URI) ===
$du = &quot;sip:example.com:6061;transport=tls;foo=bar&quot;
  $dd = &quot;example.com&quot;
  $dp = &quot;6061&quot;
  $dP = &quot;tls&quot;</pre>

</div>

                    <!-- wikipage stop -->
                                    </div>

                <div class="docInfo"><bdi>cookbooks/4.2.x/pseudovariables.txt</bdi> ¡¤ Last modified: 2015/06/03 12:07 by <bdi>mslehto</bdi></div>

                            </div></div><!-- /content -->

            <hr class="a11y" />

            <!-- PAGE ACTIONS -->
            <div id="dokuwiki__pagetools">
                <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li><a href="/wiki/cookbooks/4.2.x/pseudovariables?do=edit"  class="action source" accesskey="v" rel="nofollow" title="Show pagesource [V]"><span>Show pagesource</span></a></li><li><a href="/wiki/cookbooks/4.2.x/pseudovariables?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Old revisions [O]"><span>Old revisions</span></a></li><li><a href="/wiki/cookbooks/4.2.x/pseudovariables?do=backlink"  class="action backlink" rel="nofollow" title="Backlinks"><span>Backlinks</span></a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]"><span>Back to top</span></a></li>                    </ul>
                </div>
            </div>
        </div><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer"><div class="pad">
    
    <div class="buttons">
                <a href="http://www.dokuwiki.org/donate" title="Donate" ><img
            src="/wiki/lib/tpl/dokuwiki/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="http://www.php.net" title="Powered by PHP" ><img
            src="/wiki/lib/tpl/dokuwiki/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="http://validator.w3.org/check/referer" title="Valid HTML5" ><img
            src="/wiki/lib/tpl/dokuwiki/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" ><img
            src="/wiki/lib/tpl/dokuwiki/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="http://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="/wiki/lib/tpl/dokuwiki/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
    </div>
</div></div><!-- /footer -->

    </div></div><!-- /site -->

    <div class="no"><img src="/wiki/lib/exe/indexer.php?id=cookbooks%3A4.2.x%3Apseudovariables&amp;1437723714" width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div>    <!--[if ( lte IE 7 | IE 8 ) ]></div><![endif]-->
</body>
</html>
