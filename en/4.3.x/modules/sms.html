<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>SMS Module</title>
    <link rel="stylesheet" type="text/css" href="../../../../css/sr-doc.css" tppabs="http://kamailio.org/css/sr-doc.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.76.1" />
    <link rel="home" href="#sms" title="SMS Module" />
    <link rel="next" href="#idm4256720" title="Chapter 1. Admin Guide" />
  </head>
  <body>
    <div class="book" title="SMS Module">
      <div class="titlepage">
        <div>
          <div>
            <h1 class="title"><a id="sms"></a>SMS Module</h1>
          </div>
          <div>
            <div class="authorgroup">
              <div class="author">
                <h3 class="author"><span class="firstname">Bogdan</span> <span class="surname">Iancu</span></h3>
                <div class="affiliation">
                  <span class="orgname">FhG FOKUS<br /></span>
                </div>
              </div>
            </div>
          </div>
          <div>
            <p class="copyright">Copyright © 2003 FhG FOKUS</p>
          </div>
        </div>
        <hr />
      </div>
      <div class="toc">
        <p>
          <strong>Table of Contents</strong>
        </p>
        <dl>
          <dt>
            <span class="chapter">
              <a href="#idm4256720">1. Admin Guide</a>
            </span>
          </dt>
          <dd>
            <dl>
              <dt>
                <span class="section">
                  <a href="#sms.overview">1. Overview</a>
                </span>
              </dt>
              <dd>
                <dl>
                  <dt>
                    <span class="section">
                      <a href="#hw_requirements">1.1. Hardware Requirements</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#numbering_plan">1.2. Numbering Plan</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#address_mapping">1.3. Address Mapping</a>
                    </span>
                  </dt>
                </dl>
              </dd>
              <dt>
                <span class="section">
                  <a href="#sms.dep">2. Dependencies</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="#sms.parameters">3. Parameters</a>
                </span>
              </dt>
              <dd>
                <dl>
                  <dt>
                    <span class="section">
                      <a href="#modems">3.1. <code class="varname">modems</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#networks">3.2. <code class="varname">networks</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#links">3.3. <code class="varname">links</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#default_net">3.4. <code class="varname">default_net</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#max_sms_parts">3.5. <code class="varname">max_sms_parts</code> (integer)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#domain_str">3.6. <code class="varname">domain_str</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#sms.use_contact">3.7. <code class="varname">use_contact</code> (integer)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#sms_report_type">3.8. <code class="varname">sms_report_type</code> (integer)</a>
                    </span>
                  </dt>
                </dl>
              </dd>
              <dt>
                <span class="section">
                  <a href="#sms.functions">4. Functions</a>
                </span>
              </dt>
              <dd>
                <dl>
                  <dt>
                    <span class="section">
                      <a href="#sms_send_msg_to_net">4.1. 
	    <code class="function">sms_send_msg_to_net(network_name)</code>
	</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#sms_send_msg">4.2. 
	    <code class="function">sms_send_msg()</code>
	</a>
                    </span>
                  </dt>
                </dl>
              </dd>
            </dl>
          </dd>
        </dl>
      </div>
      <div class="list-of-examples">
        <p>
          <strong>List of Examples</strong>
        </p>
        <dl>
          <dt>1.1. <a href="#idm16768">Set <code class="varname">modems</code> parameter</a></dt>
          <dt>1.2. <a href="#idm10656">Set <code class="varname">networks</code> parameter</a></dt>
          <dt>1.3. <a href="#idm7312">Set <code class="varname">links</code> parameter</a></dt>
          <dt>1.4. <a href="#idm3656">Set <code class="varname">default_net</code> parameter</a></dt>
          <dt>1.5. <a href="#idp56024">Set <code class="varname">max_sms_parts</code> parameter</a></dt>
          <dt>1.6. <a href="#idp58656">Set <code class="varname">domain_str</code> parameter</a></dt>
          <dt>1.7. <a href="#idp60944">Set <code class="varname">use_contact</code> parameter</a></dt>
          <dt>1.8. <a href="#idp66120">Set <code class="varname">sms_report_type</code> parameter</a></dt>
          <dt>1.9. <a href="#idp203008"><code class="function">sms_send_msg_to_net</code> usage</a></dt>
          <dt>1.10. <a href="#idp1467400"><code class="function">sms_send_msg</code> usage</a></dt>
        </dl>
      </div>
      <div class="chapter" title="Chapter 1. Admin Guide">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="idm4256720"></a>Chapter 1. Admin Guide</h2>
            </div>
          </div>
        </div>
        <div class="toc">
          <p>
            <strong>Table of Contents</strong>
          </p>
          <dl>
            <dt>
              <span class="section">
                <a href="#sms.overview">1. Overview</a>
              </span>
            </dt>
            <dd>
              <dl>
                <dt>
                  <span class="section">
                    <a href="#hw_requirements">1.1. Hardware Requirements</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#numbering_plan">1.2. Numbering Plan</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#address_mapping">1.3. Address Mapping</a>
                  </span>
                </dt>
              </dl>
            </dd>
            <dt>
              <span class="section">
                <a href="#sms.dep">2. Dependencies</a>
              </span>
            </dt>
            <dt>
              <span class="section">
                <a href="#sms.parameters">3. Parameters</a>
              </span>
            </dt>
            <dd>
              <dl>
                <dt>
                  <span class="section">
                    <a href="#modems">3.1. <code class="varname">modems</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#networks">3.2. <code class="varname">networks</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#links">3.3. <code class="varname">links</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#default_net">3.4. <code class="varname">default_net</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#max_sms_parts">3.5. <code class="varname">max_sms_parts</code> (integer)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#domain_str">3.6. <code class="varname">domain_str</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#sms.use_contact">3.7. <code class="varname">use_contact</code> (integer)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#sms_report_type">3.8. <code class="varname">sms_report_type</code> (integer)</a>
                  </span>
                </dt>
              </dl>
            </dd>
            <dt>
              <span class="section">
                <a href="#sms.functions">4. Functions</a>
              </span>
            </dt>
            <dd>
              <dl>
                <dt>
                  <span class="section">
                    <a href="#sms_send_msg_to_net">4.1. 
	    <code class="function">sms_send_msg_to_net(network_name)</code>
	</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#sms_send_msg">4.2. 
	    <code class="function">sms_send_msg()</code>
	</a>
                  </span>
                </dt>
              </dl>
            </dd>
          </dl>
        </div>
        <div class="section" title="1. Overview">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title"><a id="sms.overview"></a>1. Overview</h2>
              </div>
            </div>
          </div>
          <p>
	    This module provides a way of communication between SIP network
	    (via SIP MESSAGE) and <acronym class="acronym">GSM</acronym> networks (via
	    ShortMessageService). Communication is possible from SIP to
	    <acronym class="acronym">SMS</acronym> and vice versa. The module provides
	    facilities like <acronym class="acronym">SMS</acronym> confirmation--the gateway
	    can confirm to the SIP user if his message really reached its
	    destination as a <acronym class="acronym">SMS</acronym>--or multi-part messages--if
	    a SIP messages is too long it will be split and sent as multiple
	    <acronym class="acronym">SMS</acronym>.
	</p>
          <p>
	    Errors occurred because of an invalid number or a too long message
	    or because of an internal modem malfunction are reported back to
	    the SIP user via a SIP message containing explanations
	    regarding the error.
	</p>
          <div class="section" title="1.1. Hardware Requirements">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="hw_requirements"></a>1.1. Hardware Requirements</h3>
                </div>
              </div>
            </div>
            <p>
		The <acronym class="acronym">SMS</acronym> module needs a
		<acronym class="acronym">GSM</acronym> modem to be able to send/receive the
		<acronym class="acronym">SMS</acronym> messages.  Usually, this kind of modems
		are externals, linked to the machine via serial cable. The
		modem can be a dedicated one (as the ones provided by FALCOM)
		or can be a <acronym class="acronym">GSM</acronym> telephone that has an
		internal modem (as the latest mobile phones from NOKIA and
		ERICSSON).
	    </p>
          </div>
          <div class="section" title="1.2. Numbering Plan">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="numbering_plan"></a>1.2. Numbering Plan</h3>
                </div>
              </div>
            </div>
            <p>
		The gateway accepts and advertises phone numbers in
		international format, more specific like: +(international
		code)(area code)(number). Ex: Germany, D1 = +49 170 5678181
		Romania, Connex = +40 722 123456 A number in this format is
		expected to be placed as username into <acronym class="acronym">RURI</acronym>
		or in the To header. If <acronym class="acronym">RURI</acronym> misses the
		username, the To header will be consider. Also, the gateway
		will advertise in this format the username in Contact headers
		(in SIP replies and requests) and in From headers (in SIP
		requests).
	    </p>
          </div>
          <div class="section" title="1.3. Address Mapping">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="address_mapping"></a>1.3. Address Mapping</h3>
                </div>
              </div>
            </div>
            <p>
		To identify the destination number of the
		<acronym class="acronym">SMS</acronym>, the gateway expects to have a mobile
		number in username of the SIP destination address (for example
		sip:+401704678811@iptel.org). For the reverse direction,
		because the gateway has only one <acronym class="acronym">GSM</acronym> number,
		the destination SIP address has to be encapsulated into the
		<acronym class="acronym">SMS</acronym> body. The gateway expects to find a SIP
		address at the beginning of the <acronym class="acronym">SMS</acronym> body in
		"sip:user.host" format. Everything before the SIP address will
		be discarded, the useful text begins exactly after the address
		(for example SMS="For sip:user@host hello world!!" -&gt;
		SIP="hello world"), view configuration for disable this behavior (modems parameters
		's' y 't'). In order to facilitate replying, the gateway
		sends all the <acronym class="acronym">SMS</acronym> messages with a header
		containing the source SIP address in the following format:
		"From sip:user@host (if you reply DONOT remove
		it)&lt;new_line&gt;". When an <acronym class="acronym">SMS</acronym>-reply is
		received having this header (all of it or truncated at the
		end), the header will be left out (it will not be in the SIP
		message).
	    </p>
          </div>
        </div>
        <div class="section" title="2. Dependencies">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title"><a id="sms.dep"></a>2. Dependencies</h2>
              </div>
            </div>
          </div>
          <p>
	    The following modules must be loaded before this module:
	    </p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
                <p>
			<span class="emphasis"><em>tm</em></span> - Transaction Manager.
		    </p>
              </li>
            </ul>
          </div>
          <p>
	</p>
        </div>
        <div class="section" title="3. Parameters">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title"><a id="sms.parameters"></a>3. Parameters</h2>
              </div>
            </div>
          </div>
          <div class="section" title="3.1. modems (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="modems"></a>3.1. <code class="varname">modems</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
	    Define and configure one or more <acronym class="acronym">GSM</acronym> modems.
	</p>
            <pre class="programlisting">modems_value     = modem_definition *( ";" modem_definition )
modem_definition = modem_name "[" list_of_params "]"
list_of_params   = modem_param *( ";" modem_param )
modem_param      = name "=" value</pre>
            <p>
	    The following parameters can be used:
	</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p>
		    d=device (mandatory) - Device associated with modem (/dev/ttyS0, /dev/modem,
		    etc.).
		</p>
                </li>
                <li class="listitem">
                  <p>
		    p=pin (optional) - <acronym class="acronym">SIM</acronym> <acronym class="acronym">PIN</acronym> - default
		    is NULL.
		</p>
                </li>
                <li class="listitem">
                  <p>
		    m=mode (optional) - Modem working mode
		    ("ASCII","OLD","DIGICOM","NEW"). Default value is "NEW".
		</p>
                </li>
                <li class="listitem">
                  <p>
		    c=SMS_Center (optional) - <acronym class="acronym">SMS</acronym> center
		    number for that modem. Default is the
		    <acronym class="acronym">SMS</acronym> center set on the
		    <acronym class="acronym">SIM</acronym> card.
		</p>
                </li>
                <li class="listitem">
                  <p>
		    b=baudrate (optional) - Default is 19600.
		</p>
                </li>
                <li class="listitem">
                  <p>
		    r=retry (optional) - How many times to try to re-send a
		    <acronym class="acronym">SMS</acronym> that reported error. Default is twice.
		</p>
                </li>
                <li class="listitem">
                  <p>
		    l=looping (optional) - Time for modem to wait before performing a new check
		    for incomimg/outgoing <acronym class="acronym">SMS</acronym>/SIP_MSG. Default is 20.
		</p>
                </li>
                <li class="listitem">
                  <p>
		   t=to (optional) - uri for sip header TO.  Default is NULL.
		</p>
                </li>
                <li class="listitem">
                  <p>
		    s=scan (optional) - Values: 
		        	0: NOT SCAN uri from body sms, use URI in t=to.
			1: SCAN uri from body sms (normal mode,
			default mode, clasic mode)
			2: SCAN MIX (both modes), First SCAN 
			Default is 1 (SCAN).
		</p>
                </li>
              </ul>
            </div>
            <div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
              <h3 class="title">Note</h3>
              <p>
		No default value, the parameter is mandatory.		
	    </p>
            </div>
            <div class="example">
              <a id="idm16768"></a>
              <p class="title">
                <strong>Example 1.1. Set <code class="varname">modems</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("sms", "modems", "Nokia[d=/dev/ttyS1;s=0;t=sip:p-cscf@cidra.com.ar]") 
modparam("sms", "modems", "Nokia [d=/dev/ttyS1;b=9600;m=new;l=30] ")
modparam("sms", "modems", "Nokia[d=/dev/ttyS1];Siemens[d=/dev/ttyS2]")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.2. networks (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="networks"></a>3.2. <code class="varname">networks</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
	    Define and configure used <acronym class="acronym">GSM</acronym> networks.
	</p>
            <pre class="programlisting">networks_value = net_definition *( ";" net_definition )
net_definition = net_name "[" list_of_params "]"
list_of_params = set_param *( ";" set_param )
set_param      = name "=" value</pre>
            <p>
	    The following parameters can be used:
	</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p>
		    m=msx_sms_per_call (optional) - Maximum number of
		    <acronym class="acronym">SMS</acronym> send / received from that net in one
		    modem loop. Default is 10. This parameter was introduced to
		    avoid starvation.
		</p>
                  <p>
		    Example of the starvation--a modem can send
		    <acronym class="acronym">SMS</acronym> for more than 1 networks. If you
		    have a huge number of <acronym class="acronym">SMS</acronym> for the first
		    network and the number of incoming SIP messages is equal
		    to the sent <acronym class="acronym">SMS</acronym> per same unit of time,
		    the modem will never get to send <acronym class="acronym">SMS</acronym> for
		    the next networks.
		</p>
                </li>
              </ul>
            </div>
            <div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
              <h3 class="title">Note</h3>
              <p>
		No default value, the parameter is mandatory.		
	    </p>
            </div>
            <div class="example">
              <a id="idm10656"></a>
              <p class="title">
                <strong>Example 1.2. Set <code class="varname">networks</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("sms", "networks", "D1 [m=10] ;d2[ m=20]")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.3. links (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="links"></a>3.3. <code class="varname">links</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
	    Define from which network each modem should send
	    <acronym class="acronym">SMS</acronym>.
	</p>
            <pre class="programlisting">links_value = modem_assoc *( ";" modem_assoc )
modem_assoc = modem_name "[" list_of_networks "]"
list_of_networks = network *( ";" network )</pre>
            <div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
              <h3 class="title">Note</h3>
              <p>
		No default value, the parameter is mandatory.		
	    </p>
            </div>
            <div class="example">
              <a id="idm7312"></a>
              <p class="title">
                <strong>Example 1.3. Set <code class="varname">links</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("sms", "links", "NOKIA[D1;d2]")
...</pre>
              </div>
            </div>
            <br class="example-break" />
            <p>
	    The modem NOKIA will send <acronym class="acronym">SMS</acronym> from D1 and D2 net
	    (in this order !). if in a net queue are more then max_sms_per_call
	    <acronym class="acronym">SMS</acronym> the modem will <span class="emphasis"><em>not
	    sleep</em></span> before starting the next loop ! Shortly, if
	    messages are waiting to be sent, the modem will not go in sleep.
	</p>
          </div>
          <div class="section" title="3.4. default_net (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="default_net"></a>3.4. <code class="varname">default_net</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
	    The default network to use. If no one specified, the first defined
	    network is used. This parameter is useful only if the
	    "sms_send_msg" exported function is used (see <a class="xref" href="#sms.functions" title="4. Functions">Section 4, “Functions”</a>).
	</p>
            <div class="example">
              <a id="idm3656"></a>
              <p class="title">
                <strong>Example 1.4. Set <code class="varname">default_net</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("sms", "default_net", "D1")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.5. max_sms_parts (integer)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="max_sms_parts"></a>3.5. <code class="varname">max_sms_parts</code> (integer)</h3>
                </div>
              </div>
            </div>
            <p>
	    Shows in how many parts (<acronym class="acronym">SMS</acronym> messages) a SIP message can be
	    split. If exceeded, the SIP message will be sent truncated and the SIP user will
	    get back another message containing the unsent part.
	</p>
            <p>
	    Default value is 4.
	</p>
            <div class="example">
              <a id="idp56024"></a>
              <p class="title">
                <strong>Example 1.5. Set <code class="varname">max_sms_parts</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("sms", "max_sms_parts", 10)
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.6. domain_str (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="domain_str"></a>3.6. <code class="varname">domain_str</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
	    Specify a fake domain name to be used by the gateway. The Contact
	    headers and the From header from request will be construct based on
	    this fake domain name. It's useful when the gateway is
	    transparently hidden behind a proxy/register (located on different
	    machines).
	</p>
            <p>
	    Default is the name of the machine the gateway is running on.
	</p>
            <div class="example">
              <a id="idp58656"></a>
              <p class="title">
                <strong>Example 1.6. Set <code class="varname">domain_str</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("sms", "domain_str", "foo.bar")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.7. use_contact (integer)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="sms.use_contact"></a>3.7. <code class="varname">use_contact</code> (integer)</h3>
                </div>
              </div>
            </div>
            <p>
	    If a contact header should be added to the outgoing SIP messages. Even if the
	    SIP draft forbids this, some UAS require it. 
	</p>
            <p>
	    Default is 0 (no).
	</p>
            <div class="example">
              <a id="idp60944"></a>
              <p class="title">
                <strong>Example 1.7. Set <code class="varname">use_contact</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("sms", "use_contact", 1)
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.8. sms_report_type (integer)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="sms_report_type"></a>3.8. <code class="varname">sms_report_type</code> (integer)</h3>
                </div>
              </div>
            </div>
            <p>
	    If the modem should ask for <acronym class="acronym">SMS</acronym> confirmation
	    from the <acronym class="acronym">SMS</acronym> Center. If the
	    <acronym class="acronym">SMSC</acronym> reply with an error code, the gateway will
	    send back to SIP user a SIP message containing the text (or
	    part of it) that couldn't be send. Two report mechanisms are
	    implemented:
	</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p>
		    1 - the reports are delivered by the <acronym class="acronym">GSM</acronym> device as
		    <acronym class="acronym">SMS</acronym> reports (so far supported only by Nokia modems);
		</p>
                </li>
                <li class="listitem">
                  <p>
		    2 - the reports are delivered as async. <acronym class="acronym">CDS</acronym> responses
		    (supported by almost all modems, except Ericsson).
		</p>
                </li>
              </ul>
            </div>
            <p>
	    Default is 0 (no report).
	</p>
            <div class="example">
              <a id="idp66120"></a>
              <p class="title">
                <strong>Example 1.8. Set <code class="varname">sms_report_type</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("sms", "sms_report_type", 1)
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
        </div>
        <div class="section" title="4. Functions">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title"><a id="sms.functions"></a>4. Functions</h2>
              </div>
            </div>
          </div>
          <div class="section" title="4.1.  sms_send_msg_to_net(network_name)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="sms_send_msg_to_net"></a>4.1. 
	    <code class="function">sms_send_msg_to_net(network_name)</code>
	</h3>
                </div>
              </div>
            </div>
            <p>
	    Put the SIP msg in the specified network queue. The function return
	    error if the number encapsulated into SIP message is malformed, if
	    the content_type is incorrect or because of some internal failures.
	</p>
            <p>Meaning of the parameters is as follows:</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p>
		    <span class="emphasis"><em>network_name</em></span> - Name of network.
		</p>
                </li>
              </ul>
            </div>
            <div class="example">
              <a id="idp203008"></a>
              <p class="title">
                <strong>Example 1.9. <code class="function">sms_send_msg_to_net</code> usage</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
if (sms_send_msg_to_net("D1"))
{
    if (!t_reply("202", "yes sir, SMS sent over"))
    {
        # if replying failed, retry statelessly
        sl_reply_error();
    };
} else {
    if (!t_reply("502", "Bad gateway - SMS error"))
    {
        # if replying failed, retry statelessly
        sl_reply_error();
    };
    break;
};
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="4.2.  sms_send_msg()">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="sms_send_msg"></a>4.2. 
	    <code class="function">sms_send_msg()</code>
	</h3>
                </div>
              </div>
            </div>
            <p>
	    The same as the previous one, but use the default network queue.
	</p>
            <div class="example">
              <a id="idp1467400"></a>
              <p class="title">
                <strong>Example 1.10. <code class="function">sms_send_msg</code> usage</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
if (sms_send_msg_to_net())
{
    if (!t_reply("202", "yes sir, SMS sent over"))
    {
        # if replying failed, retry statelessly
        sl_reply_error();
    };
} else {
    if (!t_reply("502", "Bad gateway - SMS error"))
    {
        # if replying failed, retry statelessly
        sl_reply_error();
    };
    break;
};
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
