<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>PUA Bridged Line Appearances</title>
    <link rel="stylesheet" type="text/css" href="../../../../css/sr-doc.css" tppabs="http://kamailio.org/css/sr-doc.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.76.1" />
    <link rel="home" href="#idp98456" title="PUA Bridged Line Appearances" />
    <link rel="next" href="#idp6822472" title="Chapter 1. Admin Guide" />
  </head>
  <body>
    <div class="book" title="PUA Bridged Line Appearances">
      <div class="titlepage">
        <div>
          <div>
            <h1 class="title"><a id="idp98456"></a>PUA Bridged Line Appearances</h1>
          </div>
          <div>
            <div class="authorgroup">
              <div class="author">
                <h3 class="author"><span class="firstname">Anca-Maria</span> <span class="surname">Vamanu</span></h3>
                <div class="affiliation">
                  <span class="orgname">Voice Sistem SRL<br /></span>
                </div>
              </div>
              <div class="editor">
                <h4 class="editedby">Edited by</h4>
                <h3 class="editor"><span class="firstname">Anca-Maria</span> <span class="surname">Vamanu</span></h3>
              </div>
            </div>
          </div>
          <div>
            <p class="copyright">Copyright © 2007 Voice Sistem SRL</p>
          </div>
        </div>
        <hr />
      </div>
      <div class="toc">
        <p>
          <strong>Table of Contents</strong>
        </p>
        <dl>
          <dt>
            <span class="chapter">
              <a href="#idp6822472">1. Admin Guide</a>
            </span>
          </dt>
          <dd>
            <dl>
              <dt>
                <span class="section">
                  <a href="#idp6707888">1. Overview</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="#idp6035904">2. Dependencies</a>
                </span>
              </dt>
              <dd>
                <dl>
                  <dt>
                    <span class="section">
                      <a href="#idp6006608">2.1. Kamailio Modules</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#idp6472800">2.2. External Libraries or Applications</a>
                    </span>
                  </dt>
                </dl>
              </dd>
              <dt>
                <span class="section">
                  <a href="#idp5563728">3. Parameters</a>
                </span>
              </dt>
              <dd>
                <dl>
                  <dt>
                    <span class="section">
                      <a href="#idp6884056">3.1. <code class="varname">default_domain</code>(str)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#idp5554656">3.2. <code class="varname">header_name</code>(str)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#idp4705112">3.3. <code class="varname">outbound_proxy</code>(str)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#idp4707792">3.4. <code class="varname">server_address</code>(str)</a>
                    </span>
                  </dt>
                </dl>
              </dd>
              <dt>
                <span class="section">
                  <a href="#idp4709792">4. Functions</a>
                </span>
              </dt>
              <dd>
                <dl>
                  <dt>
                    <span class="section">
                      <a href="#idp4710160">4.1. 
				<code class="function">bla_set_flag</code>
				</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#idp4482672">4.2. 
				<code class="function">bla_handle_notify</code>
				</a>
                    </span>
                  </dt>
                </dl>
              </dd>
            </dl>
          </dd>
        </dl>
      </div>
      <div class="list-of-examples">
        <p>
          <strong>List of Examples</strong>
        </p>
        <dl>
          <dt>1.1. <a href="#idp6946520">Set <code class="varname">default_domain</code> parameter</a></dt>
          <dt>1.2. <a href="#idp4704000">Set <code class="varname">header_name</code> parameter</a></dt>
          <dt>1.3. <a href="#idp4706600">Set <code class="varname">outbound_proxy</code> parameter</a></dt>
          <dt>1.4. <a href="#idp4708520">Set <code class="varname">server_address</code> parameter</a></dt>
          <dt>1.5. <a href="#idp4711488"><code class="function">bla_set_flag</code> usage</a></dt>
          <dt>1.6. <a href="#idp4484088"><code class="function">bla_handle_notify</code> usage</a></dt>
        </dl>
      </div>
      <div class="chapter" title="Chapter 1. Admin Guide">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="idp6822472"></a>Chapter 1. Admin Guide</h2>
            </div>
          </div>
        </div>
        <div class="toc">
          <p>
            <strong>Table of Contents</strong>
          </p>
          <dl>
            <dt>
              <span class="section">
                <a href="#idp6707888">1. Overview</a>
              </span>
            </dt>
            <dt>
              <span class="section">
                <a href="#idp6035904">2. Dependencies</a>
              </span>
            </dt>
            <dd>
              <dl>
                <dt>
                  <span class="section">
                    <a href="#idp6006608">2.1. Kamailio Modules</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#idp6472800">2.2. External Libraries or Applications</a>
                  </span>
                </dt>
              </dl>
            </dd>
            <dt>
              <span class="section">
                <a href="#idp5563728">3. Parameters</a>
              </span>
            </dt>
            <dd>
              <dl>
                <dt>
                  <span class="section">
                    <a href="#idp6884056">3.1. <code class="varname">default_domain</code>(str)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#idp5554656">3.2. <code class="varname">header_name</code>(str)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#idp4705112">3.3. <code class="varname">outbound_proxy</code>(str)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#idp4707792">3.4. <code class="varname">server_address</code>(str)</a>
                  </span>
                </dt>
              </dl>
            </dd>
            <dt>
              <span class="section">
                <a href="#idp4709792">4. Functions</a>
              </span>
            </dt>
            <dd>
              <dl>
                <dt>
                  <span class="section">
                    <a href="#idp4710160">4.1. 
				<code class="function">bla_set_flag</code>
				</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#idp4482672">4.2. 
				<code class="function">bla_handle_notify</code>
				</a>
                  </span>
                </dt>
              </dl>
            </dd>
          </dl>
        </div>
        <div class="section" title="1. Overview">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title"><a id="idp6707888"></a>1. Overview</h2>
              </div>
            </div>
          </div>
          <p>
		 The pua_bla module enables Bridged Line Appearances support according to 
		 the specifications in draft-anil-sipping-bla-03.txt.
	</p>
        </div>
        <div class="section" title="2. Dependencies">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title"><a id="idp6035904"></a>2. Dependencies</h2>
              </div>
            </div>
          </div>
          <div class="section" title="2.1. Kamailio Modules">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp6006608"></a>2.1. Kamailio Modules</h3>
                </div>
              </div>
            </div>
            <p>
		The following modules must be loaded before this module:
			</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>usrloc</em></span>.
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>pua</em></span>.
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>presence</em></span>.
			</p>
                </li>
              </ul>
            </div>
            <p>
		</p>
          </div>
          <div class="section" title="2.2. External Libraries or Applications">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp6472800"></a>2.2. External Libraries or Applications</h3>
                </div>
              </div>
            </div>
            <p>
		The following libraries or applications must be installed before running
		Kamailio with this module loaded:
			</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>libxml</em></span>.
			</p>
                </li>
              </ul>
            </div>
            <p>
		</p>
          </div>
        </div>
        <div class="section" title="3. Parameters">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title"><a id="idp5563728"></a>3. Parameters</h2>
              </div>
            </div>
          </div>
          <div class="section" title="3.1. default_domain(str)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp6884056"></a>3.1. <code class="varname">default_domain</code>(str)</h3>
                </div>
              </div>
            </div>
            <p>
		The default domain for the registered users to be used when
		constructing the uri for the registrar callback. 
		</p>
            <p>
		<span class="emphasis"><em>	Default value is <span class="quote">“<span class="quote">NULL</span>”</span>.	
		</em></span>
		</p>
            <div class="example">
              <a id="idp6946520"></a>
              <p class="title">
                <strong>Example 1.1. Set <code class="varname">default_domain</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("pua_bla", "default_domain", "kamailio.org")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.2. header_name(str)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp5554656"></a>3.2. <code class="varname">header_name</code>(str)</h3>
                </div>
              </div>
            </div>
            <p>
		The name of the header to be added to Publish requests.
		It will contain the uri of the user agent that sent the
		Notify that is transformed into Publish. It stops sending 
		a Notification with the same information to the sender.
		</p>
            <p>
		<span class="emphasis"><em>	Default value is <span class="quote">“<span class="quote">NULL</span>”</span>.	
		</em></span>
		</p>
            <div class="example">
              <a id="idp4704000"></a>
              <p class="title">
                <strong>Example 1.2. Set <code class="varname">header_name</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("pua_bla", "header_name", "Sender")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.3. outbound_proxy(str)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp4705112"></a>3.3. <code class="varname">outbound_proxy</code>(str)</h3>
                </div>
              </div>
            </div>
            <p>
		The outbound_proxy uri to be used when sending Subscribe requests.
		</p>
            <p>
		<span class="emphasis"><em>	Default value is <span class="quote">“<span class="quote">NULL</span>”</span>.	
		</em></span>
		</p>
            <div class="example">
              <a id="idp4706600"></a>
              <p class="title">
                <strong>Example 1.3. Set <code class="varname">outbound_proxy</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("pua_bla", "outbound_proxy", "sip:proxy@kamailio.org")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.4. server_address(str)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp4707792"></a>3.4. <code class="varname">server_address</code>(str)</h3>
                </div>
              </div>
            </div>
            <p>
		The IP address of the server.
		</p>
            <div class="example">
              <a id="idp4708520"></a>
              <p class="title">
                <strong>Example 1.4. Set <code class="varname">server_address</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("pua_bla", "server_address", "sip:bla@160.34.23.12")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
        </div>
        <div class="section" title="4. Functions">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title"><a id="idp4709792"></a>4. Functions</h2>
              </div>
            </div>
          </div>
          <div class="section" title="4.1.  bla_set_flag">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp4710160"></a>4.1. 
				<code class="function">bla_set_flag</code>
				</h3>
                </div>
              </div>
            </div>
            <p>
				The function is used to mark REGISTER requests made to a BLA AOR.
				The modules subscribes to the registered contacts for dialog;sla 
				event.
			</p>
            <p>
			</p>
            <div class="example">
              <a id="idp4711488"></a>
              <p class="title">
                <strong>Example 1.5. <code class="function">bla_set_flag</code> usage</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
if(is_method("REGISTER") &amp;&amp; to_uri=~"bla_aor@kamailio.org") 
	bla_set_flag();		
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="4.2.  bla_handle_notify">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp4482672"></a>4.2. 
				<code class="function">bla_handle_notify</code>
				</h3>
                </div>
              </div>
            </div>
            <p>
				The function handles Notify requests sent from phones on the
				same BLA to the server. The message is transformed in Publish 
				request and passed to presence module for further handling.
				in case of a successful processing a 2xx reply should be sent.
			</p>
            <p>
			</p>
            <div class="example">
              <a id="idp4484088"></a>
              <p class="title">
                <strong>Example 1.6. <code class="function">bla_handle_notify</code> usage</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
if(is_method("NOTIFY") &amp;&amp; to_uri=~"bla_aor@kamailio.org") 
{
		if( bla_handle_notify() ) 
			t_reply("200", "OK");
}	
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
