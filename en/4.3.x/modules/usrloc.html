<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>usrloc Module</title>
    <link rel="stylesheet" type="text/css" href="../../../../css/sr-doc.css" tppabs="http://kamailio.org/css/sr-doc.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.76.1" />
    <link rel="home" href="#idp15531496" title="usrloc Module" />
    <link rel="next" href="#idp17137136" title="Chapter 1. Admin Guide" />
  </head>
  <body>
    <div class="book" title="usrloc Module">
      <div class="titlepage">
        <div>
          <div>
            <h1 class="title"><a id="idp15531496"></a>usrloc Module</h1>
          </div>
          <div>
            <div class="authorgroup">
              <div class="author">
                <h3 class="author"><span class="firstname">Jan</span> <span class="surname">Janak</span></h3>
                <div class="affiliation">
                  <span class="orgname">FhG FOKUS<br /></span>
                </div>
              </div>
              <div class="author">
                <h3 class="author"><span class="firstname">Daniel-Constantin</span> <span class="surname">Mierla</span></h3>
                <code class="email">&lt;<a class="email" href="mailto:miconda@gmail.com">miconda@gmail.com</a>&gt;</code>
              </div>
              <div class="editor">
                <h4 class="editedby">Edited by</h4>
                <h3 class="editor"><span class="firstname">Jan</span> <span class="surname">Janak</span></h3>
              </div>
              <div class="editor">
                <h4 class="editedby">Edited by</h4>
                <h3 class="editor"><span class="firstname">Bogdan-Andrei</span> <span class="surname">Iancu</span></h3>
              </div>
            </div>
          </div>
          <div>
            <p class="copyright">Copyright © 2003 FhG FOKUS</p>
          </div>
          <div>
            <p class="copyright">Copyright © 2005 Voice Sistem SRL</p>
          </div>
        </div>
        <hr />
      </div>
      <div class="toc">
        <p>
          <strong>Table of Contents</strong>
        </p>
        <dl>
          <dt>
            <span class="chapter">
              <a href="#idp17137136">1. Admin Guide</a>
            </span>
          </dt>
          <dd>
            <dl>
              <dt>
                <span class="section">
                  <a href="#idp18720880">1. Overview</a>
                </span>
              </dt>
              <dd>
                <dl>
                  <dt>
                    <span class="section">
                      <a href="#contact-matching-algs">1.1. Contact matching</a>
                    </span>
                  </dt>
                </dl>
              </dd>
              <dt>
                <span class="section">
                  <a href="#idp15524888">2. Dependencies</a>
                </span>
              </dt>
              <dd>
                <dl>
                  <dt>
                    <span class="section">
                      <a href="#idp15525264">2.1. Kamailio Modules</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#idp15526808">2.2. External Libraries or Applications</a>
                    </span>
                  </dt>
                </dl>
              </dd>
              <dt>
                <span class="section">
                  <a href="#idp15528552">3. Parameters</a>
                </span>
              </dt>
              <dd>
                <dl>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.nat_bflag">3.1. <code class="varname">nat_bflag</code> (integer)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.user_column">3.2. <code class="varname">user_column</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.domain_column">3.3. <code class="varname">domain_column</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.contact_column">3.4. <code class="varname">contact_column</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.expires_column">3.5. <code class="varname">expires_column</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.q_column">3.6. <code class="varname">q_column</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.callid_column">3.7. <code class="varname">callid_column</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.cseq_column">3.8. <code class="varname">cseq_column</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.methods_column">3.9. <code class="varname">methods_column</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.flags_column">3.10. <code class="varname">flags_column</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.cflags_column">3.11. <code class="varname">cflags_column</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.user_agent_column">3.12. <code class="varname">user_agent_column</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.received_column">3.13. <code class="varname">received_column</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.socket_column">3.14. <code class="varname">socket_column</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.path_column">3.15. <code class="varname">path_column</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.ruid_column">3.16. <code class="varname">ruid_column</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.instance_column">3.17. <code class="varname">instance_column</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.server_id_column">3.18. <code class="varname">server_id_column</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.connection_id_column">3.19. <code class="varname">connection_id_column</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.keepalive_column">3.20. <code class="varname">keepalive_column</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.use_domain">3.21. <code class="varname">use_domain</code> (integer)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.desc_time_order">3.22. <code class="varname">desc_time_order</code> (integer)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.timer_interval">3.23. <code class="varname">timer_interval</code> (integer)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.db_url">3.24. <code class="varname">db_url</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.db_mode">3.25. <code class="varname">db_mode</code> (integer)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.matching_mode">3.26. <code class="varname">matching_mode</code> (integer)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.cseq_delay">3.27. <code class="varname">cseq_delay</code> (integer)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.fetch_rows">3.28. <code class="varname">fetch_rows</code> (integer)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.hash_size">3.29. <code class="varname">hash_size</code> (integer)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.preload">3.30. <code class="varname">preload</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.db_update_as_insert">3.31. <code class="varname">db_update_as_insert</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.db_check_update">3.32. <code class="varname">db_check_update</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.timer_procs">3.33. <code class="varname">timer_procs</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.xavp_contact">3.34. <code class="varname">xavp_contact</code> (string)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.db_ops_ruid">3.35. <code class="varname">db_ops_ruid</code> (int)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.handle_lost_tcp">3.36. <code class="varname">handle_lost_tcp</code> (int)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.close_expired_tcp">3.37. <code class="varname">close_expired_tcp</code> (int)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.expires_type">3.38. <code class="varname">expires_type</code> (int)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.db_raw_fetch_type">3.39. <code class="varname">db_raw_fetch_type</code> (int)</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.p.db_insert_null">3.40. <code class="varname">db_insert_null</code> (int)</a>
                    </span>
                  </dt>
                </dl>
              </dd>
              <dt>
                <span class="section">
                  <a href="#idp17446856">4. Functions</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="#idp17447584">5. MI Commands</a>
                </span>
              </dt>
              <dd>
                <dl>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.m.ul_rm">5.1. 
		<code class="function">ul_rm</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.m.ul_rm_contact">5.2. 
		<code class="function">ul_rm_contact</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.m.ul_dump">5.3. 
		<code class="function">ul_dump</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.m.ul_flush">5.4. 
		<code class="function">ul_flush</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.m.ul_add">5.5. 
		<code class="function">ul_add</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.m.ul_show_contact">5.6. 
		<code class="function">ul_show_contact</code>
		</a>
                    </span>
                  </dt>
                </dl>
              </dd>
              <dt>
                <span class="section">
                  <a href="#idp17467424">6. RPC Commands</a>
                </span>
              </dt>
              <dd>
                <dl>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.r.dump">6.1. 
		<code class="function">ul.dump</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.r.lookup">6.2. 
		<code class="function">ul.lookup table AOR</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.r.rm">6.3. 
		<code class="function">ul.rm table AOR</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.r.rm_contact">6.4. 
		<code class="function">ul.rm_contact table AOR contact</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.r.flush">6.5. 
		<code class="function">ul.flush</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.r.add">6.6. 
		<code class="function">ul.add</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.r.db_users">6.7. 
		<code class="function">ul.db_users</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.r.db_contacts">6.8. 
		<code class="function">ul.db_contacts</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.r.db_expired_contacts">6.9. 
		<code class="function">ul.db_expired_contacts</code>
		</a>
                    </span>
                  </dt>
                </dl>
              </dd>
              <dt>
                <span class="section">
                  <a href="#idp17493832">7. Statistics</a>
                </span>
              </dt>
              <dd>
                <dl>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.s.users">7.1. users</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.s.contacts">7.2. contacts</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.s.expires">7.3. expires</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#usrloc.s.registered_users">7.4. registered_users</a>
                    </span>
                  </dt>
                </dl>
              </dd>
            </dl>
          </dd>
          <dt>
            <span class="chapter">
              <a href="#idp17295192">2. Developer Guide</a>
            </span>
          </dt>
          <dd>
            <dl>
              <dt>
                <span class="section">
                  <a href="#idp16706160">1. Available Functions</a>
                </span>
              </dt>
              <dd>
                <dl>
                  <dt>
                    <span class="section">
                      <a href="#idp15771376">1.1. 
		<code class="function">ul_register_domain(name)</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#idp18118960">1.2. 
		<code class="function">ul_insert_urecord(domain, aor, rec)</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#idp18961080">1.3. 
		<code class="function">ul_delete_urecord(domain, aor)</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#idp18493536">1.4. 
		<code class="function">ul_delete_urecord_by_ruid(domain, ruid)</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#idp18358120">1.5. 
		<code class="function">ul_get_urecord(domain, aor)</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#idp16981864">1.6. 
		<code class="function">ul_lock_udomain(domain)</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#idp16984160">1.7. 
		<code class="function">ul_unlock_udomain(domain)</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#idp16986232">1.8. 
		<code class="function">ul_release_urecord(record)</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#idp16988336">1.9. 
		<code class="function">ul_insert_ucontact(record, contact, 
		expires, q, callid, cseq, flags, cont, ua, sock)</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#idp17937952">1.10. 
		<code class="function">ul_delete_ucontact
			(record, contact)</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#idp16305128">1.11. 
		<code class="function">ul_get_ucontact(record, contact)</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#idp16308576">1.12. 
		<code class="function">ul_get_all_ucontacts
			(buf, len, flags)</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#idp16186152">1.13. 
		<code class="function">ul_update_ucontact(contact, expires, q, 
		callid, cseq, set, res, ua, sock)</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#idp16193840">1.14. 
		<code class="function">ul_bind_ursloc( api )
			</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#idp16196136">1.15. 
		<code class="function">ul_register_ulcb(type ,callback, param)
			</code>
		</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="#idp16199776">1.16. 
		<code class="function">ul_get_num_users()
			</code>
		</a>
                    </span>
                  </dt>
                </dl>
              </dd>
            </dl>
          </dd>
        </dl>
      </div>
      <div class="list-of-examples">
        <p>
          <strong>List of Examples</strong>
        </p>
        <dl>
          <dt>1.1. <a href="#idp15530704">Set <code class="varname">nat_bflag</code> parameter</a></dt>
          <dt>1.2. <a href="#idp18017152">Set <code class="varname">user_column</code> parameter</a></dt>
          <dt>1.3. <a href="#idp17249608">Set <code class="varname">user_column</code> parameter</a></dt>
          <dt>1.4. <a href="#idp15604872">Set <code class="varname">contact_column</code> parameter</a></dt>
          <dt>1.5. <a href="#idp15607616">Set <code class="varname">expires_column</code> parameter</a></dt>
          <dt>1.6. <a href="#idp15610416">Set <code class="varname">q_column</code> parameter</a></dt>
          <dt>1.7. <a href="#idp15613120">Set <code class="varname">callid_column</code> parameter</a></dt>
          <dt>1.8. <a href="#idp15615848">Set <code class="varname">cseq_column</code> parameter</a></dt>
          <dt>1.9. <a href="#idp15618576">Set <code class="varname">methods_column</code> parameter</a></dt>
          <dt>1.10. <a href="#idp15621336">Set <code class="varname">flags_column</code> parameter</a></dt>
          <dt>1.11. <a href="#idp15624104">Set <code class="varname">cflags_column</code> parameter</a></dt>
          <dt>1.12. <a href="#idp15554112">Set <code class="varname">user_agent_column</code> parameter</a></dt>
          <dt>1.13. <a href="#idp15556912">Set <code class="varname">received_column</code> parameter</a></dt>
          <dt>1.14. <a href="#idp15559712">Set <code class="varname">socket_column</code> parameter</a></dt>
          <dt>1.15. <a href="#idp15562448">Set <code class="varname">path_column</code> parameter</a></dt>
          <dt>1.16. <a href="#idp15565184">Set <code class="varname">ruid_column</code> parameter</a></dt>
          <dt>1.17. <a href="#idp15567984">Set <code class="varname">instance_column</code> parameter</a></dt>
          <dt>1.18. <a href="#idp15570752">Set <code class="varname">server_id_column</code> parameter</a></dt>
          <dt>1.19. <a href="#idp15573536">Set <code class="varname">connection_id_column</code> parameter</a></dt>
          <dt>1.20. <a href="#idp17378408">Set <code class="varname">keepalive_column</code> parameter</a></dt>
          <dt>1.21. <a href="#idp17381344">Set <code class="varname">use_domain</code> parameter</a></dt>
          <dt>1.22. <a href="#idp17384136">Set <code class="varname">desc_time_order</code> parameter</a></dt>
          <dt>1.23. <a href="#idp17386776">Set <code class="varname">timer_interval</code> parameter</a></dt>
          <dt>1.24. <a href="#idp17389776">Set <code class="varname">db_url</code> parameter</a></dt>
          <dt>1.25. <a href="#idp17397640">Set <code class="varname">db_mode</code> parameter</a></dt>
          <dt>1.26. <a href="#idp17403360">Set <code class="varname">matching_mode</code> parameter</a></dt>
          <dt>1.27. <a href="#idp17407000">Set <code class="varname">cseq_delay</code> parameter</a></dt>
          <dt>1.28. <a href="#idp17410000">Set <code class="varname">fetch_rows</code> parameter</a></dt>
          <dt>1.29. <a href="#idp17412872">Set <code class="varname">hash_size</code> parameter</a></dt>
          <dt>1.30. <a href="#idp17415856">Set <code class="varname">preload</code> parameter</a></dt>
          <dt>1.31. <a href="#idp17418728">Set <code class="varname">db_update_as_insert</code> parameter</a></dt>
          <dt>1.32. <a href="#idp17421736">Set <code class="varname">db_check_update</code> parameter</a></dt>
          <dt>1.33. <a href="#idp17424640">Set <code class="varname">timer_procs</code> parameter</a></dt>
          <dt>1.34. <a href="#idp17428200">Set <code class="varname">xavp_contact</code> parameter</a></dt>
          <dt>1.35. <a href="#idp17431040">Set <code class="varname">db_ops_ruid</code> parameter</a></dt>
          <dt>1.36. <a href="#idp17433912">Set <code class="varname">handle_lost_tcp</code> parameter</a></dt>
          <dt>1.37. <a href="#idp17436752">Set <code class="varname">close_expired_tcp</code> parameter</a></dt>
          <dt>1.38. <a href="#idp17439784">Set <code class="varname">expires_type</code> parameter</a></dt>
          <dt>1.39. <a href="#idp17442784">Set <code class="varname">db_raw_fetch_type</code> parameter</a></dt>
          <dt>1.40. <a href="#idp17445608">Set <code class="varname">db_insert_null</code> parameter</a></dt>
        </dl>
      </div>
      <div class="chapter" title="Chapter 1. Admin Guide">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="idp17137136"></a>Chapter 1. Admin Guide</h2>
            </div>
          </div>
        </div>
        <div class="toc">
          <p>
            <strong>Table of Contents</strong>
          </p>
          <dl>
            <dt>
              <span class="section">
                <a href="#idp18720880">1. Overview</a>
              </span>
            </dt>
            <dd>
              <dl>
                <dt>
                  <span class="section">
                    <a href="#contact-matching-algs">1.1. Contact matching</a>
                  </span>
                </dt>
              </dl>
            </dd>
            <dt>
              <span class="section">
                <a href="#idp15524888">2. Dependencies</a>
              </span>
            </dt>
            <dd>
              <dl>
                <dt>
                  <span class="section">
                    <a href="#idp15525264">2.1. Kamailio Modules</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#idp15526808">2.2. External Libraries or Applications</a>
                  </span>
                </dt>
              </dl>
            </dd>
            <dt>
              <span class="section">
                <a href="#idp15528552">3. Parameters</a>
              </span>
            </dt>
            <dd>
              <dl>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.nat_bflag">3.1. <code class="varname">nat_bflag</code> (integer)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.user_column">3.2. <code class="varname">user_column</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.domain_column">3.3. <code class="varname">domain_column</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.contact_column">3.4. <code class="varname">contact_column</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.expires_column">3.5. <code class="varname">expires_column</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.q_column">3.6. <code class="varname">q_column</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.callid_column">3.7. <code class="varname">callid_column</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.cseq_column">3.8. <code class="varname">cseq_column</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.methods_column">3.9. <code class="varname">methods_column</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.flags_column">3.10. <code class="varname">flags_column</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.cflags_column">3.11. <code class="varname">cflags_column</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.user_agent_column">3.12. <code class="varname">user_agent_column</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.received_column">3.13. <code class="varname">received_column</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.socket_column">3.14. <code class="varname">socket_column</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.path_column">3.15. <code class="varname">path_column</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.ruid_column">3.16. <code class="varname">ruid_column</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.instance_column">3.17. <code class="varname">instance_column</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.server_id_column">3.18. <code class="varname">server_id_column</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.connection_id_column">3.19. <code class="varname">connection_id_column</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.keepalive_column">3.20. <code class="varname">keepalive_column</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.use_domain">3.21. <code class="varname">use_domain</code> (integer)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.desc_time_order">3.22. <code class="varname">desc_time_order</code> (integer)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.timer_interval">3.23. <code class="varname">timer_interval</code> (integer)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.db_url">3.24. <code class="varname">db_url</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.db_mode">3.25. <code class="varname">db_mode</code> (integer)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.matching_mode">3.26. <code class="varname">matching_mode</code> (integer)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.cseq_delay">3.27. <code class="varname">cseq_delay</code> (integer)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.fetch_rows">3.28. <code class="varname">fetch_rows</code> (integer)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.hash_size">3.29. <code class="varname">hash_size</code> (integer)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.preload">3.30. <code class="varname">preload</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.db_update_as_insert">3.31. <code class="varname">db_update_as_insert</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.db_check_update">3.32. <code class="varname">db_check_update</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.timer_procs">3.33. <code class="varname">timer_procs</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.xavp_contact">3.34. <code class="varname">xavp_contact</code> (string)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.db_ops_ruid">3.35. <code class="varname">db_ops_ruid</code> (int)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.handle_lost_tcp">3.36. <code class="varname">handle_lost_tcp</code> (int)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.close_expired_tcp">3.37. <code class="varname">close_expired_tcp</code> (int)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.expires_type">3.38. <code class="varname">expires_type</code> (int)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.db_raw_fetch_type">3.39. <code class="varname">db_raw_fetch_type</code> (int)</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.p.db_insert_null">3.40. <code class="varname">db_insert_null</code> (int)</a>
                  </span>
                </dt>
              </dl>
            </dd>
            <dt>
              <span class="section">
                <a href="#idp17446856">4. Functions</a>
              </span>
            </dt>
            <dt>
              <span class="section">
                <a href="#idp17447584">5. MI Commands</a>
              </span>
            </dt>
            <dd>
              <dl>
                <dt>
                  <span class="section">
                    <a href="#usrloc.m.ul_rm">5.1. 
		<code class="function">ul_rm</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.m.ul_rm_contact">5.2. 
		<code class="function">ul_rm_contact</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.m.ul_dump">5.3. 
		<code class="function">ul_dump</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.m.ul_flush">5.4. 
		<code class="function">ul_flush</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.m.ul_add">5.5. 
		<code class="function">ul_add</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.m.ul_show_contact">5.6. 
		<code class="function">ul_show_contact</code>
		</a>
                  </span>
                </dt>
              </dl>
            </dd>
            <dt>
              <span class="section">
                <a href="#idp17467424">6. RPC Commands</a>
              </span>
            </dt>
            <dd>
              <dl>
                <dt>
                  <span class="section">
                    <a href="#usrloc.r.dump">6.1. 
		<code class="function">ul.dump</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.r.lookup">6.2. 
		<code class="function">ul.lookup table AOR</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.r.rm">6.3. 
		<code class="function">ul.rm table AOR</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.r.rm_contact">6.4. 
		<code class="function">ul.rm_contact table AOR contact</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.r.flush">6.5. 
		<code class="function">ul.flush</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.r.add">6.6. 
		<code class="function">ul.add</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.r.db_users">6.7. 
		<code class="function">ul.db_users</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.r.db_contacts">6.8. 
		<code class="function">ul.db_contacts</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.r.db_expired_contacts">6.9. 
		<code class="function">ul.db_expired_contacts</code>
		</a>
                  </span>
                </dt>
              </dl>
            </dd>
            <dt>
              <span class="section">
                <a href="#idp17493832">7. Statistics</a>
              </span>
            </dt>
            <dd>
              <dl>
                <dt>
                  <span class="section">
                    <a href="#usrloc.s.users">7.1. users</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.s.contacts">7.2. contacts</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.s.expires">7.3. expires</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#usrloc.s.registered_users">7.4. registered_users</a>
                  </span>
                </dt>
              </dl>
            </dd>
          </dl>
        </div>
        <div class="section" title="1. Overview">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title"><a id="idp18720880"></a>1. Overview</h2>
              </div>
            </div>
          </div>
          <p>
		The User location module module keeps a user location table and 
		provides access to the table for  other modules. The module exports no 
		functions that can  be used directly from routing scripts.
	</p>
          <div class="section" title="1.1. Contact matching">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="contact-matching-algs"></a>1.1. Contact matching</h3>
                </div>
              </div>
            </div>
            <p>
		How the contacts are matched (for the same AOR - Address of Record) is an 
		important aspect of the usrloc module, especially in the context of NAT
		traversal - this raises more problems since contacts from different 
		phones of the same user may overlap (if both are behind NATs with the same
		configuration) or the re-register contact of the same phone may be
		seen as a new one (due different binding via NAT).
		</p>
            <p>
		The SIP RFC 3261 publishes a matching algorithm based only on the 
		contact string with Call-id and Cseq extra checking (if the Call-ID
		is the same, it must have a higher Cseq number, otherwise it is invalid).
		But as argumented above, this is not enough in NAT traversal context, 
		so the Kamailio implementation of contact matching offers more algorithms:
		</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>Contact based only</em></span> - it is strict RFC 3261
				compliancy - the Contact URI is matched as string and extra checked
				via Call-ID and cseq (if Call-ID is the same, it must have a
				higher cseq number, otherwise it is invalid).
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>Contact and Call-id based</em></span> - it is an extension
				of the first case - the contact and Call-ID must be matched as
				string; the cseq must be higher than the previous one - so be
				careful how you deal with REGISTER retransmissions in this
				case.
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>contact and path based</em></span> - it is an extension
				of the first case - the contact and path must be matched as
				string; the cseq must be higher than the previous one - so be
				careful how you deal with REGISTER retransmissions in this
				case.
			</p>
                </li>
              </ul>
            </div>
            <p>
		To find out how to control/select the contact maching algorithm, please see the
		module parameter matching_mode - <a class="xref" href="#usrloc.p.matching_mode" title="3.26. matching_mode (integer)">Section 3.26, “<code class="varname">matching_mode</code> (integer)”</a>.
		</p>
          </div>
        </div>
        <div class="section" title="2. Dependencies">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title"><a id="idp15524888"></a>2. Dependencies</h2>
              </div>
            </div>
          </div>
          <div class="section" title="2.1. Kamailio Modules">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp15525264"></a>2.1. Kamailio Modules</h3>
                </div>
              </div>
            </div>
            <p>
		The following modules must be loaded before this module:
			</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>Optionally a database module</em></span>.
			</p>
                </li>
              </ul>
            </div>
            <p>
		</p>
          </div>
          <div class="section" title="2.2. External Libraries or Applications">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp15526808"></a>2.2. External Libraries or Applications</h3>
                </div>
              </div>
            </div>
            <p>
		The following libraries or applications must be installed before 
		running Kamailio with this module loaded:
			</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>None</em></span>.
			</p>
                </li>
              </ul>
            </div>
            <p>
		</p>
          </div>
        </div>
        <div class="section" title="3. Parameters">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title"><a id="idp15528552"></a>3. Parameters</h2>
              </div>
            </div>
          </div>
          <div class="section" title="3.1. nat_bflag (integer)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.nat_bflag"></a>3.1. <code class="varname">nat_bflag</code> (integer)</h3>
                </div>
              </div>
            </div>
            <p>
		The index of the branch flag to be used as NAT marker (if the contact 
		is or not natted). This is a branch flag and it will be imported and 
		used by all other modules depending of usrloc module.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">not set</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp15530704"></a>
              <p class="title">
                <strong>Example 1.1. Set <code class="varname">nat_bflag</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "nat_bflag", 3)
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.2. user_column (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.user_column"></a>3.2. <code class="varname">user_column</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
		Name of database column containing usernames.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">username</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp18017152"></a>
              <p class="title">
                <strong>Example 1.2. Set <code class="varname">user_column</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "user_column", "username")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.3. domain_column (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.domain_column"></a>3.3. <code class="varname">domain_column</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
		Name of database column containing domains.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">domain</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp17249608"></a>
              <p class="title">
                <strong>Example 1.3. Set <code class="varname">user_column</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "domain_column", "domain")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.4. contact_column (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.contact_column"></a>3.4. <code class="varname">contact_column</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
		Name of database column containing contacts.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">contact</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp15604872"></a>
              <p class="title">
                <strong>Example 1.4. Set <code class="varname">contact_column</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "contact_column", "contact")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.5. expires_column (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.expires_column"></a>3.5. <code class="varname">expires_column</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
		Name of database column containing expires value.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">expires</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp15607616"></a>
              <p class="title">
                <strong>Example 1.5. Set <code class="varname">expires_column</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "expires_column", "expires")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.6. q_column (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.q_column"></a>3.6. <code class="varname">q_column</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
		Name of database column containing q values.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">q</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp15610416"></a>
              <p class="title">
                <strong>Example 1.6. Set <code class="varname">q_column</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "q_column", "q")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.7. callid_column (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.callid_column"></a>3.7. <code class="varname">callid_column</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
		Name of database column containing Call-ID values.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">callid</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp15613120"></a>
              <p class="title">
                <strong>Example 1.7. Set <code class="varname">callid_column</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "callid_column", "callid")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.8. cseq_column (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.cseq_column"></a>3.8. <code class="varname">cseq_column</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
		Name of database column containing Cseq.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">cseq</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp15615848"></a>
              <p class="title">
                <strong>Example 1.8. Set <code class="varname">cseq_column</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "cseq_column", "cseq")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.9. methods_column (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.methods_column"></a>3.9. <code class="varname">methods_column</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
		Name of database column containing supported methods.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">methods</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp15618576"></a>
              <p class="title">
                <strong>Example 1.9. Set <code class="varname">methods_column</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "methods_column", "methods")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.10. flags_column (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.flags_column"></a>3.10. <code class="varname">flags_column</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
		Name of database column to save the internal flags of the record.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">flags</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp15621336"></a>
              <p class="title">
                <strong>Example 1.10. Set <code class="varname">flags_column</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "flags_column", "flags")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.11. cflags_column (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.cflags_column"></a>3.11. <code class="varname">cflags_column</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
		Name of database column to save the branch/contact flags of the record.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">cflags</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp15624104"></a>
              <p class="title">
                <strong>Example 1.11. Set <code class="varname">cflags_column</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "cflags_column", "cflags")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.12. user_agent_column (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.user_agent_column"></a>3.12. <code class="varname">user_agent_column</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
		Name of database column containing user-agent values.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">user_agent</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp15554112"></a>
              <p class="title">
                <strong>Example 1.12. Set <code class="varname">user_agent_column</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "user_agent_column", "user_agent")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.13. received_column (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.received_column"></a>3.13. <code class="varname">received_column</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
		Name of database column containing the source IP, port, and protocol from the REGISTER
		message.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">received</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp15556912"></a>
              <p class="title">
                <strong>Example 1.13. Set <code class="varname">received_column</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "received_column", "received")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.14. socket_column (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.socket_column"></a>3.14. <code class="varname">socket_column</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
		Name of database column containing the received socket information (IP:port)
		for the REGISTER message.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">socket</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp15559712"></a>
              <p class="title">
                <strong>Example 1.14. Set <code class="varname">socket_column</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "socket_column", "socket")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.15. path_column (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.path_column"></a>3.15. <code class="varname">path_column</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
		Name of database column containing the Path header.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">path</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp15562448"></a>
              <p class="title">
                <strong>Example 1.15. Set <code class="varname">path_column</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "path_column", "path")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.16. ruid_column (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.ruid_column"></a>3.16. <code class="varname">ruid_column</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
		Name of database column containing the Kamailio record unique id.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">ruid</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp15565184"></a>
              <p class="title">
                <strong>Example 1.16. Set <code class="varname">ruid_column</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "ruid_column", "myruid")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.17. instance_column (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.instance_column"></a>3.17. <code class="varname">instance_column</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
		Name of database column containing the SIP instance ID (GRUU - RFC5627).
		This is a unique device identifier - UUID.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">instance</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp15567984"></a>
              <p class="title">
                <strong>Example 1.17. Set <code class="varname">instance_column</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "instance_column", "myinstance")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.18. server_id_column (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.server_id_column"></a>3.18. <code class="varname">server_id_column</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
		Name of database table column containing the value for server id.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">server_id</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp15570752"></a>
              <p class="title">
                <strong>Example 1.18. Set <code class="varname">server_id_column</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "server_id_column", "srv_id")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.19. connection_id_column (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.connection_id_column"></a>3.19. <code class="varname">connection_id_column</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
		Name of database table column containing the value for connection id.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">connection_id</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp15573536"></a>
              <p class="title">
                <strong>Example 1.19. Set <code class="varname">connection_id_column</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "connection_id_column", "con_id")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.20. keepalive_column (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.keepalive_column"></a>3.20. <code class="varname">keepalive_column</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
		Name of database table column containing the value for keepalive status.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">keepalive</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp17378408"></a>
              <p class="title">
                <strong>Example 1.20. Set <code class="varname">keepalive_column</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "keepalive_column", "kalive")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.21. use_domain (integer)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.use_domain"></a>3.21. <code class="varname">use_domain</code> (integer)</h3>
                </div>
              </div>
            </div>
            <p>
		If the domain part of the user should be also saved and used for
		identifing the user (along with the username part). Useful in 
		multi domain scenarios. Non 0 value means true.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">0 (false)</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp17381344"></a>
              <p class="title">
                <strong>Example 1.21. Set <code class="varname">use_domain</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "use_domain", 1)
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.22. desc_time_order (integer)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.desc_time_order"></a>3.22. <code class="varname">desc_time_order</code> (integer)</h3>
                </div>
              </div>
            </div>
            <p>
		If the user's contacts should be kept timestamp ordered; otherwise the
		contact will be ordered based on q value.
		Non 0 value means true.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">0 (false)</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp17384136"></a>
              <p class="title">
                <strong>Example 1.22. Set <code class="varname">desc_time_order</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "desc_time_order", 1)
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.23. timer_interval (integer)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.timer_interval"></a>3.23. <code class="varname">timer_interval</code> (integer)</h3>
                </div>
              </div>
            </div>
            <p>
		Number of seconds between two timer runs. The module uses a timer to 
		delete expired contacts, synchronize with database and other tasks, 
		that need to be run periodically.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is 60.
		</em></span>
		</p>
            <div class="example">
              <a id="idp17386776"></a>
              <p class="title">
                <strong>Example 1.23. Set <code class="varname">timer_interval</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "timer_interval", 120)
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.24. db_url (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.db_url"></a>3.24. <code class="varname">db_url</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
		<acronym class="acronym">URL</acronym> of the database that should be used.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">mysql://kamailio:kamailiorw@localhost/kamailio</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp17389776"></a>
              <p class="title">
                <strong>Example 1.24. Set <code class="varname">db_url</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "db_url", "dbdriver://username:password@dbhost/dbname")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.25. db_mode (integer)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.db_mode"></a>3.25. <code class="varname">db_mode</code> (integer)</h3>
                </div>
              </div>
            </div>
            <p>
		The usrloc module can utilize a database for persistent contact storage.
		If a database is used, the location database (contacts)  will survive 
		machine restarts or software crashes. The disadvantage is that accessing 
		a database can be very time consuming. Therefore, usrloc module implements
		four database accessing modes:
		</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p>
			0 - This disables database completely. Only memory will be used. 
			Contacts will not survive restart. Use this value if you need a 
			really fast usrloc and contact persistence is not necessary or 
			is provided by other means.
			</p>
                </li>
                <li class="listitem">
                  <p>
			1 - Write-Through scheme. All changes to usrloc are immediately 
			reflected in database too. This is very slow, but very reliable. 
			Use this scheme if speed is not your priority but need to make 
			sure that no registered contacts will be lost during crash or 
			reboot.
			</p>
                </li>
                <li class="listitem">
                  <p>
			2 - Write-Back scheme. This is a combination of previous two 
			schemes. All changes are made to memory and database 
			synchronization is done in the timer. The timer deletes all 
			expired contacts and flushes all modified or new contacts to 
			database.  Use this scheme if you encounter high-load peaks 
			and want them to process as fast as possible. The mode will 
			not help at all if the load is high all the time.  Also, latency 
			of this mode is much lower than latency of mode 1, but slightly 
			higher than latency of mode 0.
			</p>
                </li>
                <li class="listitem">
                  <p>
			3 - DB-Only scheme. No memory cache is kept, all operations being
			directly performed with the database. The timer deletes all 
			expired contacts from database - cleans after clients that didn't
			un-register or re-register. The mode is useful if you configure
			more servers sharing the same DB without any replication at SIP
			level. The mode may be slower due the high number of DB operation.
			For example NAT pinging is a killer since during each ping cycle
			all nated contact are loaded from the DB; The lack of memory 
			caching also disable the statistics exports.
			</p>
                </li>
                <li class="listitem">
                  <p>
			4 - This uses database to load records at startup but uses only
			memory during the runtime. Records are not written back at all,
			not even at shutdown. Useful for scenarios when registrations are
			replicated to a node that does the storage in database during
			runtime.
			</p>
                </li>
              </ul>
            </div>
            <div class="warning" title="Warning" style="margin-left: 0.5in; margin-right: 0.5in;">
              <h3 class="title">Warning</h3>
              <p>
			In case of crash or restart contacts that are in memory only and 
			haven't been flushed yet will get lost. If you want minimize the 
			risk, use shorter timer interval.
		</p>
            </div>
            <p>
		<span class="emphasis"><em>
			Default value is 0.
		</em></span>
		</p>
            <div class="example">
              <a id="idp17397640"></a>
              <p class="title">
                <strong>Example 1.25. Set <code class="varname">db_mode</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "db_mode", 2)
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.26. matching_mode (integer)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.matching_mode"></a>3.26. <code class="varname">matching_mode</code> (integer)</h3>
                </div>
              </div>
            </div>
            <p>
		What contact matching algorithm to be used. Refer to section 
		<a class="xref" href="#contact-matching-algs" title="1.1. Contact matching">Section 1.1, “Contact matching”</a> for the description of the 
		algorithms.
		</p>
            <p>
		The parameter may take the following values:
		</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>0</em></span> - CONTACT ONLY based matching
				algorithm.
				</p>
                </li>
                <li class="listitem">
                  <p><span class="emphasis"><em>1</em></span> - CONTACT and CALLID based 
				matching algorithm.
				</p>
                </li>
                <li class="listitem">
                  <p><span class="emphasis"><em>2</em></span> - CONTACT and PATH based
				matching algorithm.  This mode is like mode <span class="emphasis"><em>0</em></span>
				but allows for duplicate contacts from differing paths.
				If no path is available, it defaults to mode 0.
				</p>
                </li>
              </ul>
            </div>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="emphasis"><em>0 (CONTACT_ONLY)</em></span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp17403360"></a>
              <p class="title">
                <strong>Example 1.26. Set <code class="varname">matching_mode</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "matching_mode", 1)
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.27. cseq_delay (integer)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.cseq_delay"></a>3.27. <code class="varname">cseq_delay</code> (integer)</h3>
                </div>
              </div>
            </div>
            <p>
		Delay (in seconds) for accepting as retransmissions register requests
		with same Call-ID and Cseq. The delay is calculated starting from the 
		receiving time of the first register with that Call-ID and Cseq.
		</p>
            <p>
		Retransmissions within this delay interval will be accepted and replied
		as the original request, but no update will be done in location. If the
		delay is exceeded, error is reported.
		</p>
            <p>
		A value of 0 disable the retransmission detection.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">20 seconds</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp17407000"></a>
              <p class="title">
                <strong>Example 1.27. Set <code class="varname">cseq_delay</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "cseq_delay", 5)
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.28. fetch_rows (integer)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.fetch_rows"></a>3.28. <code class="varname">fetch_rows</code> (integer)</h3>
                </div>
              </div>
            </div>
            <p>
		The number of the rows to be fetched at once from database
		when loading the location records. This value can be used
		to tune the load time at startup. For 1MB of private memory (default)
		it should be below 4000. The database driver must support
		fetch_result() capability.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">2000</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp17410000"></a>
              <p class="title">
                <strong>Example 1.28. Set <code class="varname">fetch_rows</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "fetch_rows", 3000)
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.29. hash_size (integer)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.hash_size"></a>3.29. <code class="varname">hash_size</code> (integer)</h3>
                </div>
              </div>
            </div>
            <p>
		The number of entries of the hash table used by usrloc to store the
		location records is 2^hash_size. For hash_size=4, the number of slots
		of the hash table is 16.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">10</span>”</span> (1024 slots).
		</em></span>
		</p>
            <div class="example">
              <a id="idp17412872"></a>
              <p class="title">
                <strong>Example 1.29. Set <code class="varname">hash_size</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "hash_size", 12)
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.30. preload (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.preload"></a>3.30. <code class="varname">preload</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
		Preload location table given as value. A location table is loaded
		based on fixup of registrar functions, therefore you need to use this
		parameter only to load tables that are not used by registrar module
		directly in configuration file.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">NULL</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp17415856"></a>
              <p class="title">
                <strong>Example 1.30. Set <code class="varname">preload</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "preload", "location")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.31. db_update_as_insert (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.db_update_as_insert"></a>3.31. <code class="varname">db_update_as_insert</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
			Set this parameter if you want to do INSERT DB operations
			instead of UPDATE DB operations. It is recommended to set this parameter
			if you use Cassandra as a DB backend.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">0</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp17418728"></a>
              <p class="title">
                <strong>Example 1.31. Set <code class="varname">db_update_as_insert</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "db_update_as_insert", 1)
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.32. db_check_update (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.db_check_update"></a>3.32. <code class="varname">db_check_update</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
			Set this parameter to 1 if you want to do DB INSERT if the number
			of affected rows by contact DB UPDATE operation is 0. The
			database module driver has to implement affected_rows() DB API
			function, otherwise this parameter is ignored - e.g., MySQL and
			Postgres DB connectors offer affected_rows().
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">0</span>”</span> (no DB INSERT).
		</em></span>
		</p>
            <div class="example">
              <a id="idp17421736"></a>
              <p class="title">
                <strong>Example 1.32. Set <code class="varname">db_check_update</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "db_check_update", 1)
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.33. timer_procs (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.timer_procs"></a>3.33. <code class="varname">timer_procs</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
			Number of timer processes to be started by module. Timer processes
			take care of checking expired records and syncronization with
			database. If set to 0, no dedicated timer is started, the one from
			core will be used.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">0</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp17424640"></a>
              <p class="title">
                <strong>Example 1.33. Set <code class="varname">timer_procs</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "timer_procs", 4)
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.34. xavp_contact (string)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.xavp_contact"></a>3.34. <code class="varname">xavp_contact</code> (string)</h3>
                </div>
              </div>
            </div>
            <p>
		The name of XAVP storing the attributes per contact. They are saved
		in location record and restored at lookup. The tm module parameter
		<code class="varname">xavp_contact</code> must also be set to the same value to use the
		<code class="varname">t_load_contacts</code> and <code class="varname">t_next_contacts</code> functions.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">NULL</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp17428200"></a>
              <p class="title">
                <strong>Example 1.34. Set <code class="varname">xavp_contact</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "xavp_contact", "ulattrs")
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.35. db_ops_ruid (int)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.db_ops_ruid"></a>3.35. <code class="varname">db_ops_ruid</code> (int)</h3>
                </div>
              </div>
            </div>
            <p>
			If set to 1, database queries for update or delete are done using
			ruid value. If it is set to 0, the old style using aor, contact and
			call-id is done.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">1</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp17431040"></a>
              <p class="title">
                <strong>Example 1.35. Set <code class="varname">db_ops_ruid</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "db_ops_ruid", 0)
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.36. handle_lost_tcp (int)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.handle_lost_tcp"></a>3.36. <code class="varname">handle_lost_tcp</code> (int)</h3>
                </div>
              </div>
            </div>
            <p>
			If set to 1, Kamailio will remove location records made via
			TCP/TLS/WS/WSS transports when it looses corresponding tcp
            connections.  Does not currently work in DB-Only scheme.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">0</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp17433912"></a>
              <p class="title">
                <strong>Example 1.36. Set <code class="varname">handle_lost_tcp</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "handle_lost_tcp", 1)
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.37. close_expired_tcp (int)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.close_expired_tcp"></a>3.37. <code class="varname">close_expired_tcp</code> (int)</h3>
                </div>
              </div>
            </div>
            <p>
            If set to 1, Kamailio will close the TCP connection when a contact
            has expired, if the corresponding transport is TCP/TLS/WS/WSS.
        </p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">0</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp17436752"></a>
              <p class="title">
                <strong>Example 1.37. Set <code class="varname">close_expired_tcp</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "close_expired_tcp", 1)
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.38. expires_type (int)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.expires_type"></a>3.38. <code class="varname">expires_type</code> (int)</h3>
                </div>
              </div>
            </div>
            <p>
			If set to 1, Kamailio expects to deal with BIGINT type on
			database columns for expires and last modified values. It
			allows to handle better the daylight time adjustmens. If set
			to 0, those columns are expected to be on default type
			'DATETIME'. When it is 1, the database columns types have
			to be changed manually to 'BIGINT'.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">0</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp17439784"></a>
              <p class="title">
                <strong>Example 1.38. Set <code class="varname">expires_type</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "expires_type", 1)
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.39. db_raw_fetch_type (int)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.db_raw_fetch_type"></a>3.39. <code class="varname">db_raw_fetch_type</code> (int)</h3>
                </div>
              </div>
            </div>
            <p>
			This affect DB-only mode and controls what kind of
			raw query is used to fetch the contacts from database for
			specific needs (e.g., sending NAT keepalives). If it is set to 0,
			then the common SQL query is used (working for MySQL, PostgreSQL,
			...). If it is set to 1, the query required by Oracle is used.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">0</span>”</span>.
		</em></span>
		</p>
            <div class="example">
              <a id="idp17442784"></a>
              <p class="title">
                <strong>Example 1.39. Set <code class="varname">db_raw_fetch_type</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "db_raw_fetch_type", 1)
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
          <div class="section" title="3.40. db_insert_null (int)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.p.db_insert_null"></a>3.40. <code class="varname">db_insert_null</code> (int)</h3>
                </div>
              </div>
            </div>
            <p>
			If set to 1, the insert operation to database will add null values
			in the sql statement.
		</p>
            <p>
		<span class="emphasis"><em>
			Default value is <span class="quote">“<span class="quote">0</span>”</span> (don't add null fields in insert
			statement).
		</em></span>
		</p>
            <div class="example">
              <a id="idp17445608"></a>
              <p class="title">
                <strong>Example 1.40. Set <code class="varname">db_insert_null</code> parameter</strong>
              </p>
              <div class="example-contents">
                <pre class="programlisting">...
modparam("usrloc", "db_insert_null", 1)
...</pre>
              </div>
            </div>
            <br class="example-break" />
          </div>
        </div>
        <div class="section" title="4. Functions">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title"><a id="idp17446856"></a>4. Functions</h2>
              </div>
            </div>
          </div>
          <p>
		There are no exported functions that could be used in scripts.
	</p>
        </div>
        <div class="section" title="5. MI Commands">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title"><a id="idp17447584"></a>5. MI Commands</h2>
              </div>
            </div>
          </div>
          <div class="section" title="5.1.  ul_rm">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.m.ul_rm"></a>5.1. 
		<code class="function">ul_rm</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		Deletes an entire AOR record (including its contacts).
		</p>
            <p>Parameters: </p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>table name</em></span> - table where the AOR
				is removed from (Ex: location).
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>AOR</em></span> - user AOR in username[@domain]
				format (domain must be supplied only if use_domain option
				is on).
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="5.2.  ul_rm_contact">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.m.ul_rm_contact"></a>5.2. 
		<code class="function">ul_rm_contact</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		Deletes a contact from an AOR record.
		</p>
            <p>Parameters: </p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>table name</em></span> - table where the AOR
				is removed from (Ex: location).
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>AOR</em></span> - user AOR in username[@domain]
				format (domain must be supplied only if use_domain option
				is on).
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>contact</em></span> - exact contact to be removed
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="5.3.  ul_dump">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.m.ul_dump"></a>5.3. 
		<code class="function">ul_dump</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		Dumps the entire content of the USRLOC in memory cache
		</p>
            <p>Parameters: </p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>brief</em></span> - (optional, may not be present); if
				equals to string <span class="quote">“<span class="quote">brief</span>”</span>, a brief dump will be
				done (only AOR and contacts, with no other details)
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="5.4.  ul_flush">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.m.ul_flush"></a>5.4. 
		<code class="function">ul_flush</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		Triggers the flush of USRLOC memory cache into DB.
		</p>
          </div>
          <div class="section" title="5.5.  ul_add">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.m.ul_add"></a>5.5. 
		<code class="function">ul_add</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		Adds a new contact for an user AOR.
		</p>
            <p>Parameters: </p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>table name</em></span> - table where the contact
				will be added (Ex: location).
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>AOR</em></span> - user AOR in username[@domain]
				format (domain must be supplied only if use_domain option
				is on).
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>contact</em></span> - contact string to be added
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>expires</em></span> - expires value of the contact
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>Q</em></span> - Q value of the contact
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>path</em></span> value of the contact
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>flags</em></span> - internal USRLOC flags of the 
				contact
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>cflags</em></span> - per branch flags of the 
				contact
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>methods</em></span> - mask with supported requests
				of the contact
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="5.6.  ul_show_contact">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.m.ul_show_contact"></a>5.6. 
		<code class="function">ul_show_contact</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		Dumps the contacts of an user AOR.
		</p>
            <p>Parameters: </p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>table name</em></span> - table where the AOR
				resides (Ex: location).
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>AOR</em></span> - user AOR in username[@domain]
				format (domain must be supplied only if use_domain option
				is on).
			</p>
                </li>
              </ul>
            </div>
          </div>
        </div>
        <div class="section" title="6. RPC Commands">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title"><a id="idp17467424"></a>6. RPC Commands</h2>
              </div>
            </div>
          </div>
          <div class="section" title="6.1.  ul.dump">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.r.dump"></a>6.1. 
		<code class="function">ul.dump</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		Dumps the content of the location table
		</p>
            <p>Parameters: </p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p>
				None.
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="6.2.  ul.lookup table AOR">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.r.lookup"></a>6.2. 
		<code class="function">ul.lookup table AOR</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		Looks up the contents of an AOR entry in the location table
		</p>
            <p>Parameters: </p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>table name</em></span> - table where the AOR
				resides (Ex: location).
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>AOR</em></span> - user AOR in username[@domain]
				format (domain must be supplied only if use_domain option
				is on).
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="6.3.  ul.rm table AOR">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.r.rm"></a>6.3. 
		<code class="function">ul.rm table AOR</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		Deletes an entire AOR record (including its contacts).
		</p>
            <p>Parameters: </p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>table name</em></span> - table where the AOR
				resides (Ex: location).
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>AOR</em></span> - user AOR in username[@domain]
				format (domain must be supplied only if use_domain option
				is on).
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="6.4.  ul.rm_contact table AOR contact">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.r.rm_contact"></a>6.4. 
		<code class="function">ul.rm_contact table AOR contact</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		Deletes a contact from an AOR record.
		</p>
            <p>Parameters: </p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>table name</em></span> - table where the AOR
				is removed from (Ex: location).
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>AOR</em></span> - user AOR in username[@domain]
				format (domain must be supplied only if use_domain option
				is on).
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>contact</em></span> - exact contact to be removed
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="6.5.  ul.flush">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.r.flush"></a>6.5. 
		<code class="function">ul.flush</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		Triggers the flush of USRLOC memory cache into DB.
		</p>
          </div>
          <div class="section" title="6.6.  ul.add">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.r.add"></a>6.6. 
		<code class="function">ul.add</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		Adds a new contact for an user AOR.
		</p>
            <p>Parameters: </p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>table name</em></span> - table where the contact
				will be added (Ex: location).
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>AOR</em></span> - user AOR in username[@domain]
				format (domain must be supplied only if use_domain option
				is on).
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>contact</em></span> - contact string to be added
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>expires</em></span> - expires value of the contact
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>Q</em></span> - Q value of the contact
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>path</em></span> value of the contact
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>flags</em></span> - internal USRLOC flags of the
				contact
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>cflags</em></span> - per branch flags of the
				contact
			</p>
                </li>
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>methods</em></span> - mask with supported requests
				of the contact
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="6.7.  ul.db_users">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.r.db_users"></a>6.7. 
		<code class="function">ul.db_users</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		Tell number of different users (AoRs) in a location table that have unexpired contacts.
		</p>
            <p>Parameters: </p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>table name</em></span> - location table where the users are looked for, for example, location.
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="6.8.  ul.db_contacts">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.r.db_contacts"></a>6.8. 
		<code class="function">ul.db_contacts</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		Tell number of unexpired contacts in a location table.
		</p>
            <p>Parameters: </p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>table name</em></span> - location table where the contacts are looked for, for example, location.
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="6.9.  ul.db_expired_contacts">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.r.db_expired_contacts"></a>6.9. 
		<code class="function">ul.db_expired_contacts</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		Tell number of expired contacts in a location table.
		</p>
            <p>Parameters: </p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p>
				<span class="emphasis"><em>table name</em></span> - location table where the contacts are looked for, for example, location.
			</p>
                </li>
              </ul>
            </div>
          </div>
        </div>
        <div class="section" title="7. Statistics">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title"><a id="idp17493832"></a>7. Statistics</h2>
              </div>
            </div>
          </div>
          <p>
		Exported statistics are listed in the next sections.
		</p>
          <div class="section" title="7.1. users">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.s.users"></a>7.1. users</h3>
                </div>
              </div>
            </div>
            <p>
			Number of AOR existing in the USRLOC memory cache for that domain
			- can not be resetted; this statistic will be register for each 
			used domain (Ex: location).
			</p>
          </div>
          <div class="section" title="7.2. contacts">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.s.contacts"></a>7.2. contacts</h3>
                </div>
              </div>
            </div>
            <p>
			Number of contacts existing in the USRLOC memory cache for that 
			domain - can not be resetted; this statistic will be register for 
			each used domain (Ex: location).
			</p>
          </div>
          <div class="section" title="7.3. expires">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.s.expires"></a>7.3. expires</h3>
                </div>
              </div>
            </div>
            <p>
			Total number of expired contacts for that domain - can be resetted;
			 this statistic will be register for each used domain 
			(Ex: location).
			</p>
          </div>
          <div class="section" title="7.4. registered_users">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="usrloc.s.registered_users"></a>7.4. registered_users</h3>
                </div>
              </div>
            </div>
            <p>
			Total number of AOR existing in the USRLOC memory cache for all
			domains - can not be resetted.
			</p>
          </div>
        </div>
      </div>
      <div class="chapter" title="Chapter 2. Developer Guide">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="idp17295192"></a>Chapter 2. Developer Guide</h2>
            </div>
          </div>
        </div>
        <div class="toc">
          <p>
            <strong>Table of Contents</strong>
          </p>
          <dl>
            <dt>
              <span class="section">
                <a href="#idp16706160">1. Available Functions</a>
              </span>
            </dt>
            <dd>
              <dl>
                <dt>
                  <span class="section">
                    <a href="#idp15771376">1.1. 
		<code class="function">ul_register_domain(name)</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#idp18118960">1.2. 
		<code class="function">ul_insert_urecord(domain, aor, rec)</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#idp18961080">1.3. 
		<code class="function">ul_delete_urecord(domain, aor)</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#idp18493536">1.4. 
		<code class="function">ul_delete_urecord_by_ruid(domain, ruid)</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#idp18358120">1.5. 
		<code class="function">ul_get_urecord(domain, aor)</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#idp16981864">1.6. 
		<code class="function">ul_lock_udomain(domain)</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#idp16984160">1.7. 
		<code class="function">ul_unlock_udomain(domain)</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#idp16986232">1.8. 
		<code class="function">ul_release_urecord(record)</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#idp16988336">1.9. 
		<code class="function">ul_insert_ucontact(record, contact, 
		expires, q, callid, cseq, flags, cont, ua, sock)</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#idp17937952">1.10. 
		<code class="function">ul_delete_ucontact
			(record, contact)</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#idp16305128">1.11. 
		<code class="function">ul_get_ucontact(record, contact)</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#idp16308576">1.12. 
		<code class="function">ul_get_all_ucontacts
			(buf, len, flags)</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#idp16186152">1.13. 
		<code class="function">ul_update_ucontact(contact, expires, q, 
		callid, cseq, set, res, ua, sock)</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#idp16193840">1.14. 
		<code class="function">ul_bind_ursloc( api )
			</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#idp16196136">1.15. 
		<code class="function">ul_register_ulcb(type ,callback, param)
			</code>
		</a>
                  </span>
                </dt>
                <dt>
                  <span class="section">
                    <a href="#idp16199776">1.16. 
		<code class="function">ul_get_num_users()
			</code>
		</a>
                  </span>
                </dt>
              </dl>
            </dd>
          </dl>
        </div>
        <div class="section" title="1. Available Functions">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title"><a id="idp16706160"></a>1. Available Functions</h2>
              </div>
            </div>
          </div>
          <div class="section" title="1.1.  ul_register_domain(name)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp15771376"></a>1.1. 
		<code class="function">ul_register_domain(name)</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		The function registers a new domain. Domain is just another name for 
		table used in registrar. The function is called from fixups in 
		registrar. It gets name of the domain as a parameter and returns 
		pointer to a new domain structure. The fixup than 'fixes' the 
		parameter in registrar so that it will pass the pointer instead of the
		name every time save() or lookup() is called. Some usrloc functions 
		get the pointer as parameter when called. For more details see 
		implementation of save function in registrar.
		</p>
            <p>Meaning of the parameters is as follows:</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>const char* name</em></span> - Name of the domain 
				(also called table) to be registered.
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="1.2.  ul_insert_urecord(domain, aor, rec)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp18118960"></a>1.2. 
		<code class="function">ul_insert_urecord(domain, aor, rec)</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		The function creates a new record structure and inserts it in the 
		specified domain. The record is structure that contains all the 
		contacts for belonging to the specified username.
		</p>
            <p>Meaning of the parameters is as follows:</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>udomain_t* domain</em></span> - Pointer to domain 
				returned by ul_register_udomain.
			</p>
                </li>
              </ul>
            </div>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>str* aor</em></span> - Address of Record (aka 
			username) of the new record (at this time the record will 
			contain no contacts yet).
			</p>
                </li>
              </ul>
            </div>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>urecord_t** rec</em></span> - The newly created 
			record structure.
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="1.3.  ul_delete_urecord(domain, aor)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp18961080"></a>1.3. 
		<code class="function">ul_delete_urecord(domain, aor)</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		The function deletes all the contacts bound with the given Address 
		Of Record.
		</p>
            <p>Meaning of the parameters is as follows:</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>udomain_t* domain</em></span> - Pointer to domain 
			returned by ul_register_udomain.
			</p>
                </li>
              </ul>
            </div>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>str* aor</em></span> - Address of record (aka 
			username) of the record, that should be deleted.
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="1.4.  ul_delete_urecord_by_ruid(domain, ruid)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp18493536"></a>1.4. 
		<code class="function">ul_delete_urecord_by_ruid(domain, ruid)</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		The function deletes from given domain a contact with
		given ruid.
		</p>
            <p>Meaning of the parameters is as follows:</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>udomain_t* domain</em></span> - Pointer
			to domain returned by ul_register_udomain.
			</p>
                </li>
              </ul>
            </div>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>str* ruid</em></span> - ruid of contact
			that should be deleted.
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="1.5.  ul_get_urecord(domain, aor)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp18358120"></a>1.5. 
		<code class="function">ul_get_urecord(domain, aor)</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		The function returns pointer to record with given Address of Record.
		</p>
            <p>Meaning of the parameters is as follows:</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>udomain_t* domain</em></span> - Pointer to domain 
			returned by ul_register_udomain.
			</p>
                </li>
              </ul>
            </div>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>str* aor</em></span> - Address of Record of request 
			record.
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="1.6.  ul_lock_udomain(domain)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp16981864"></a>1.6. 
		<code class="function">ul_lock_udomain(domain)</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		The function lock the specified domain, it means, that no other 
		processes will be able to access during the time. This prevents race 
		conditions. Scope of the lock is the specified domain, that means, 
		that multiple domain can be accessed simultaneously, they don't block 
		each other.
		</p>
            <p>Meaning of the parameters is as follows:</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>udomain_t* domain</em></span> - Domain to be locked.
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="1.7.  ul_unlock_udomain(domain)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp16984160"></a>1.7. 
		<code class="function">ul_unlock_udomain(domain)</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		Unlock the specified domain previously locked by ul_lock_udomain.
		</p>
            <p>Meaning of the parameters is as follows:</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>udomain_t* domain</em></span> - Domain to be 
			unlocked.
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="1.8.  ul_release_urecord(record)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp16986232"></a>1.8. 
		<code class="function">ul_release_urecord(record)</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		Do some sanity checks - if all contacts have been removed, delete 
		the entire record structure.
		</p>
            <p>Meaning of the parameters is as follows:</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>urecord_t* record</em></span> - Record to be 
			released.
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="1.9.  ul_insert_ucontact(record, contact, expires, q, callid, cseq, flags, cont, ua, sock)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp16988336"></a>1.9. 
		<code class="function">ul_insert_ucontact(record, contact, 
		expires, q, callid, cseq, flags, cont, ua, sock)</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		The function inserts a new contact in the given record with 
		specified parameters.
		</p>
            <p>Meaning of the parameters is as follows:</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>urecord_t* record</em></span> - Record in which 
			the contact should be inserted.
			</p>
                </li>
                <li class="listitem">
                  <p><span class="emphasis"><em>str* contact</em></span> - Contact <acronym class="acronym">URI</acronym>.
			</p>
                </li>
                <li class="listitem">
                  <p><span class="emphasis"><em>time_t expires</em></span> - Expires of the 
			contact in absolute value.
			</p>
                </li>
                <li class="listitem">
                  <p><span class="emphasis"><em>float q</em></span> - q value of the contact.
			</p>
                </li>
                <li class="listitem">
                  <p><span class="emphasis"><em>str* callid</em></span> - Call-ID of the REGISTER 
			message that contained the contact.
			</p>
                </li>
                <li class="listitem">
                  <p><span class="emphasis"><em>int cseq</em></span> - CSeq of the REGISTER 
			message that contained the contact.
			</p>
                </li>
                <li class="listitem">
                  <p><span class="emphasis"><em>unsigned int flags</em></span> - Flags to be set.
			</p>
                </li>
                <li class="listitem">
                  <p><span class="emphasis"><em>ucontact_t* cont</em></span> - Pointer to newly 
			created structure.
			</p>
                </li>
                <li class="listitem">
                  <p><span class="emphasis"><em>str* ua</em></span> - User-Agent of the REGISTER 
			message that contained the contact.
			</p>
                </li>
                <li class="listitem">
                  <p><span class="emphasis"><em>struct socket_info *sock</em></span> - socket on
			which the REGISTER message was received on.
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="1.10.  ul_delete_ucontact (record, contact)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp17937952"></a>1.10. 
		<code class="function">ul_delete_ucontact
			(record, contact)</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		The function deletes given contact from record.
		</p>
            <p>Meaning of the parameters is as follows:</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>urecord_t* record</em></span> - Record from which 
			the contact should be removed.
			</p>
                </li>
              </ul>
            </div>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>ucontact_t* contact</em></span> - Contact to be 
			deleted.
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="1.11.  ul_get_ucontact(record, contact)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp16305128"></a>1.11. 
		<code class="function">ul_get_ucontact(record, contact)</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		The function tries to find contact with given Contact <acronym class="acronym">URI</acronym> and 
		returns pointer to structure representing the contact.
		</p>
            <p>Meaning of the parameters is as follows:</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>urecord_t* record</em></span> - Record to be 
			searched for the contact.
			</p>
                </li>
              </ul>
            </div>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>str_t* contact</em></span> - <acronym class="acronym">URI</acronym> of the request
			contact.
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="1.12.  ul_get_all_ucontacts (buf, len, flags)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp16308576"></a>1.12. 
		<code class="function">ul_get_all_ucontacts
			(buf, len, flags)</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		The function retrieves all contacts of all registered users and 
		returns them in the caller-supplied buffer. If the buffer is too small,
		the function returns positive value indicating how much additional 
		space would be necessary to accommodate all of them. Please note 
		that the positive return value should be used only as a 
		<span class="quote">“<span class="quote">hint</span>”</span>, as there is no guarantee that during the time 
		between two subsequent calls number of registered contacts will 
		remain the same.
		</p>
            <p>
		If flag parameter is set to non-zero value then only contacts that 
		have the specified flags set will be returned. It is, for example, 
		possible to list only contacts that are behind NAT.
		</p>
            <p>Meaning of the parameters is as follows:</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>void* buf</em></span> - Buffer for returning 
			contacts.
			</p>
                </li>
              </ul>
            </div>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>int len</em></span> - Length of the buffer.
			</p>
                </li>
              </ul>
            </div>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>unsigned int flags</em></span> - Flags that must
			be set.
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="1.13.  ul_update_ucontact(contact, expires, q, callid, cseq, set, res, ua, sock)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp16186152"></a>1.13. 
		<code class="function">ul_update_ucontact(contact, expires, q, 
		callid, cseq, set, res, ua, sock)</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		The function updates contact with new values.
		</p>
            <p>Meaning of the parameters is as follows:</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>ucontact_t* contact</em></span> - Contact <acronym class="acronym">URI</acronym>.
			</p>
                </li>
                <li class="listitem">
                  <p><span class="emphasis"><em>time_t expires</em></span> - Expires of the 
			contact in absolute value.
			</p>
                </li>
                <li class="listitem">
                  <p><span class="emphasis"><em>float q</em></span> - q value of the contact.
			</p>
                </li>
                <li class="listitem">
                  <p><span class="emphasis"><em>str* callid</em></span> - Call-ID of the REGISTER 
			message that contained the contact.
			</p>
                </li>
                <li class="listitem">
                  <p><span class="emphasis"><em>int cseq</em></span> - CSeq of the REGISTER message 
			that contained the contact.
			</p>
                </li>
                <li class="listitem">
                  <p>
			<span class="emphasis"><em>unsigned int set</em></span> - OR value of flags to 
			be set.
			</p>
                </li>
                <li class="listitem">
                  <p>
			<span class="emphasis"><em>unsigned int res</em></span> - OR value of flags to be 
			reset.
			</p>
                </li>
                <li class="listitem">
                  <p><span class="emphasis"><em>str* ua</em></span> - User-Agent of the REGISTER 
			message that contained the contact.
			</p>
                </li>
                <li class="listitem">
                  <p><span class="emphasis"><em>struct socket_info *sock</em></span> - socket on
			which the REGISTER message was received on.
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="1.14.  ul_bind_ursloc( api )">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp16193840"></a>1.14. 
		<code class="function">ul_bind_ursloc( api )
			</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		The function imports all functions that are exported by the 
		USRLOC module. Overs for other modules which want to user the
		internal USRLOC API an easy way to load and access the functions.
		</p>
            <p>Meaning of the parameters is as follows:</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>usrloc_api_t* api</em></span> - USRLOC API
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="1.15.  ul_register_ulcb(type ,callback, param)">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp16196136"></a>1.15. 
		<code class="function">ul_register_ulcb(type ,callback, param)
			</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		The function register with USRLOC a callback function to be called
		when some event occures inside USRLOC.
		</p>
            <p>Meaning of the parameters is as follows:</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p><span class="emphasis"><em>int types</em></span> - type of event for which
			the callback should be called (see usrloc/ul_callback.h).
			</p>
                </li>
                <li class="listitem">
                  <p><span class="emphasis"><em>ul_cb f</em></span> - callback function; see
			usrloc/ul_callback.h for prototype.
			</p>
                </li>
                <li class="listitem">
                  <p><span class="emphasis"><em>void *param</em></span> - some parameter to be
			passed to the callback each time when it is called.
			</p>
                </li>
              </ul>
            </div>
          </div>
          <div class="section" title="1.16.  ul_get_num_users()">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a id="idp16199776"></a>1.16. 
		<code class="function">ul_get_num_users()
			</code>
		</h3>
                </div>
              </div>
            </div>
            <p>
		The function loops through all domains summing up the number of users.
		</p>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
