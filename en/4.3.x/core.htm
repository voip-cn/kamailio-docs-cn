
<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>cookbooks:4.2.x:core [Kamailio SIP Server Wiki]</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="cookbooks,4.2.x,core"/>
<link rel="search" type="application/opensearchdescription+xml" href="/wiki/lib/exe/opensearch.php" title="Kamailio SIP Server Wiki"/>
<link rel="start" href="/wiki/"/>
<link rel="contents" href="/wiki/cookbooks/4.2.x/core?do=index" title="Sitemap"/>
<link rel="alternate" type="application/rss+xml" title="Recent changes" href="/wiki/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current namespace" href="/wiki/feed.php?mode=list&amp;ns=cookbooks:4.2.x"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="/wiki/_export/xhtml/cookbooks/4.2.x/core"/>
<link rel="alternate" type="text/plain" title="Wiki Markup" href="/wiki/_export/raw/cookbooks/4.2.x/core"/>
<link rel="canonical" href="http://www.kamailio.org/wiki/cookbooks/4.2.x/core"/>
<link rel="stylesheet" type="text/css" href="/wiki/lib/exe/css.php?t=dokuwiki&amp;tseed=31a24d7ffe415049536e293898fc9d2f"/>
<script type="text/javascript">/*<![CDATA[*/var NS='cookbooks:4.2.x';var JSINFO = {"id":"cookbooks:4.2.x:core","namespace":"cookbooks:4.2.x"};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="/wiki/lib/exe/js.php?tseed=31a24d7ffe415049536e293898fc9d2f"></script>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="shortcut icon" href="/wiki/lib/tpl/dokuwiki/images/favicon.ico" />
<link rel="apple-touch-icon" href="/wiki/lib/tpl/dokuwiki/images/apple-touch-icon.png" />
    </head>

<body>
    <!--[if lte IE 7 ]><div id="IE7"><![endif]--><!--[if IE 8 ]><div id="IE8"><![endif]-->
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_dokuwiki    showSidebar hasSidebar">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header"><div class="pad group">

    
    <div class="headings group">
        <ul class="a11y skip">
            <li><a href="#dokuwiki__content">skip to content</a></li>
        </ul>

        <h1><a href="/wiki/start"  accesskey="h" title="[H]"><img src="/wiki/lib/tpl/dokuwiki/images/logo.png" width="64" height="64" alt="" /> <span>Kamailio SIP Server Wiki</span></a></h1>
            </div>

    <div class="tools group">
        <!-- USER TOOLS -->
                    <div id="dokuwiki__usertools">
                <h3 class="a11y">User Tools</h3>
                <ul>
                    <li><a href="/wiki/cookbooks/4.2.x/core?do=register"  class="action register" rel="nofollow" title="Register">Register</a></li><li><a href="/wiki/cookbooks/4.2.x/core?do=login&amp;sectok=558c40251c68d531f923d969af598d3a"  class="action login" rel="nofollow" title="Login">Login</a></li>                </ul>
            </div>
        
        <!-- SITE TOOLS -->
        <div id="dokuwiki__sitetools">
            <h3 class="a11y">Site Tools</h3>
            <form action="/wiki/start" accept-charset="utf-8" class="search" id="dw__search" method="get" role="search"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><input type="submit" value="Search" class="button" title="Search" /><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>            <div class="mobileTools">
                <form action="/wiki/doku.php" method="get" accept-charset="utf-8"><div class="no"><input type="hidden" name="id" value="cookbooks:4.2.x:core" /><select name="do" class="edit quickselect" title="Tools"><option value="">Tools</option><optgroup label="Page Tools"><option value="edit">Show pagesource</option><option value="revisions">Old revisions</option><option value="backlink">Backlinks</option></optgroup><optgroup label="Site Tools"><option value="recent">Recent changes</option><option value="media">Media Manager</option><option value="index">Sitemap</option></optgroup><optgroup label="User Tools"><option value="login">Login</option><option value="register">Register</option></optgroup></select><input type="submit" value="&gt;" /></div></form>            </div>
            <ul>
                <li><a href="/wiki/cookbooks/4.2.x/core?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Recent changes [R]">Recent changes</a></li><li><a href="/wiki/cookbooks/4.2.x/core?do=media&amp;ns=cookbooks%3A4.2.x"  class="action media" rel="nofollow" title="Media Manager">Media Manager</a></li><li><a href="/wiki/cookbooks/4.2.x/core?do=index"  class="action index" accesskey="x" rel="nofollow" title="Sitemap [X]">Sitemap</a></li>            </ul>
        </div>

    </div>

    <!-- BREADCRUMBS -->
            <div class="breadcrumbs">
                                        <div class="trace"><span class="bchead">Trace:</span> <span class="bcsep">?</span> <span class="curid"><bdi><a href="/wiki/cookbooks/4.2.x/core"  class="breadcrumbs" title="cookbooks:4.2.x:core">core</a></bdi></span></div>
                    </div>
    
    
    <hr class="a11y" />
</div></div><!-- /header -->

        <div class="wrapper group">

                            <!-- ********** ASIDE ********** -->
                <div id="dokuwiki__aside"><div class="pad aside include group">
                    <h3 class="toggle">Sidebar</h3>
                    <div class="content">
                                                                        <ul>
<li class="level1"><div class="li"> <a href="/wiki/start" class="wikilink1" title="start">Wiki Home</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://www.kamailio.org" class="urlextern" title="http://www.kamailio.org"  rel="nofollow">Kamailio Site</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://www.kamailio.org/docs/" class="urlextern" title="http://www.kamailio.org/docs/"  rel="nofollow">Docs Index</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://www.kamailio.org/docs/modules/" class="urlextern" title="http://www.kamailio.org/docs/modules/"  rel="nofollow">Modules Docs</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://www.kamailio.org/dokuwiki/" class="urlextern" title="http://www.kamailio.org/dokuwiki/"  rel="nofollow">Old Wiki</a></div>
</li>
<li class="level1"><div class="li"> <a href="/wiki/wiki/dokuwiki" class="wikilink1" title="wiki:dokuwiki">Wiki Help</a></div>
</li>
<li class="level1"><div class="li"> <a href="/wiki/wiki/syntax" class="wikilink1" title="wiki:syntax">Wiki Syntax</a></div>
</li>
</ul>
                                            </div>
                </div></div><!-- /aside -->
            
            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">

                <div class="pageId"><span>cookbooks:4.2.x:core</span></div>

                <div class="page group">
                                                            <!-- wikipage start -->
                    <!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="#kamailio_sip_server_v42x_stablecore_cookbook">Kamailio SIP Server v4.2.x (stable): Core Cookbook</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="#config_pre-processor_directives">Config Pre-Processor Directives</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#include_file">include_file</a></div></li>
<li class="level3"><div class="li"><a href="#import_file">import_file</a></div></li>
<li class="level3"><div class="li"><a href="#define">define</a></div></li>
<li class="level3"><div class="li"><a href="#subst">subst</a></div></li>
<li class="level3"><div class="li"><a href="#substdef">substdef</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#core_keywords">Core Keywords</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#af">af</a></div></li>
<li class="level3"><div class="li"><a href="#dst_ip">dst_ip</a></div></li>
<li class="level3"><div class="li"><a href="#dst_port">dst_port</a></div></li>
<li class="level3"><div class="li"><a href="#from_uri">from_uri</a></div></li>
<li class="level3"><div class="li"><a href="#method">method</a></div></li>
<li class="level3"><div class="li"><a href="#msglen">msg:len</a></div></li>
<li class="level3"><div class="li"><a href="#proto">proto</a></div></li>
<li class="level3"><div class="li"><a href="#status">status</a></div></li>
<li class="level3"><div class="li"><a href="#snd_af">snd_af</a></div></li>
<li class="level3"><div class="li"><a href="#snd_ip">snd_ip</a></div></li>
<li class="level3"><div class="li"><a href="#snd_port">snd_port</a></div></li>
<li class="level3"><div class="li"><a href="#snd_proto">snd_proto</a></div></li>
<li class="level3"><div class="li"><a href="#src_ip">src_ip</a></div></li>
<li class="level3"><div class="li"><a href="#src_port">src_port</a></div></li>
<li class="level3"><div class="li"><a href="#to_ip">to_ip</a></div></li>
<li class="level3"><div class="li"><a href="#to_port">to_port</a></div></li>
<li class="level3"><div class="li"><a href="#to_uri">to_uri</a></div></li>
<li class="level3"><div class="li"><a href="#uri">uri</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#core_values">Core Values</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#inet">INET</a></div></li>
<li class="level3"><div class="li"><a href="#inet6">INET6</a></div></li>
<li class="level3"><div class="li"><a href="#sctp">SCTP</a></div></li>
<li class="level3"><div class="li"><a href="#tcp">TCP</a></div></li>
<li class="level3"><div class="li"><a href="#tls">TLS</a></div></li>
<li class="level3"><div class="li"><a href="#udp">UDP</a></div></li>
<li class="level3"><div class="li"><a href="#ws">WS</a></div></li>
<li class="level3"><div class="li"><a href="#wss">WSS</a></div></li>
<li class="level3"><div class="li"><a href="#max_len">max_len</a></div></li>
<li class="level3"><div class="li"><a href="#myself">myself</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#core_parameters">Core parameters</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#advertised_address">advertised_address</a></div></li>
<li class="level3"><div class="li"><a href="#advertised_port">advertised_port</a></div></li>
<li class="level3"><div class="li"><a href="#alias">alias</a></div></li>
<li class="level3"><div class="li"><a href="#async_workers">async_workers</a></div></li>
<li class="level3"><div class="li"><a href="#auto_aliases">auto_aliases</a></div></li>
<li class="level3"><div class="li"><a href="#auto_bind_ipv6">auto_bind_ipv6</a></div></li>
<li class="level3"><div class="li"><a href="#check_via">check_via</a></div></li>
<li class="level3"><div class="li"><a href="#children">children</a></div></li>
<li class="level3"><div class="li"><a href="#chroot">chroot</a></div></li>
<li class="level3"><div class="li"><a href="#corelog">corelog</a></div></li>
<li class="level3"><div class="li"><a href="#debug">debug</a></div></li>
<li class="level3"><div class="li"><a href="#description">description</a></div></li>
<li class="level3"><div class="li"><a href="#disable_core_dump">disable_core_dump</a></div></li>
<li class="level3"><div class="li"><a href="#disable_tls">disable_tls</a></div></li>
<li class="level3"><div class="li"><a href="#enable_tls">enable_tls</a></div></li>
<li class="level3"><div class="li"><a href="#exit_timeout">exit_timeout</a></div></li>
<li class="level3"><div class="li"><a href="#flags">flags</a></div></li>
<li class="level3"><div class="li"><a href="#force_rport">force_rport</a></div></li>
<li class="level3"><div class="li"><a href="#fork">fork</a></div></li>
<li class="level3"><div class="li"><a href="#fork_delay">fork_delay</a></div></li>
<li class="level3"><div class="li"><a href="#group">group</a></div></li>
<li class="level3"><div class="li"><a href="#http_reply_parse">http_reply_parse</a></div></li>
<li class="level3"><div class="li"><a href="#latency_limit_action">latency_limit_action</a></div></li>
<li class="level3"><div class="li"><a href="#latency_limit_db">latency_limit_db</a></div></li>
<li class="level3"><div class="li"><a href="#latency_log">latency_log</a></div></li>
<li class="level3"><div class="li"><a href="#listen">listen</a></div></li>
<li class="level3"><div class="li"><a href="#loadmodule">loadmodule</a></div></li>
<li class="level3"><div class="li"><a href="#loadpath">loadpath</a></div></li>
<li class="level3"><div class="li"><a href="#log_facility">log_facility</a></div></li>
<li class="level3"><div class="li"><a href="#log_name">log_name</a></div></li>
<li class="level3"><div class="li"><a href="#log_prefix">log_prefix</a></div></li>
<li class="level3"><div class="li"><a href="#log_stderror">log_stderror</a></div></li>
<li class="level3"><div class="li"><a href="#maxbuffer">maxbuffer</a></div></li>
<li class="level3"><div class="li"><a href="#sql_buffer_size">sql_buffer_size</a></div></li>
<li class="level3"><div class="li"><a href="#max_recursive_level">max_recursive_level</a></div></li>
<li class="level3"><div class="li"><a href="#max_while_loops">max_while_loops</a></div></li>
<li class="level3"><div class="li"><a href="#mcast_loopback">mcast_loopback</a></div></li>
<li class="level3"><div class="li"><a href="#mcast_ttl">mcast_ttl</a></div></li>
<li class="level3"><div class="li"><a href="#memdbg">memdbg</a></div></li>
<li class="level3"><div class="li"><a href="#memlog">memlog</a></div></li>
<li class="level3"><div class="li"><a href="#mem_join">mem_join</a></div></li>
<li class="level3"><div class="li"><a href="#mem_safety">mem_safety</a></div></li>
<li class="level3"><div class="li"><a href="#mem_summary">mem_summary</a></div></li>
<li class="level3"><div class="li"><a href="#mhomed">mhomed</a></div></li>
<li class="level3"><div class="li"><a href="#mlock_pages">mlock_pages</a></div></li>
<li class="level3"><div class="li"><a href="#modinit_delay">modinit_delay</a></div></li>
<li class="level3"><div class="li"><a href="#modparam">modparam</a></div></li>
<li class="level3"><div class="li"><a href="#onsend_route_reply">onsend_route_reply</a></div></li>
<li class="level3"><div class="li"><a href="#open_files_limit">open_files_limit</a></div></li>
<li class="level3"><div class="li"><a href="#phone2tel">phone2tel</a></div></li>
<li class="level3"><div class="li"><a href="#pmtu_discovery">pmtu_discovery</a></div></li>
<li class="level3"><div class="li"><a href="#port">port</a></div></li>
<li class="level3"><div class="li"><a href="#pv_buffer_size">pv_buffer_size</a></div></li>
<li class="level3"><div class="li"><a href="#pv_buffer_slots">pv_buffer_slots</a></div></li>
<li class="level3"><div class="li"><a href="#reply_to_via">reply_to_via</a></div></li>
<li class="level3"><div class="li"><a href="#server_id">server_id</a></div></li>
<li class="level3"><div class="li"><a href="#server_header">server_header</a></div></li>
<li class="level3"><div class="li"><a href="#server_signature">server_signature</a></div></li>
<li class="level3"><div class="li"><a href="#shm_force_alloc">shm_force_alloc</a></div></li>
<li class="level3"><div class="li"><a href="#sip_warning_noisy_feedback">sip_warning (noisy feedback)</a></div></li>
<li class="level3"><div class="li"><a href="#socket_workers">socket_workers</a></div></li>
<li class="level3"><div class="li"><a href="#statistics">statistics</a></div></li>
<li class="level3"><div class="li"><a href="#tos">tos</a></div></li>
<li class="level3"><div class="li"><a href="#udp_mtu">udp_mtu</a></div></li>
<li class="level3"><div class="li"><a href="#udp_mtu_try_proto">udp_mtu_try_proto</a></div></li>
<li class="level3"><div class="li"><a href="#user">user</a></div></li>
<li class="level3"><div class="li"><a href="#user_agent_header">user_agent_header</a></div></li>
<li class="level3"><div class="li"><a href="#workdir">workdir</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#dns_parameters">DNS Parameters</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#dns">dns</a></div></li>
<li class="level3"><div class="li"><a href="#rev_dns">rev_dns</a></div></li>
<li class="level3"><div class="li"><a href="#dns_cache_del_nonexp">dns_cache_del_nonexp</a></div></li>
<li class="level3"><div class="li"><a href="#dns_cache_flags">dns_cache_flags</a></div></li>
<li class="level3"><div class="li"><a href="#dns_cache_gc_interval">dns_cache_gc_interval</a></div></li>
<li class="level3"><div class="li"><a href="#dns_cache_init">dns_cache_init</a></div></li>
<li class="level3"><div class="li"><a href="#dns_cache_max_ttl">dns_cache_max_ttl</a></div></li>
<li class="level3"><div class="li"><a href="#dns_cache_mem">dns_cache_mem</a></div></li>
<li class="level3"><div class="li"><a href="#dns_cache_min_ttl">dns_cache_min_ttl</a></div></li>
<li class="level3"><div class="li"><a href="#dns_cache_negative_ttl">dns_cache_negative_ttl</a></div></li>
<li class="level3"><div class="li"><a href="#dns_naptr_ignore_rfc">dns_naptr_ignore_rfc</a></div></li>
<li class="level3"><div class="li"><a href="#dns_retr_no">dns_retr_no</a></div></li>
<li class="level3"><div class="li"><a href="#dns_retr_time">dns_retr_time</a></div></li>
<li class="level3"><div class="li"><a href="#dns_search_full_match">dns_search_full_match</a></div></li>
<li class="level3"><div class="li"><a href="#dns_servers_no">dns_servers_no</a></div></li>
<li class="level3"><div class="li"><a href="#dns_srv_lb">dns_srv_lb</a></div></li>
<li class="level3"><div class="li"><a href="#dns_try_ipv6">dns_try_ipv6</a></div></li>
<li class="level3"><div class="li"><a href="#dns_try_naptr">dns_try_naptr</a></div></li>
<li class="level3"><div class="li"><a href="#dns_sctp_pref_dns_tcp_pref_dns_tls_pref_dns_udp_pref">dns_sctp_pref, dns_tcp_pref, dns_tls_pref, dns_udp_pref</a></div></li>
<li class="level3"><div class="li"><a href="#dns_use_search_list">dns_use_search_list</a></div></li>
<li class="level3"><div class="li"><a href="#use_dns_cache">use_dns_cache</a></div></li>
<li class="level3"><div class="li"><a href="#use_dns_failover">use_dns_failover</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#tcp_parameters">TCP Parameters</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#disable_tcp">disable_tcp</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_accept_aliases">tcp_accept_aliases</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_accept_no_cl">tcp_accept_no_cl</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_async">tcp_async</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_children">tcp_children</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_clone_rcvbuf">tcp_clone_rcvbuf</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_connection_lifetime">tcp_connection_lifetime</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_connect_timeout">tcp_connect_timeout</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_conn_wq_max">tcp_conn_wq_max</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_crlf_ping">tcp_crlf_ping</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_defer_accept">tcp_defer_accept</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_delayed_ack">tcp_delayed_ack</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_fd_cache">tcp_fd_cache</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_keepalive">tcp_keepalive</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_keepcnt">tcp_keepcnt</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_keepidle">tcp_keepidle</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_keepintvl">tcp_keepintvl</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_linger2">tcp_linger2</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_max_connections">tcp_max_connections</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_no_connect">tcp_no_connect</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_poll_method">tcp_poll_method</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_rd_buf_size">tcp_rd_buf_size</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_send_timeout">tcp_send_timeout</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_source_ipv4_tcp_source_ipv6">tcp_source_ipv4, tcp_source_ipv6</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_syncnt">tcp_syncnt</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_wq_blk_size">tcp_wq_blk_size</a></div></li>
<li class="level3"><div class="li"><a href="#tcp_wq_max">tcp_wq_max</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#tls_parameters">TLS Parameters</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#tls_port_no">tls_port_no</a></div></li>
<li class="level3"><div class="li"><a href="#tls_max_connections">tls_max_connections</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#sctp_parameters">SCTP Parameters</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#disable_sctp">disable_sctp</a></div></li>
<li class="level3"><div class="li"><a href="#enable_sctp">enable_sctp</a></div></li>
<li class="level3"><div class="li"><a href="#sctp_children">sctp_children</a></div></li>
<li class="level3"><div class="li"><a href="#sctp_socket_rcvbuf">sctp_socket_rcvbuf</a></div></li>
<li class="level3"><div class="li"><a href="#sctp_socket_sndbuf">sctp_socket_sndbuf</a></div></li>
<li class="level3"><div class="li"><a href="#sctp_autoclose">sctp_autoclose</a></div></li>
<li class="level3"><div class="li"><a href="#sctp_send_ttl">sctp_send_ttl</a></div></li>
<li class="level3"><div class="li"><a href="#sctp_send_retries">sctp_send_retries</a></div></li>
<li class="level3"><div class="li"><a href="#sctp_assoc_tracking">sctp_assoc_tracking</a></div></li>
<li class="level3"><div class="li"><a href="#sctp_assoc_reuse">sctp_assoc_reuse</a></div></li>
<li class="level3"><div class="li"><a href="#sctp_max_assocs">sctp_max_assocs</a></div></li>
<li class="level3"><div class="li"><a href="#sctp_srto_initial">sctp_srto_initial</a></div></li>
<li class="level3"><div class="li"><a href="#sctp_srto_max">sctp_srto_max</a></div></li>
<li class="level3"><div class="li"><a href="#sctp_srto_min">sctp_srto_min</a></div></li>
<li class="level3"><div class="li"><a href="#sctp_asocmaxrxt">sctp_asocmaxrxt</a></div></li>
<li class="level3"><div class="li"><a href="#sctp_init_max_attempts">sctp_init_max_attempts</a></div></li>
<li class="level3"><div class="li"><a href="#sctp_init_max_timeo">sctp_init_max_timeo</a></div></li>
<li class="level3"><div class="li"><a href="#sctp_hbinterval">sctp_hbinterval</a></div></li>
<li class="level3"><div class="li"><a href="#sctp_pathmaxrxt">sctp_pathmaxrxt</a></div></li>
<li class="level3"><div class="li"><a href="#sctp_sack_delay">sctp_sack_delay</a></div></li>
<li class="level3"><div class="li"><a href="#sctp_sack_freq">sctp_sack_freq</a></div></li>
<li class="level3"><div class="li"><a href="#sctp_max_burst">sctp_max_burst</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#udp_parameters">UDP Parameters</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#udp4_raw">udp4_raw</a></div></li>
<li class="level3"><div class="li"><a href="#udp4_raw_mtu">udp4_raw_mtu</a></div></li>
<li class="level3"><div class="li"><a href="#udp4_raw_ttl">udp4_raw_ttl</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#blacklist_parameters">Blacklist Parameters</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#dst_blacklist_expire">dst_blacklist_expire</a></div></li>
<li class="level3"><div class="li"><a href="#dst_blacklist_gc_interval">dst_blacklist_gc_interval</a></div></li>
<li class="level3"><div class="li"><a href="#dst_blacklist_init">dst_blacklist_init</a></div></li>
<li class="level3"><div class="li"><a href="#dst_blacklist_mem">dst_blacklist_mem</a></div></li>
<li class="level3"><div class="li"><a href="#use_dst_blacklist">use_dst_blacklist</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#real-time_parameters">Real-Time Parameters</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#real_time">real_time</a></div></li>
<li class="level3"><div class="li"><a href="#rt_policy">rt_policy</a></div></li>
<li class="level3"><div class="li"><a href="#rt_prio">rt_prio</a></div></li>
<li class="level3"><div class="li"><a href="#rt_timer1_policy">rt_timer1_policy</a></div></li>
<li class="level3"><div class="li"><a href="#rt_timer1_prio">rt_timer1_prio</a></div></li>
<li class="level3"><div class="li"><a href="#rt_timer2_policy">rt_timer2_policy</a></div></li>
<li class="level3"><div class="li"><a href="#rt_timer2_prio">rt_timer2_prio</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#core_functions">Core functions</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#add_local_rport">add_local_rport</a></div></li>
<li class="level3"><div class="li"><a href="#avpflags">avpflags</a></div></li>
<li class="level3"><div class="li"><a href="#break">break</a></div></li>
<li class="level3"><div class="li"><a href="#drop">drop</a></div></li>
<li class="level3"><div class="li"><a href="#exit">exit</a></div></li>
<li class="level3"><div class="li"><a href="#error">error</a></div></li>
<li class="level3"><div class="li"><a href="#exec">exec</a></div></li>
<li class="level3"><div class="li"><a href="#force_rport1">force_rport</a></div></li>
<li class="level3"><div class="li"><a href="#add_rport">add_rport</a></div></li>
<li class="level3"><div class="li"><a href="#force_send_socket">force_send_socket</a></div></li>
<li class="level3"><div class="li"><a href="#force_tcp_alias">force_tcp_alias</a></div></li>
<li class="level3"><div class="li"><a href="#forward">forward</a></div></li>
<li class="level3"><div class="li"><a href="#isavpflagset">isavpflagset</a></div></li>
<li class="level3"><div class="li"><a href="#isflagset">isflagset</a></div></li>
<li class="level3"><div class="li"><a href="#is_int">is_int</a></div></li>
<li class="level3"><div class="li"><a href="#log">log</a></div></li>
<li class="level3"><div class="li"><a href="#prefix">prefix</a></div></li>
<li class="level3"><div class="li"><a href="#resetavpflag">resetavpflag</a></div></li>
<li class="level3"><div class="li"><a href="#resetflag">resetflag</a></div></li>
<li class="level3"><div class="li"><a href="#return">return</a></div></li>
<li class="level3"><div class="li"><a href="#revert_uri">revert_uri</a></div></li>
<li class="level3"><div class="li"><a href="#rewritehostport">rewritehostport</a></div></li>
<li class="level3"><div class="li"><a href="#rewritehostporttrans">rewritehostporttrans</a></div></li>
<li class="level3"><div class="li"><a href="#rewritehost">rewritehost</a></div></li>
<li class="level3"><div class="li"><a href="#rewriteport">rewriteport</a></div></li>
<li class="level3"><div class="li"><a href="#rewriteuri">rewriteuri</a></div></li>
<li class="level3"><div class="li"><a href="#rewriteuserpass">rewriteuserpass</a></div></li>
<li class="level3"><div class="li"><a href="#rewriteuser">rewriteuser</a></div></li>
<li class="level3"><div class="li"><a href="#route">route</a></div></li>
<li class="level3"><div class="li"><a href="#set_advertised_address">set_advertised_address</a></div></li>
<li class="level3"><div class="li"><a href="#set_advertised_port">set_advertised_port</a></div></li>
<li class="level3"><div class="li"><a href="#set_forward_no_connect">set_forward_no_connect</a></div></li>
<li class="level3"><div class="li"><a href="#set_forward_close">set_forward_close</a></div></li>
<li class="level3"><div class="li"><a href="#set_reply_no_connect">set_reply_no_connect</a></div></li>
<li class="level3"><div class="li"><a href="#set_reply_close">set_reply_close</a></div></li>
<li class="level3"><div class="li"><a href="#setavpflag">setavpflag</a></div></li>
<li class="level3"><div class="li"><a href="#setflag">setflag</a></div></li>
<li class="level3"><div class="li"><a href="#strip">strip</a></div></li>
<li class="level3"><div class="li"><a href="#strip_tail">strip_tail</a></div></li>
<li class="level3"><div class="li"><a href="#udp_mtu_try_proto_proto">udp_mtu_try_proto(proto)</a></div></li>
<li class="level3"><div class="li"><a href="#userphone">userphone</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#routing_blocks">Routing blocks</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#route1">route</a></div></li>
<li class="level3"><div class="li"><a href="#branch_route">branch_route</a></div></li>
<li class="level3"><div class="li"><a href="#failure_route">failure_route</a></div></li>
<li class="level3"><div class="li"><a href="#onreply_route">onreply_route</a></div></li>
<li class="level3"><div class="li"><a href="#onsend_route">onsend_route</a></div></li>
<li class="level3"><div class="li"><a href="#event_route">event_route</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#script_statements">Script statements</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#if">if</a></div></li>
<li class="level3"><div class="li"><a href="#switch">switch</a></div></li>
<li class="level3"><div class="li"><a href="#while">while</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#script_operations">Script operations</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#assignment">Assignment</a></div></li>
<li class="level3"><div class="li"><a href="#string_operations">String operations</a></div></li>
<li class="level3"><div class="li"><a href="#arithmetic_operations">Arithmetic operations</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#operators">Operators</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="kamailio_sip_server_v42x_stablecore_cookbook">Kamailio SIP Server v4.2.x (stable): Core Cookbook</h1>
<div class="level1">

<p>
This tutorial collects the functions and parameters exported by Kamailio core to configuration file.
</p>

<p>
<strong>Note:</strong> The parameters on this page are <strong>NOT</strong> in alphabetical order.
</p>

</div>

<h2 class="sectionedit2" id="config_pre-processor_directives">Config Pre-Processor Directives</h2>
<div class="level2">

</div>

<h3 class="sectionedit3" id="include_file">include_file</h3>
<div class="level3">
<pre class="code">   include_file &quot;path_to_file&quot;</pre>

<p>
Include the content of the file in config before parsing. path_to_file must be a static string. Including file operation is done at startup. If you change the content of included file, you have to restart the SIP server to become effective.
</p>

<p>
The path_to_file can be relative or absolute. If it is not absolute path, first attempt is to locate it relative to current directory, and if fails, relative to directory of the file that includes it. There is no restriction where include can be used or what can contain - any part of config file is ok. There is a limit of maximum 10 includes in depth, otherwise you can use as many includes as you want. Reporting of the cfg file syntax errors prints now the file name for easier troubleshooting. 
</p>

<p>
If the included file is not found, the config file parser throws error.
</p>

<p>
You can use also the syntax <strong>#!include_file</strong> or <strong>!!include_file</strong>.
</p>

<p>
Example of usage: 
</p>
<pre class="code c">route <span class="br0">&#123;</span>
    ...
    <span class="me1">include_file</span> <span class="st0">&quot;/sr/checks.cfg&quot;</span>
    ...
<span class="br0">&#125;</span>
&nbsp;
<span class="sy0">---</span> <span class="sy0">/</span>sr<span class="sy0">/</span>checks.<span class="me1">cfg</span> <span class="sy0">---</span>
&nbsp;
   <span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span>mf_process_maxfwd_header<span class="br0">&#40;</span><span class="st0">&quot;10&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
       sl_send_reply<span class="br0">&#40;</span><span class="st0">&quot;483&quot;</span><span class="sy0">,</span><span class="st0">&quot;Too Many Hops&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
       <a href="http://www.opengroup.org/onlinepubs/009695399/functions/exit.html"><span class="kw3">exit</span></a><span class="sy0">;</span>
   <span class="br0">&#125;</span>
&nbsp;
<span class="sy0">---</span></pre>

</div>

<h3 class="sectionedit4" id="import_file">import_file</h3>
<div class="level3">
<pre class="code">   import_file &quot;path_to_file&quot;</pre>

<p>
Similar to <strong>include_file</strong>, but does not throw error if the included file is not found.
</p>

</div>

<h3 class="sectionedit5" id="define">define</h3>
<div class="level3">

<p>
Control in C-style what parts of the config file are executed. The parts in non-defined zones are not loaded, ensuring lower memory usage and faster execution.
</p>

<p>
Available directives:
</p>
<ul>
<li class="level1"><div class="li"> #!define NAME - define a keyword</div>
</li>
<li class="level1"><div class="li"> #!define NAME VALUE - define a keyword with value</div>
</li>
<li class="level1"><div class="li"> #!ifdef NAME - check if a keyword is defined</div>
</li>
<li class="level1"><div class="li"> #!ifndef - check if a keyword is not defined</div>
</li>
<li class="level1"><div class="li"> #!else - swtich to false branch of ifdef/ifndef region</div>
</li>
<li class="level1"><div class="li"> #!endif - end ifdef/ifndef region</div>
</li>
<li class="level1"><div class="li"> #!trydef - add a define if not already defined</div>
</li>
<li class="level1"><div class="li"> #!redefine - force redefinition even if already defined</div>
</li>
</ul>

<p>
Among benefits:
</p>
<ul>
<li class="level1"><div class="li"> easy way to enable/disable features (e.g., see default cfg for 3.0.0 ¨C controlling support of nat traversal, presence, etc¡­)</div>
</li>
<li class="level1"><div class="li"> switch control for parts where conditional statements were not possible (e.g., global parameters, module settings)</div>
</li>
<li class="level1"><div class="li"> faster by not using conditional statements inside routing blocks when switching between running environments</div>
</li>
</ul>

<p>
Example: how to make config to be used in two environments, say testbed and production, controlled just by one define to switch between the two modes:
</p>
<pre class="code c">...
&nbsp;
<span class="co2">#!define TESTBED_MODE</span>
&nbsp;
<span class="co2">#!ifdef TESTBED_MODE</span>
  debug<span class="sy0">=</span><span class="nu0">5</span>
  log_stderror<span class="sy0">=</span>yes
  listen<span class="sy0">=</span>192.168.1.1
<span class="co2">#!else</span>
  debug<span class="sy0">=</span><span class="nu0">2</span>
  log_stderror<span class="sy0">=</span>no
  listen<span class="sy0">=</span>10.0.0.1
<span class="co2">#!endif</span>
&nbsp;
...
&nbsp;
<span class="co2">#!ifdef TESTBED_MODE</span>
modparam<span class="br0">&#40;</span><span class="st0">&quot;acc|auth_db|usrloc&quot;</span><span class="sy0">,</span> <span class="st0">&quot;db_url&quot;</span><span class="sy0">,</span>
	<span class="st0">&quot;mysql://openser:openserrw@localhost/openser_testbed&quot;</span><span class="br0">&#41;</span>
<span class="co2">#!else</span>
modparam<span class="br0">&#40;</span><span class="st0">&quot;acc|auth_db|usrloc&quot;</span><span class="sy0">,</span> <span class="st0">&quot;db_url&quot;</span><span class="sy0">,</span>
	<span class="st0">&quot;mysql://openser:openserrw@10.0.0.2/openser_production&quot;</span><span class="br0">&#41;</span>
<span class="co2">#!endif</span>
&nbsp;
...
&nbsp;
<span class="co2">#!ifdef TESTBED_MODE</span>
route<span class="br0">&#91;</span>DEBUG<span class="br0">&#93;</span> <span class="br0">&#123;</span>
  xlog<span class="br0">&#40;</span><span class="st0">&quot;SCRIPT: SIP $rm from: $fu to: $ru - srcip: $si&quot;</span>\n<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span>
<span class="co2">#!endif</span>
&nbsp;
...
&nbsp;
<span class="me1">route</span> <span class="br0">&#123;</span>
<span class="co2">#!ifdef TESTBED_MODE</span>
  route<span class="br0">&#40;</span>DEBUG<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="co2">#!endif</span>
&nbsp;
  ...
<span class="br0">&#125;</span>
&nbsp;
...</pre>
<ul>
<li class="level1"><div class="li"> you can define values for IDs</div>
</li>
</ul>
<pre class="code c"><span class="co2">#!define MYINT 123</span>
<span class="co2">#!define MYSTR &quot;xyz&quot;</span></pre>
<ul>
<li class="level1"><div class="li"> defined IDs are replaced at startup, during config parsing, e.g.,:</div>
</li>
</ul>
<pre class="code c">$var<span class="br0">&#40;</span>x<span class="br0">&#41;</span> <span class="sy0">=</span> <span class="nu0">100</span> <span class="sy0">+</span> MYINT<span class="sy0">;</span></pre>
<ul>
<li class="level1"><div class="li"> is interpreted as:</div>
</li>
</ul>
<pre class="code c">$var<span class="br0">&#40;</span>x<span class="br0">&#41;</span> <span class="sy0">=</span> <span class="nu0">100</span> <span class="sy0">+</span> <span class="nu0">123</span><span class="sy0">;</span></pre>
<ul>
<li class="level1"><div class="li"> you can have multi-line defined IDs</div>
</li>
</ul>
<pre class="code c"><span class="co2">#!define IDLOOP $var(i) = 0; \
                while($var(i)&lt;5) { \
                    xlog(&quot;++++ $var(i)\n&quot;); \
                    $var(i) = $var(i) + 1; \
                }</span></pre>
<ul>
<li class="level1"><div class="li"> then in routing block</div>
</li>
</ul>
<pre class="code c">route <span class="br0">&#123;</span>
    ...
    <span class="me1">IDLOOP</span>
    ...
<span class="br0">&#125;</span></pre>
<ul>
<li class="level1"><div class="li"> number of allowed defines is now set to 256</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> notes:</div>
<ul>
<li class="level2"><div class="li"> multilines defines are reduced to single line, so line counter should be fine</div>
</li>
<li class="level2"><div class="li"> column counter goes inside the define value, but you have to omit the &#039;\&#039; and CR for the accurate inside-define position</div>
</li>
<li class="level2"><div class="li"> text on the same line as the directive will cause problems. Keep the directive lines clean and only comment on a line before or after. </div>
</li>
</ul>
</li>
</ul>

</div>

<h3 class="sectionedit6" id="subst">subst</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> perform substitutions inside the strings of config (note that define is replacing only IDs - alphanumeric tokens not enclosed in quotes)</div>
</li>
<li class="level1"><div class="li"> #!subst offers an easy way to search and replace inside strings before cfg parsing. E.g.,:</div>
</li>
</ul>
<pre class="code c"><span class="co2">#!subst &quot;/regexp/subst/flags&quot;</span></pre>
<ul>
<li class="level1"><div class="li"> flags is optional and can be: &#039;i&#039; - ignore case; &#039;g&#039; - global replacement</div>
</li>
</ul>

<p>
Example:
</p>
<pre class="code c"><span class="co2">#!subst &quot;/DBPASSWD/xyz/&quot;</span>
modparam<span class="br0">&#40;</span><span class="st0">&quot;acc&quot;</span><span class="sy0">,</span> <span class="st0">&quot;db_url&quot;</span><span class="sy0">,</span> <span class="st0">&quot;mysql://user:DBPASSWD@localhost/db&quot;</span><span class="br0">&#41;</span></pre>
<ul>
<li class="level1"><div class="li"> will do the substitution of db password in db_url parameter value</div>
</li>
</ul>

</div>

<h3 class="sectionedit7" id="substdef">substdef</h3>
<div class="level3">
<pre class="code c"><span class="co2">#!substdef &quot;/ID/subst/&quot;</span></pre>

<p>
Similar to <strong>subst</strong>, but in addition it adds a <strong>#!define ID subst</strong>.
</p>

</div>

<h2 class="sectionedit8" id="core_keywords">Core Keywords</h2>
<div class="level2">

<p>
Keywords specific to SIP messages which can be used mainly in <code>&#039;if</code>&#039; expressions.
</p>

</div>

<h3 class="sectionedit9" id="af">af</h3>
<div class="level3">

<p>
The address family of the received SIP message. It is INET if the message was received over IPv4 or INET6 if the message was received over IPv6.
</p>

<p>
Exampe of usage:
</p>
<pre class="code c">    <span class="kw1">if</span> <span class="br0">&#40;</span>af<span class="sy0">==</span>INET6<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <a href="http://www.opengroup.org/onlinepubs/009695399/functions/log.html"><span class="kw3">log</span></a><span class="br0">&#40;</span><span class="st0">&quot;Message received over IPv6 link<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span></pre>

</div>

<h3 class="sectionedit10" id="dst_ip">dst_ip</h3>
<div class="level3">

<p>
The IP of the local interface where the SIP message was received. When the proxy listens on many network interfaces, makes possible to detect which was the one that received the packet.
</p>

<p>
Example of usage:
</p>
<pre class="code c">   <span class="kw1">if</span><span class="br0">&#40;</span>dst_ip<span class="sy0">==</span>127.0.0.1<span class="br0">&#41;</span> <span class="br0">&#123;</span>
      <a href="http://www.opengroup.org/onlinepubs/009695399/functions/log.html"><span class="kw3">log</span></a><span class="br0">&#40;</span><span class="st0">&quot;message received on loopback interface<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
   <span class="br0">&#125;</span><span class="sy0">;</span></pre>

</div>

<h3 class="sectionedit11" id="dst_port">dst_port</h3>
<div class="level3">

<p>
The local port where the SIP packet was received. When SIP-Router is listening on many ports, it is useful to learn which was the one that received the SIP packet.
</p>

<p>
Example of usage:
</p>
<pre class="code c">   <span class="kw1">if</span><span class="br0">&#40;</span>dst_port<span class="sy0">==</span><span class="nu0">5061</span><span class="br0">&#41;</span>
   <span class="br0">&#123;</span>
       <a href="http://www.opengroup.org/onlinepubs/009695399/functions/log.html"><span class="kw3">log</span></a><span class="br0">&#40;</span><span class="st0">&quot;message was received on port 5061<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
   <span class="br0">&#125;</span><span class="sy0">;</span></pre>

</div>

<h3 class="sectionedit12" id="from_uri">from_uri</h3>
<div class="level3">

<p>
This script variable is a reference to the <abbr title="Uniform Resource Identifier">URI</abbr> of &#039;From&#039; header. It can be used to test &#039;From&#039;- header <abbr title="Uniform Resource Identifier">URI</abbr> value.
</p>

<p>
Example of usage:
</p>
<pre class="code c">    <span class="kw1">if</span><span class="br0">&#40;</span>is_method<span class="br0">&#40;</span><span class="st0">&quot;INVITE&quot;</span><span class="br0">&#41;</span> <span class="sy0">&amp;&amp;</span> from_uri<span class="sy0">=</span>~<span class="st0">&quot;.*@sip-router.org&quot;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <a href="http://www.opengroup.org/onlinepubs/009695399/functions/log.html"><span class="kw3">log</span></a><span class="br0">&#40;</span><span class="st0">&quot;the caller is from sip-router.org<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span><span class="sy0">;</span></pre>

</div>

<h3 class="sectionedit13" id="method">method</h3>
<div class="level3">

<p>
The variable is a reference to the SIP method of the message.
</p>

<p>
Example of usage:
</p>
<pre class="code c">    <span class="kw1">if</span><span class="br0">&#40;</span>method<span class="sy0">==</span><span class="st0">&quot;REGISTER&quot;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
       <a href="http://www.opengroup.org/onlinepubs/009695399/functions/log.html"><span class="kw3">log</span></a><span class="br0">&#40;</span><span class="st0">&quot;this SIP request is a REGISTER message<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span><span class="sy0">;</span></pre>

</div>

<h3 class="sectionedit14" id="msglen">msg:len</h3>
<div class="level3">

<p>
The variable is a reference to the size of the message. It can be used in &#039;if&#039; constructs to test message&#039;s size.
</p>

<p>
Example of usage:
</p>
<pre class="code c">    <span class="kw1">if</span><span class="br0">&#40;</span>msg<span class="sy0">:</span>len<span class="sy0">&gt;</span><span class="nu0">2048</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        sl_send_reply<span class="br0">&#40;</span><span class="st0">&quot;413&quot;</span><span class="sy0">,</span> <span class="st0">&quot;message too large&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <a href="http://www.opengroup.org/onlinepubs/009695399/functions/exit.html"><span class="kw3">exit</span></a><span class="sy0">;</span>
    <span class="br0">&#125;</span><span class="sy0">;</span></pre>

<p>
.
</p>

</div>

<h3 class="sectionedit15" id="proto">proto</h3>
<div class="level3">

<p>
This variable can be used to test the transport protocol of the SIP message.
</p>

<p>
Example of usage:
</p>
<pre class="code c">    <span class="kw1">if</span><span class="br0">&#40;</span>proto<span class="sy0">==</span>UDP<span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <a href="http://www.opengroup.org/onlinepubs/009695399/functions/log.html"><span class="kw3">log</span></a><span class="br0">&#40;</span><span class="st0">&quot;SIP message received over UDP<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span><span class="sy0">;</span></pre>

</div>

<h3 class="sectionedit16" id="status">status</h3>
<div class="level3">

<p>
If used in onreply_route, this variable is a referece to the status code of the reply. If it used in a standard route block, the variable is a reference to the status of the last reply sent out for the current request.
</p>

<p>
Example of usage:
</p>
<pre class="code c">    <span class="kw1">if</span><span class="br0">&#40;</span>status<span class="sy0">==</span><span class="st0">&quot;200&quot;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <a href="http://www.opengroup.org/onlinepubs/009695399/functions/log.html"><span class="kw3">log</span></a><span class="br0">&#40;</span><span class="st0">&quot;this is a 200 OK reply<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span><span class="sy0">;</span></pre>

</div>

<h3 class="sectionedit17" id="snd_af">snd_af</h3>
<div class="level3">

</div>

<h3 class="sectionedit18" id="snd_ip">snd_ip</h3>
<div class="level3">

</div>

<h3 class="sectionedit19" id="snd_port">snd_port</h3>
<div class="level3">

</div>

<h3 class="sectionedit20" id="snd_proto">snd_proto</h3>
<div class="level3">

</div>

<h3 class="sectionedit21" id="src_ip">src_ip</h3>
<div class="level3">

<p>
Reference to source IP address of the SIP message.
</p>

<p>
Example of usage:
</p>
<pre class="code c">    <span class="kw1">if</span><span class="br0">&#40;</span>src_ip<span class="sy0">==</span>127.0.0.1<span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <a href="http://www.opengroup.org/onlinepubs/009695399/functions/log.html"><span class="kw3">log</span></a><span class="br0">&#40;</span><span class="st0">&quot;the message was sent from localhost!<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span><span class="sy0">;</span></pre>

</div>

<h3 class="sectionedit22" id="src_port">src_port</h3>
<div class="level3">

<p>
Reference to source port of the SIP message (from which port the message was sent by previous hop).
</p>

<p>
Example of usage:
</p>
<pre class="code c">    <span class="kw1">if</span><span class="br0">&#40;</span>src_port<span class="sy0">==</span><span class="nu0">5061</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <a href="http://www.opengroup.org/onlinepubs/009695399/functions/log.html"><span class="kw3">log</span></a><span class="br0">&#40;</span><span class="st0">&quot;message sent from port 5061<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span></pre>

</div>

<h3 class="sectionedit23" id="to_ip">to_ip</h3>
<div class="level3">

</div>

<h3 class="sectionedit24" id="to_port">to_port</h3>
<div class="level3">

</div>

<h3 class="sectionedit25" id="to_uri">to_uri</h3>
<div class="level3">

<p>
This variable can be used to test the value of <abbr title="Uniform Resource Identifier">URI</abbr> from To header.
</p>

<p>
Example of usage:
</p>
<pre class="code c">  <span class="kw1">if</span><span class="br0">&#40;</span>to_uri<span class="sy0">=</span>~<span class="st0">&quot;sip:.+@sip-router.org&quot;</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
      <a href="http://www.opengroup.org/onlinepubs/009695399/functions/log.html"><span class="kw3">log</span></a><span class="br0">&#40;</span><span class="st0">&quot;this is a request for sip-router.org users<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span><span class="sy0">;</span></pre>

</div>

<h3 class="sectionedit26" id="uri">uri</h3>
<div class="level3">

<p>
This variable can be used to test the value of the request <abbr title="Uniform Resource Identifier">URI</abbr>.
</p>

<p>
Example of usage:
</p>
<pre class="code c">    <span class="kw1">if</span><span class="br0">&#40;</span>uri<span class="sy0">=</span>~<span class="st0">&quot;sip:.+@sip-router.org&quot;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <a href="http://www.opengroup.org/onlinepubs/009695399/functions/log.html"><span class="kw3">log</span></a><span class="br0">&#40;</span><span class="st0">&quot;this is a request for sip-router.org users<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span><span class="sy0">;</span></pre>

</div>

<h2 class="sectionedit27" id="core_values">Core Values</h2>
<div class="level2">

<p>
Values that can be used in <code>&#039;if</code>&#039; expressions to check against Core Keywords
</p>

</div>

<h3 class="sectionedit28" id="inet">INET</h3>
<div class="level3">

<p>
This keyword can be used to test whether the SIP packet was received over an IPv4 connection.
</p>

<p>
Example of usage:
</p>
<pre class="code c">    <span class="kw1">if</span> <span class="br0">&#40;</span>af<span class="sy0">==</span>INET<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <a href="http://www.opengroup.org/onlinepubs/009695399/functions/log.html"><span class="kw3">log</span></a><span class="br0">&#40;</span><span class="st0">&quot;the SIP message was received over IPv4<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span></pre>

</div>

<h3 class="sectionedit29" id="inet6">INET6</h3>
<div class="level3">

<p>
This keyword can be used to test whether the SIP packet was received over an IPv6 connection.
</p>

<p>
Example of usage:
</p>
<pre class="code c">  <span class="kw1">if</span><span class="br0">&#40;</span>af<span class="sy0">==</span>INET6<span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
      <a href="http://www.opengroup.org/onlinepubs/009695399/functions/log.html"><span class="kw3">log</span></a><span class="br0">&#40;</span><span class="st0">&quot;the SIP message was received over IPv6<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span><span class="sy0">;</span></pre>

</div>

<h3 class="sectionedit30" id="sctp">SCTP</h3>
<div class="level3">

<p>
This keyword can be used to test the value of &#039;proto&#039; and check whether the SIP packet was received over SCTP or not.
</p>

<p>
Example of usage:
</p>
<pre class="code c">  <span class="kw1">if</span><span class="br0">&#40;</span>proto<span class="sy0">==</span>SCTP<span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
      <a href="http://www.opengroup.org/onlinepubs/009695399/functions/log.html"><span class="kw3">log</span></a><span class="br0">&#40;</span><span class="st0">&quot;the SIP message was received over SCTP<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span><span class="sy0">;</span></pre>

</div>

<h3 class="sectionedit31" id="tcp">TCP</h3>
<div class="level3">

<p>
This keyword can be used to test the value of &#039;proto&#039; and check whether the SIP packet was received over TCP or not.
</p>

<p>
Example of usage:
</p>
<pre class="code c">  <span class="kw1">if</span><span class="br0">&#40;</span>proto<span class="sy0">==</span>TCP<span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
      <a href="http://www.opengroup.org/onlinepubs/009695399/functions/log.html"><span class="kw3">log</span></a><span class="br0">&#40;</span><span class="st0">&quot;the SIP message was received over TCP<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span><span class="sy0">;</span></pre>

</div>

<h3 class="sectionedit32" id="tls">TLS</h3>
<div class="level3">

<p>
This keyword can be used to test the value of &#039;proto&#039; and check whether the SIP packet was received over TLS or not.
</p>

<p>
Example of usage:
</p>
<pre class="code c">  <span class="kw1">if</span><span class="br0">&#40;</span>proto<span class="sy0">==</span>TLS<span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
      <a href="http://www.opengroup.org/onlinepubs/009695399/functions/log.html"><span class="kw3">log</span></a><span class="br0">&#40;</span><span class="st0">&quot;the SIP message was received over TLS<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span><span class="sy0">;</span></pre>

</div>

<h3 class="sectionedit33" id="udp">UDP</h3>
<div class="level3">

<p>
This keyword can be used to test the value of &#039;proto&#039; and check whether the SIP packet was received over UDP or not.
</p>

<p>
Example of usage:
</p>
<pre class="code c">  <span class="kw1">if</span><span class="br0">&#40;</span>proto<span class="sy0">==</span>UDP<span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
      <a href="http://www.opengroup.org/onlinepubs/009695399/functions/log.html"><span class="kw3">log</span></a><span class="br0">&#40;</span><span class="st0">&quot;the SIP message was received over UDP<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span><span class="sy0">;</span></pre>

</div>

<h3 class="sectionedit34" id="ws">WS</h3>
<div class="level3">

<p>
This keyword can be used to test the value of &#039;proto&#039; and check whether the SIP packet was received over WS or not.
</p>

<p>
Example of usage:
</p>
<pre class="code c">  <span class="kw1">if</span><span class="br0">&#40;</span>proto<span class="sy0">==</span>WS<span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
      <a href="http://www.opengroup.org/onlinepubs/009695399/functions/log.html"><span class="kw3">log</span></a><span class="br0">&#40;</span><span class="st0">&quot;the SIP message was received over WS<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span><span class="sy0">;</span></pre>

</div>

<h3 class="sectionedit35" id="wss">WSS</h3>
<div class="level3">

<p>
This keyword can be used to test the value of &#039;proto&#039; and check whether the SIP packet was received over WSS or not.
</p>

<p>
Example of usage:
</p>
<pre class="code c">  <span class="kw1">if</span><span class="br0">&#40;</span>proto<span class="sy0">==</span>WSS<span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
      <a href="http://www.opengroup.org/onlinepubs/009695399/functions/log.html"><span class="kw3">log</span></a><span class="br0">&#40;</span><span class="st0">&quot;the SIP message was received over WSS<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span><span class="sy0">;</span></pre>

</div>

<h3 class="sectionedit36" id="max_len">max_len</h3>
<div class="level3">

<p>
Note: This command was removed.
</p>

</div>

<h3 class="sectionedit37" id="myself">myself</h3>
<div class="level3">

<p>
It is a reference to the list of local IP addresses, hostnames and aliases that has been set in SIP-Router configuration file. This lists contain the domains served by SIP-Router.
</p>

<p>
The variable can be used to test if the host part of an <abbr title="Uniform Resource Identifier">URI</abbr> is in the list. The usefulness of this test is to select the messages that has to be processed locally or has to be forwarded to another server.
</p>

<p>
See ¡°alias¡± to add hostnames,IP addresses and aliases to the list.
</p>

<p>
Example of usage:
</p>
<pre class="code c">    <span class="kw1">if</span><span class="br0">&#40;</span>uri<span class="sy0">==</span>myself<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <a href="http://www.opengroup.org/onlinepubs/009695399/functions/log.html"><span class="kw3">log</span></a><span class="br0">&#40;</span><span class="st0">&quot;the request is for local processing<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span><span class="sy0">;</span></pre>

</div>

<h2 class="sectionedit38" id="core_parameters">Core parameters</h2>
<div class="level2">

</div>

<h3 class="sectionedit39" id="advertised_address">advertised_address</h3>
<div class="level3">

<p>
It can be an IP address or string and represents the address advertised in Via header and
other destination lumps (e.g RR header). If empty or not set (default value) the socket
address from where the request will be sent is used.
</p>
<pre class="code">WARNING: 
- don&#039;t set it unless you know what you are doing (e.g. nat traversal)
- you can set anything here, no check is made (e.g. foo.bar will be accepted even if foo.bar doesn&#039;t exist)</pre>

<p>
Example of usage:
</p>
<pre class="code">  advertised_address=&quot;1.2.3.4&quot;
  advertised_address=&quot;sip-router.org&quot;</pre>

</div>

<h3 class="sectionedit40" id="advertised_port">advertised_port</h3>
<div class="level3">

<p>
The port advertised in Via header and other destination lumps (e.g. RR). If empty or not set (default value) the port from where the message will be sent is used. Same warnings as for &#039;advertised_address&#039;.
</p>

<p>
Example of usage:
</p>
<pre class="code">  advertised_port=5080</pre>

</div>

<h3 class="sectionedit41" id="alias">alias</h3>
<div class="level3">

<p>
Parameter to set alias hostnames for the server. It can be set many times, each value being added in a list to match the hostname when &#039;myself&#039; is checked.
</p>

<p>
It is necessary to include the port (the port value used in the ¡°port=¡± or ¡°listen=¡± defintions) in the alias definition otherwise the loose_route() function will not work as expected for local forwards. Even if you do not use &#039;myself&#039; explicitly (for example if you use the domain module), it is often necessary to set the alias as these aliases are used by the loose_routing function and might be needed to handle requests with pre-loaded route set correctly.
</p>

<p>
Example of usage:
</p>
<pre class="code">    alias=other.domain.com:5060
    alias=another.domain.com:5060</pre>

</div>

<h3 class="sectionedit42" id="async_workers">async_workers</h3>
<div class="level3">

<p>
Specify how many child processes to create for asynchronous execution. These are processes that can receive tasks from various components and execute them locally, which is different process than the task sender.
</p>

<p>
Default: 0 (asynchronous framework is disabled).
</p>

<p>
Example:
</p>
<pre class="code">    async_workers=4</pre>

</div>

<h3 class="sectionedit43" id="auto_aliases">auto_aliases</h3>
<div class="level3">

<p>
Kamailio by default discovers all IPv4 addresses on all interfaces and does a reverse <abbr title="Domain Name System">DNS</abbr> lookup on these addresses to find host names. Discovered host names are added to aliases list, matching the <strong>myself</strong> condition. To disable host names auto-discovery, turn off auto_aliases.
</p>

<p>
Example:
</p>
<pre class="code">    auto_aliases=no</pre>

</div>

<h3 class="sectionedit44" id="auto_bind_ipv6">auto_bind_ipv6</h3>
<div class="level3">

<p>
When turned on, Kamailio will automatically bind to all IPv6 addresses (much like the default behaviour for IPv4).
</p>

<p>
Example:
</p>
<pre class="code">    auto_bind_ipv6=1</pre>

</div>

<h3 class="sectionedit45" id="check_via">check_via</h3>
<div class="level3">

<p>
Check if the address in top most via of replies is local. Default value is 0 (check disabled).
</p>

<p>
Example of usage:
</p>
<pre class="code">  check_via=1 </pre>

</div>

<h3 class="sectionedit46" id="children">children</h3>
<div class="level3">

<p>
Number of children to fork for the UDP interfaces (one set for each interface - ip:port). Default value is 8. For example if you configure the proxy to listen on 3 UDP ports, it will create 3xchildren processes which handle the incoming UDP messages.
</p>

<p>
For configuration of the TCP/TLS worker threads see the option ¡°tcp_children¡±.
</p>

<p>
Example of usage:
</p>
<pre class="code">  children=16</pre>

</div>

<h3 class="sectionedit47" id="chroot">chroot</h3>
<div class="level3">

<p>
The value must be a valid path in the system. If set, sip-router will chroot (change root directory) to its value.
</p>

<p>
Example of usage:
</p>
<pre class="code">  chroot=/other/fakeroot</pre>

</div>

<h3 class="sectionedit48" id="corelog">corelog</h3>
<div class="level3">

<p>
Set the debug level used to print some log messages from core, which might become annoying and don&#039;t represent critical errors. For example, such case is failure to parse incoming traffic from the network as SIP message, due to someone sending invalid content.
</p>

<p>
Default value is -1 (L_ERR).
</p>

<p>
Example of usage:
</p>
<pre class="code">corelog=1</pre>

</div>

<h3 class="sectionedit49" id="debug">debug</h3>
<div class="level3">

<p>
Set the debug level. Higher values make sip-router to print more debug messages. Log messages are usually sent to syslog, except logging to stderr was activated (see <a href="#log_stderror" title="cookbooks:4.2.x:core ?" class="wikilink1">log_stderror</a> parameter).
</p>

<p>
The following log levels are defined:
</p>
<pre class="code"> L_ALERT     -5
 L_BUG       -4
 L_CRIT2     -3
 L_CRIT      -2
 L_ERR       -1
 L_WARN       0 
 L_NOTICE     1 
 L_INFO       2 
 L_DBG        3 </pre>

<p>
A log message will be logged if its log-level is lower than the defined debug level. Log messages are either produced by the the code, or manually in configuration script using log() or xlog() functions. For a production server you usually use a log value between -1 and 2.
</p>

<p>
Default value: L_WARN (debug=0)
</p>

<p>
Examples of usage:
</p>
<ul>
<li class="level1"><div class="li"> debug=3: print all log messages. This is only usefull for debugging of problems. Note: this produces a lot of data and therefore should not be used on production servers (on a busy server this can easily fill up your hard disk with log messages)</div>
</li>
<li class="level1"><div class="li"> debug=0: This will only log warning, errors and more critical messages.</div>
</li>
<li class="level1"><div class="li"> debug=-6: This will disable all log messages.</div>
</li>
</ul>

<p>
Value of &#039;debug&#039; parameter can also be get and set dynamically using &#039;debug&#039; Core MI function, e.g.:
</p>
<pre class="code">sercmd cfg.get core debug
sercmd cfg.set_now_int core debug 2
sercmd cfg.set_now_int core debug -- -1</pre>

<p>
Note: There is a difference in log-levels between sip-router and Kamailio?1.5: Up to Kamailio 1.5 the log level started with 4, whereas in sip-router the log level starts with 3. Thus, if you were using debug=3 in older Kamailio/Openser, now use debug=2.
</p>

<p>
For configuration of logging of the memory manager see the parameters <a href="#memlog" title="cookbooks:4.2.x:core ?" class="wikilink1">memlog</a> and <a href="#memdbg" title="cookbooks:4.2.x:core ?" class="wikilink1">memdbg</a>.
</p>

<p>
Further information can also be bound at: <a href="http://www.kamailio.org/dokuwiki/doku.php/tutorials:debug-syslog-messages" class="urlextern" title="http://www.kamailio.org/dokuwiki/doku.php/tutorials:debug-syslog-messages"  rel="nofollow">http://www.kamailio.org/dokuwiki/doku.php/tutorials:debug-syslog-messages</a>
</p>

</div>

<h3 class="sectionedit50" id="description">description</h3>
<div class="level3">

<p>
<strong>Alias name: descr desc</strong>
</p>

</div>

<h3 class="sectionedit51" id="disable_core_dump">disable_core_dump</h3>
<div class="level3">

<p>
Can be &#039;yes&#039; or &#039;no&#039;. By default core dump limits are set to unlimited or a high enough value. Set this config variable to &#039;yes&#039; to disable core dump-ing (will set core limits to 0).
</p>

<p>
Default value is &#039;no&#039;.
</p>

<p>
Example of usage:
</p>
<pre class="code">  disable_core_dump=yes</pre>

</div>

<h3 class="sectionedit52" id="disable_tls">disable_tls</h3>
<div class="level3">

<p>
<strong>Alias name: tls_disable</strong>
</p>

<p>
Global parameter to disable TLS support in the SIP server. Default value is &#039;no&#039;.
</p>

<p>
Note: Make sure to load the ¡°tls¡± module to get tls functionality.
</p>

<p>
Example of usage:
</p>
<pre class="code">  disable_tls=yes</pre>

<p>
In sip-router TLS is implemented as a module. Thus, the TLS configuration is done as module configuration. For more details see the README of the TLS module:
<a href="http://sip-router.org/docbook/sip-router/branch/master/modules/tls/tls.html" class="urlextern" title="http://sip-router.org/docbook/sip-router/branch/master/modules/tls/tls.html"  rel="nofollow">http://sip-router.org/docbook/sip-router/branch/master/modules/tls/tls.html</a>
</p>

</div>

<h3 class="sectionedit53" id="enable_tls">enable_tls</h3>
<div class="level3">

<p>
<strong>Alias name: tls_enable</strong>
</p>

<p>
Reverse Meaning of the disable_tls parameter. See disable_tls parameter.
</p>
<pre class="code">enable_tls=yes # enable tls support in core</pre>

</div>

<h3 class="sectionedit54" id="exit_timeout">exit_timeout</h3>
<div class="level3">

<p>
<strong>Alias name: ser_kill_timeout</strong>
</p>

<p>
How much time kamailio/ser will wait for all the shutdown procedures to complete. If this time is exceeded, all the remaining processes are immediately killed and ser exits immediately (it might also generate a core dump if the cleanup part takes too long).
</p>

<p>
Default: 60 s. Use 0 to disable.
</p>
<pre class="code"> exit_timeout = seconds</pre>

</div>

<h3 class="sectionedit55" id="flags">flags</h3>
<div class="level3">

<p>
<strong>Alias name: bool</strong>
</p>

</div>

<h3 class="sectionedit56" id="force_rport">force_rport</h3>
<div class="level3">

<p>
yes/no: Similar to the force_rport() function, but activates symmetric response routing globally.
</p>

</div>

<h3 class="sectionedit57" id="fork">fork</h3>
<div class="level3">

<p>
If set to &#039;yes&#039; the proxy will fork and run in daemon mode - one process will be created for each network interface the proxy listens to and for each protocol (TCP/UDP), multiplied with the value of &#039;children&#039; parameter.
</p>

<p>
When set to &#039;no&#039;, the proxy will stay bound to the terminal and runs as single process. First interface is used for listening to. This is equivalent to setting the server option ¡°-F¡±.
</p>

<p>
Default value is &#039;yes&#039;.
</p>

<p>
Example of usage:
</p>
<pre class="code">  fork=no</pre>

</div>

<h3 class="sectionedit58" id="fork_delay">fork_delay</h3>
<div class="level3">

<p>
Number of usecs to wait before forking a process.
</p>

<p>
Default is 0 (don&#039;t wait).
</p>

<p>
Example of usage:
</p>
<pre class="code c">fork_delay<span class="sy0">=</span><span class="nu0">5000</span></pre>

</div>

<h3 class="sectionedit59" id="group">group</h3>
<div class="level3">

<p>
<strong>Alias name: gid</strong>
</p>

<p>
The group id to run sip-router.
</p>

<p>
Example of usage:
</p>
<pre class="code">group=&quot;siprouter&quot;</pre>

</div>

<h3 class="sectionedit60" id="http_reply_parse">http_reply_parse</h3>
<div class="level3">

<p>
Alias: http_reply_hack
</p>

<p>
When enabled, Kamailio can parse HTTP replies, but does so by treating them as SIP replies.  When not enabled HTTP replies cannot be parsed. This was previously a compile-time option, now it is run-time.
</p>

<p>
Default value is &#039;no&#039;.
</p>

<p>
Example of usage:
</p>
<pre class="code">http_reply_parse=yes</pre>

</div>

<h3 class="sectionedit61" id="latency_limit_action">latency_limit_action</h3>
<div class="level3">

<p>
Limit of latency in ms for config actions. If a config action executed by cfg interpreter takes longer than its value, a message is printed in the logs, showing config path, line and action name when it is a module function, as well as internal action id.
</p>

<p>
Default value is 0 (disabled).
</p>
<pre class="code c">latency_limit_action<span class="sy0">=</span><span class="nu0">500</span></pre>

</div>

<h3 class="sectionedit62" id="latency_limit_db">latency_limit_db</h3>
<div class="level3">

<p>
Limit of latency in ms for db operations. If a db operation executed via DB <abbr title="Application Programming Interface">API</abbr> v1 takes longer that its value, a message is printed in the logs, showing the first 50 characters of the db query.
</p>

<p>
Default value is 0 (disabled).
</p>
<pre class="code c">latency_limit_db<span class="sy0">=</span><span class="nu0">500</span></pre>

</div>

<h3 class="sectionedit63" id="latency_log">latency_log</h3>
<div class="level3">

<p>
Log level to print the messages related to latency.
</p>

<p>
Default value is -1 (L_ERR).
</p>
<pre class="code c">latency_log<span class="sy0">=</span><span class="nu0">3</span></pre>

</div>

<h3 class="sectionedit64" id="listen">listen</h3>
<div class="level3">

<p>
Set the network addresses the SIP server should listen to. It can be an IP address, hostname or network iterface id or combination of protocol:address:port (e.g., udp:10.10.10.10:5060). This parameter can be set multiple times in same configuration file, the server listening on all addresses specified.
</p>

<p>
Example of usage:
</p>
<pre class="code c">    listen<span class="sy0">=</span>10.10.10.10
    listen<span class="sy0">=</span>eth1<span class="sy0">:</span><span class="nu0">5062</span>
    listen<span class="sy0">=</span>udp<span class="sy0">:</span>10.10.10.10<span class="sy0">:</span><span class="nu0">5064</span></pre>

<p>
If you omit this directive then the SIP server will listen on all interfaces. On start the SIP server reports all the interfaces that it is listening on. Even if you specify only UDP interfaces here, the server will start the TCP engine too. If you don&#039;t want this, you need to disable the TCP support completely with the core parameter disable_tcp.
</p>

<p>
If you specify IPv6 addresses, you should put them into square brackets, e.g.:
</p>
<pre class="code c">    listen<span class="sy0">=</span>udp<span class="sy0">:</span><span class="br0">&#91;</span>2a02<span class="sy0">:</span><span class="nu0">1850</span><span class="sy0">:</span><span class="nu0">1</span><span class="sy0">:</span><span class="nu0">1</span><span class="sy0">::</span><span class="nu0">13</span><span class="br0">&#93;</span><span class="sy0">:</span><span class="nu0">5060</span></pre>

<p>
You can specify an advertise address (like ip:port) per listening socket - it will be used to build headers such as Via and Record-Route:
</p>
<pre class="code c">    listen<span class="sy0">=</span>udp<span class="sy0">:</span>10.10.10.10<span class="sy0">:</span><span class="nu0">5060</span> advertise  11.11.11.11<span class="sy0">:</span><span class="nu0">5060</span></pre>

<p>
The advertise address must be the format &#039;address:port&#039;, the protocol is taken from the bind socket. The advertise address is a convenient alternative to advertised_address / advertised_port cfg parameters or set_advertised_address() / set_advertised_port() cfg functions.
</p>

<p>
A typical use case for advertise address is when running SIP server behind a NAT/Firewall, when the local IP address (to be used for bind) is different than the public IP address (to be used for advertising).
</p>

</div>

<h3 class="sectionedit65" id="loadmodule">loadmodule</h3>
<div class="level3">

<p>
Loads a module for later usage in the configuration script. The modules is searched in the path specified by <strong>loadpath</strong>.
</p>

<p>
Prototype: <strong>loadmodule ¡°modulepath¡±</strong>
</p>

<p>
If modulepath is only modulename or modulename.so, then Kamailio will try to search also for <strong>modulename/modulename.so</strong>, very useful when usining directly the version compiled in the source tree.
</p>

<p>
Example of usage:
</p>
<pre class="code c">    loadpath <span class="st0">&quot;/usr/local/lib/kamailio/:usr/local/lib/kamailio/modules/&quot;</span>
&nbsp;
    loadmodule <span class="st0">&quot;/usr/local/lib/kamailio/modules/db_mysql.so&quot;</span>
    loadmodule <span class="st0">&quot;modules/usrloc.so&quot;</span>
    loadmodule <span class="st0">&quot;tm&quot;</span>
    loadmodule <span class="st0">&quot;dialplan.so&quot;</span></pre>

</div>

<h3 class="sectionedit66" id="loadpath">loadpath</h3>
<div class="level3">

<p>
<strong>Alias name: mpath</strong>
</p>

<p>
Set the module search path. loadpath takes a list of directories separated by &#039;:&#039;. The list is searched in-order. For each directory d, $d/${module_name}.so and $d/${module_name}/${module_name}.so are tried.
</p>

<p>
This can be used to simplify the loadmodule parameter and can include many paths separated by colon. First module found is used. 
</p>

<p>
Example of usage: 
</p>
<pre class="code c">    loadpath <span class="st0">&quot;/usr/local/lib/kamailio/modules:/usr/local/lib/kamailio/mymodules&quot;</span>
&nbsp;
    loadmodule <span class="st0">&quot;mysql&quot;</span>
    loadmodule <span class="st0">&quot;uri&quot;</span>
    loadmodule <span class="st0">&quot;uri_db&quot;</span>
    loadmodule <span class="st0">&quot;sl&quot;</span>
    loadmodule <span class="st0">&quot;tm&quot;</span></pre>

<p>
The proxy tries to find the modules in a smart way, e.g: loadmodule ¡°uri¡± tries to find uri.so in the loadpath, but also uri/uri.so.
</p>

</div>

<h3 class="sectionedit67" id="log_facility">log_facility</h3>
<div class="level3">

<p>
If sip-router logs to syslog, you can control the facility for logging. Very useful when you want to divert all sip-router logs to a different log file. See the man page syslog(3) for more details.
</p>

<p>
For more see: <a href="http://www.kamailio.org/dokuwiki/doku.php/tutorials:debug-syslog-messages" class="urlextern" title="http://www.kamailio.org/dokuwiki/doku.php/tutorials:debug-syslog-messages"  rel="nofollow">http://www.kamailio.org/dokuwiki/doku.php/tutorials:debug-syslog-messages</a>
</p>

<p>
Default value is LOG_DAEMON.
</p>

<p>
Example of usage:
</p>
<pre class="code">  log_facility=LOG_LOCAL0</pre>

</div>

<h3 class="sectionedit68" id="log_name">log_name</h3>
<div class="level3">

<p>
Allows to configure a log_name prefix which will be used when printing to syslog. This is useful to filter log messages when running many instance of sip-router on same server.
</p>
<pre class="code">log_name=&quot;kamailio&quot;</pre>

</div>

<h3 class="sectionedit69" id="log_prefix">log_prefix</h3>
<div class="level3">

<p>
Specify the text to be prefixed to the log messages printed by Kamailio while processing a SIP message. It can contain script variables that are evaluated at runtime.
</p>

<p>
Example - prefix with message type (1 - request, 2 - response), CSeq and Call-ID:
</p>
<pre class="code">log_prefix=&quot;{$mt $hdr(CSeq) $ci} &quot;</pre>

</div>

<h3 class="sectionedit70" id="log_stderror">log_stderror</h3>
<div class="level3">

<p>
With this parameter you can make sip-router to write log and debug messages to standard error. Possible values are:
</p>

<p>
- ¡°yes¡± - write the messages to standard error
</p>

<p>
- ¡°no¡± - write the messages to syslog
</p>

<p>
Default value is ¡°no¡±.
</p>

<p>
For more see: <a href="http://www.kamailio.org/dokuwiki/doku.php/tutorials:debug-syslog-messages" class="urlextern" title="http://www.kamailio.org/dokuwiki/doku.php/tutorials:debug-syslog-messages"  rel="nofollow">http://www.kamailio.org/dokuwiki/doku.php/tutorials:debug-syslog-messages</a>
</p>

<p>
Example of usage:
</p>
<pre class="code">  log_stderror=yes</pre>

</div>

<h3 class="sectionedit71" id="maxbuffer">maxbuffer</h3>
<div class="level3">

<p>
The size in bytes not to be exceeded during the auto-probing procedure of descovering the maximum buffer size for receiving UDP messages. Default value is 262144.
</p>

<p>
Example of usage:
</p>
<pre class="code">  maxbuffer=65536
  </pre>

</div>

<h3 class="sectionedit72" id="sql_buffer_size">sql_buffer_size</h3>
<div class="level3">

<p>
The size in bytes of the SQL buffer created for data base queries. For database drivers that use the core db_query library, this will be maximum size object that can be written or read from a database. Default value is 65535.
</p>

<p>
Example of usage:
</p>
<pre class="code">  sql_buffer_size=131070</pre>

</div>

<h3 class="sectionedit73" id="max_recursive_level">max_recursive_level</h3>
<div class="level3">

<p>
The parameters set the value of maximum recursive calls to blocks of actions, such as sub-routes or chained IF-ELSE (for the ELSE branches). Default is 256.
</p>

<p>
Example of usage:
</p>
<pre class="code">  max_recursive_level=500</pre>

</div>

<h3 class="sectionedit74" id="max_while_loops">max_while_loops</h3>
<div class="level3">

<p>
The parameters set the value of maximum loops that can be done within a ¡°while¡±. Comes as a protection to avoid infinite loops in config file execution. Default is 100.  Setting to 0 disables the protection (you will still get a warning when you start Kamailio if you do something like while(1) {¡­}).
</p>

<p>
Example of usage:
</p>
<pre class="code">  max_while_loops=200</pre>

</div>

<h3 class="sectionedit75" id="mcast_loopback">mcast_loopback</h3>
<div class="level3">

<p>
It can be &#039;yes&#039; or &#039;no&#039;. If set to &#039;yes&#039;, multicast datagram are sent over loopback. Default value is &#039;no&#039;.
</p>

<p>
Example of usage:
</p>
<pre class="code">  mcast_loopback=yes</pre>

</div>

<h3 class="sectionedit76" id="mcast_ttl">mcast_ttl</h3>
<div class="level3">

<p>
Set the value for multicast ttl. Default value is <abbr title="Operating System">OS</abbr> specific (usually 1).
</p>

<p>
Example of usage:
</p>
<pre class="code">  mcast_ttl=32</pre>

</div>

<h3 class="sectionedit77" id="memdbg">memdbg</h3>
<div class="level3">

<p>
<strong>Alias name: mem_dbg</strong>
</p>

<p>
This parameter specifies on which log level the memory debugger messages will be logged. If memdbg is active, every request (alloc, free) to the memory manager will be logged. (Note: if compile option NO_DEBUG is specified, there will never be logging from the memory manager).
</p>

<p>
Default value: L_DBG (memdbg=3)
</p>

<p>
For example, memdbg=2 means that memory debugging is activated if the debug level is 2 or higher.
</p>
<pre class="code">debug=3    # no memory debugging as debug level 
memdbg=4   # is lower than memdbg</pre>
<pre class="code">debug=3    # memory debugging is active as the debug level 
memdbg=2   # is higher or equal memdbg</pre>

<p>
Please see also <a href="#memlog" title="cookbooks:4.2.x:core ?" class="wikilink1">memlog</a> and <a href="#debug" title="cookbooks:4.2.x:core ?" class="wikilink1">debug</a>.
</p>

</div>

<h3 class="sectionedit78" id="memlog">memlog</h3>
<div class="level3">

<p>
<strong>Alias name: mem_log</strong>
</p>

<p>
This parameter specifies on which log level the memory statistics will be logged. If memlog is active, sip-router will log memory statistics on shutdown (or if requested via signal SIGUSR1). This can be useful for debugging of memory leaks. 
</p>

<p>
Default value: L_DBG (memlog=3) 
</p>

<p>
For example, memlog=2 means that memory statistics dumping is activated if the debug level is 2 or higher.
</p>
<pre class="code">debug=3    # no memory statistics as debug level 
memlog=4   # is lower than memlog</pre>
<pre class="code">debug=3    # dumping of memory statistics is active as the 
memlog=2   # debug level is higher or equal memlog</pre>

<p>
Please see also <a href="#memdbg" title="cookbooks:4.2.x:core ?" class="wikilink1">memdbg</a> and <a href="#debug" title="cookbooks:4.2.x:core ?" class="wikilink1">debug</a>.
</p>

</div>

<h3 class="sectionedit79" id="mem_join">mem_join</h3>
<div class="level3">

<p>
If set to 1, memory manger (e.g., q_malloc) does join of free fragments. It is effective if MEM_JOIN_FREE compile option is defined.
</p>

<p>
It can be set via config reload framework.
</p>

<p>
Default is 0 (disabled).
</p>
<pre class="code c">mem_join<span class="sy0">=</span><span class="nu0">1</span></pre>

</div>

<h3 class="sectionedit80" id="mem_safety">mem_safety</h3>
<div class="level3">

<p>
If set to 1, memory free operation does not call abort() for double freeing a pointer or freeing an invalid address. The server still prints the alerting log messages.
</p>

<p>
It can be set via config reload framework.
</p>

<p>
Default is 0 (disabled).
</p>
<pre class="code c">mem_safety<span class="sy0">=</span><span class="nu0">1</span></pre>

</div>

<h3 class="sectionedit81" id="mem_summary">mem_summary</h3>
<div class="level3">

<p>
Parameter to control printing of mmemory debugging information displayed on exit or SIGUSR1. The value can be composed by following flags:
</p>
<ul>
<li class="level1"><div class="li"> 1 - dump all the pkg used blocks (status)</div>
</li>
<li class="level1"><div class="li"> 2 - dump all the shm used blocks (status)</div>
</li>
<li class="level1"><div class="li"> 4 - summary of pkg used blocks</div>
</li>
<li class="level1"><div class="li"> 8 - summary of shm used blocks</div>
</li>
</ul>

<p>
If set to 0, nothing is printed.
</p>

<p>
Default value: 3
</p>

<p>
Example:
</p>
<pre class="code c">mem_summary<span class="sy0">=</span><span class="nu0">15</span></pre>

</div>

<h3 class="sectionedit82" id="mhomed">mhomed</h3>
<div class="level3">

<p>
Set the server to try to locate outbound interface on multihomed host. This parameter affects the selection of the outgoing socket for forwarding requests. By default is off (0) - it is rather time consuming. When deactivated, the incoming socket will be used or the first one for a different protocol, disregarding the destination location. When activated, sip-router will select a socket that can reach the destination (to be able to connect to the remote address). (sip-router opens a UDP socket to the destination, then it retrieves the local IP which was assigned by the operating system to the new UDP socket. Then this socket will be closed and the retrieved IP address will be used as IP address in the Via/Record-Route headers)
</p>

<p>
Example of usage:
</p>
<pre class="code">  mhomed=1</pre>

</div>

<h3 class="sectionedit83" id="mlock_pages">mlock_pages</h3>
<div class="level3">

<p>
Locks all ser pages into memory making it unswappable (in general one doesn&#039;t want his sip proxy swapped out <img src="/wiki/lib/images/smileys/icon_smile.gif" class="icon" alt=":-)" />)
</p>
<pre class="code">mlock_pages = yes |no (default no)</pre>

</div>

<h3 class="sectionedit84" id="modinit_delay">modinit_delay</h3>
<div class="level3">

<p>
Number of microseconds to wait after initializing a module - useful to cope with systems where are rate limits on new connections to database or other systems.
</p>

<p>
Default value is 0 (no wait).
</p>
<pre class="code">modinit_delay=100000</pre>

</div>

<h3 class="sectionedit85" id="modparam">modparam</h3>
<div class="level3">

<p>
The modparam command will be used to set the options of the modules. 
</p>

<p>
Example:
</p>
<pre class="code">modparam(&quot;usrloc&quot;, &quot;db_mode&quot;, 2)
modparam(&quot;usrloc&quot;, &quot;nat_bflag&quot;, 6)</pre>

<p>
See the documenation of the respective module to find out the available options.
</p>

</div>

<h3 class="sectionedit86" id="onsend_route_reply">onsend_route_reply</h3>
<div class="level3">

<p>
If set to 1 (yes, on), onsend_route block is executed for received replies that are sent out. Default is 0.
</p>
<pre class="code">  onsend_route_reply=yes</pre>

</div>

<h3 class="sectionedit87" id="open_files_limit">open_files_limit</h3>
<div class="level3">

<p>
If set and bigger than the current open file limit, sip-router will try to increase its open file limit to this number. Note: sip-router must be started as root to be able to increase a limit past the hard limit (which, for open files, is 1024 on most systems).
</p>

<p>
Example of usage:
</p>
<pre class="code">  open_files_limit=2048</pre>

</div>

<h3 class="sectionedit88" id="phone2tel">phone2tel</h3>
<div class="level3">

<p>
By enabling this feature, SIP-Router internally treats SIP URIs with user=phone parameter as TEL URIs. If you do not want this behavior, you have to turn it off. 
</p>

<p>
Default value: 1 (enabled)
</p>
<pre class="code">phone2tel = 0</pre>

</div>

<h3 class="sectionedit89" id="pmtu_discovery">pmtu_discovery</h3>
<div class="level3">

<p>
If enabled, the Don&#039;t Fragment (DF) bit will be set in outbound IP packets.
</p>
<pre class="code">pmtu_discovery = 0 | 1 (default 0)</pre>

</div>

<h3 class="sectionedit90" id="port">port</h3>
<div class="level3">

<p>
The port the SIP server listens to. The default value for it is 5060.
</p>

<p>
Example of usage:
</p>
<pre class="code">  port=5080</pre>

</div>

<h3 class="sectionedit91" id="pv_buffer_size">pv_buffer_size</h3>
<div class="level3">

<p>
The size in bytes of internal buffer to print dynamic strings with pseudo-variables inside. The default value is 1024.
</p>

<p>
Example of usage:
</p>
<pre class="code">pv_buffer_size=2048</pre>

</div>

<h3 class="sectionedit92" id="pv_buffer_slots">pv_buffer_slots</h3>
<div class="level3">

<p>
The number of internal buffer slots to print dynamic strings with pseudo-variables inside. The default value is 10.
</p>

<p>
Example of usage:
</p>
<pre class="code">pv_buffer_slots=12</pre>

</div>

<h3 class="sectionedit93" id="reply_to_via">reply_to_via</h3>
<div class="level3">

<p>
If it is set to 1, any local reply is sent to the IP address advertised in top most Via of the request instead of the IP address from which the request was received. Default value is 0 (off).
</p>

<p>
Example of usage:
</p>
<pre class="code">  reply_to_via=0</pre>

</div>

<h3 class="sectionedit94" id="server_id">server_id</h3>
<div class="level3">

<p>
A configurable unique server id that can be used to discriminate server instances within a cluster of servers when all other  information, such as IP addresses are the same.
</p>
<pre class="code c">  server_id <span class="sy0">=</span> number</pre>

</div>

<h3 class="sectionedit95" id="server_header">server_header</h3>
<div class="level3">

<p>
Set the value of Server header for replies generated by Kamailio. It must contain the header name, but not the ending CRLF.
</p>

<p>
Example of usage:
</p>
<pre class="code c">server_header<span class="sy0">=</span><span class="st0">&quot;Server: My Super SIP Server&quot;</span></pre>

</div>

<h3 class="sectionedit96" id="server_signature">server_signature</h3>
<div class="level3">

<p>
This parameter controls the ¡°Server¡± header in any locally generated message. 
</p>

<p>
Example of usage:
</p>
<pre class="code">   server_signature=no</pre>

<p>
If it is enabled (default=yes) a header is generated as in the following example:
</p>
<pre class="code">   Server: Kamailio (&lt;version&gt; (&lt;arch&gt;/&lt;os&gt;))</pre>

</div>

<h3 class="sectionedit97" id="shm_force_alloc">shm_force_alloc</h3>
<div class="level3">

<p>
Tries to pre-fault all the shared memory, before starting. When ¡°on¡±, start time will increase, but combined with mlock_pages will guarantee ser will get all its memory from the beginning (no more kswapd slow downs)
</p>

<p>
shm_force_alloc = yes | no (default no)
</p>

</div>

<h3 class="sectionedit98" id="sip_warning_noisy_feedback">sip_warning (noisy feedback)</h3>
<div class="level3">

<p>
Can be 0 or 1. If set to 1 (default value) a &#039;Warning&#039; header is added to each reply generated by sip-router.
The header contains several details that help troubleshooting using the network traffic dumps, but might reveal details of your network infrastructure and internall SIP routing.
</p>

<p>
Example of usage:
</p>
<pre class="code">  sip_warning=0</pre>

</div>

<h3 class="sectionedit99" id="socket_workers">socket_workers</h3>
<div class="level3">

<p>
Number of workers to process SIP traffic per listen socket - typical use is before a <strong>listen</strong> global parameter.
</p>
<ul>
<li class="level1"><div class="li"> when used before <strong>listen</strong> on UDP or SCTP socket, it overwrites <strong>children</strong> or <strong>sctp_children</strong> value for that socket.</div>
</li>
<li class="level1"><div class="li"> when used before <strong>listen</strong> on TCP or TLS socket, it adds extra tcp workers, these handling traffic only on that socket.</div>
</li>
</ul>

<p>
The value of <strong>socket_workers</strong> is reset with next <strong>listen</strong> socket definition that is added, thus use it for each <strong>listen</strong> socket where you want custom number of workers.
</p>

<p>
If this parameter is not used at all, the values for <strong>children</strong>, <strong>tcp_children</strong> and <strong>sctp_children</strong> are used as usually.
</p>

<p>
Example for udp sockets:
</p>
<pre class="code c">children<span class="sy0">=</span><span class="nu0">4</span>
socket_workers<span class="sy0">=</span><span class="nu0">2</span>
listen<span class="sy0">=</span>udp<span class="sy0">:</span>127.0.0.1<span class="sy0">:</span><span class="nu0">5080</span>
listen<span class="sy0">=</span>udp<span class="sy0">:</span>127.0.0.1<span class="sy0">:</span><span class="nu0">5070</span>
listen<span class="sy0">=</span>udp<span class="sy0">:</span>127.0.0.1<span class="sy0">:</span><span class="nu0">5060</span></pre>
<ul>
<li class="level1"><div class="li"> it will start 2 workers to handle traffic on udp:127.0.0.1:5080 and 4 for each of udp:127.0.0.1:5070 and udp:127.0.0.1:5060. In total there are 10 worker processes</div>
</li>
</ul>

<p>
Example for tcp sockets:
</p>
<pre class="code c">children<span class="sy0">=</span><span class="nu0">4</span>
socket_workers<span class="sy0">=</span><span class="nu0">2</span>
listen<span class="sy0">=</span>tcp<span class="sy0">:</span>127.0.0.1<span class="sy0">:</span><span class="nu0">5080</span>
listen<span class="sy0">=</span>tcp<span class="sy0">:</span>127.0.0.1<span class="sy0">:</span><span class="nu0">5070</span>
listen<span class="sy0">=</span>tcp<span class="sy0">:</span>127.0.0.1<span class="sy0">:</span><span class="nu0">5060</span></pre>
<ul>
<li class="level1"><div class="li"> it will start 2 workers to handle traffic on tcp:127.0.0.1:5080 and 4 to handle traffic on both tcp:127.0.0.1:5070 and tcp:127.0.0.1:5060. In total there are 6 worker processes</div>
</li>
</ul>

</div>

<h3 class="sectionedit100" id="statistics">statistics</h3>
<div class="level3">

<p>
Kamailio has built-in support for statistics counter. This means, these counters can be increased, decreased, read and cleared. The statistics counter are defined either by the core (e.g. tcp counters), by modules (e.g. 2xx_transactions by ¡°tmx¡± module) or by the script writer using the ¡°statistics¡± module.
</p>

<p>
The statistics counters are read/updated either automatically by Kamailio internally (e.g. tcp counters), by the script writer via the module functions of the ¡°statistics¡± module, by the script writer using the $stat() pseudo variable (read-only), or via MI commands.
</p>

<p>
Following are some examples how to access statistics variables:
</p>

<p>
<strong>script</strong>
</p>
<pre class="code">modparam(&quot;statistics&quot;, &quot;variable&quot;, &quot;NOTIFY&quot;)

(if method == &quot;NOTIFY&quot;) {
  update_stat(&quot;NOTIFY&quot;, &quot;+1&quot;);
}

xlog(&quot;Number of received NOTIFYs: $stat(NOTIFY)&quot;);</pre>

<p>
<strong>MI</strong>
</p>
<pre class="code"># get counter value
kamctl fifo get_statistics NOTIFY
# set counter to zero
kamctl fifo reset_statistics NOTIFY
# get counter value and then set it to zero
kamctl fifo clear_statistics NOTIFY

# or use the sercmd tool
sercmd mi get_statistics 1xx_replies</pre>

</div>

<h3 class="sectionedit101" id="tos">tos</h3>
<div class="level3">

<p>
The TOS (Type Of Service) to be used for the sent IP packages (both TCP and UDP).
</p>

<p>
Example of usage:
</p>
<pre class="code">  tos=IPTOS_LOWDELAY
  tos=0x10
  tos=IPTOS_RELIABILITY</pre>

</div>

<h3 class="sectionedit102" id="udp_mtu">udp_mtu</h3>
<div class="level3">

<p>
Fallback to another protocol (udp_mtu_try_proto must be set also either globally or per packet) if the constructed request size is greater then udp_mtu.
</p>

<p>
<abbr title="Request for Comments">RFC</abbr> 3261 specified size: 1300. Default: 0 (off).
</p>
<pre class="code">udp_mtu = number</pre>

</div>

<h3 class="sectionedit103" id="udp_mtu_try_proto">udp_mtu_try_proto</h3>
<div class="level3">

<p>
If udp_mtu !=0 and udp forwarded request size (after adding all the ¡°local¡± headers) &gt; udp_mtu, use this protocol instead of udp. Only the Via header will be updated (e.g. The Record-Route will be the one built for udp).
</p>

<p>
<strong>Warning:</strong> Although RFC3261 mandates automatic transport protocol changing, enabling this feature can lead to problems with clients which do not support other protocols or are behind a firewall or NAT. Use this only when you know what you do!
</p>

<p>
See also udp_mtu_try_proto(proto) function.
</p>

<p>
Default: UDP (off). Recommended: TCP.
</p>
<pre class="code">udp_mtu_try_proto = TCP|TLS|SCTP|UDP</pre>

</div>

<h3 class="sectionedit104" id="user">user</h3>
<div class="level3">

<p>
<strong>Alias name: uid</strong>
</p>

<p>
The user id to run sip-router (sip-router will suid to it).
</p>

<p>
Example of usage:
</p>
<pre class="code c">    user<span class="sy0">=</span><span class="st0">&quot;siprouter&quot;</span></pre>

</div>

<h3 class="sectionedit105" id="user_agent_header">user_agent_header</h3>
<div class="level3">

<p>
Set the value of User-Agent header for requests generated by Kamailio. It must contain header name as well, but not the ending CRLF.
</p>
<pre class="code c">user_agent_header<span class="sy0">=</span><span class="st0">&quot;User-Agent: My Super SIP Server&quot;</span></pre>

</div>

<h3 class="sectionedit106" id="workdir">workdir</h3>
<div class="level3">

<p>
<strong>Alias name: wdir</strong>
</p>

<p>
The working directory used by sip-router at runtime. You might find it usefull when come to generating core files :)
</p>

<p>
Example of usage:
</p>
<pre class="code">   wdir=&quot;/usr/local/siprouter&quot;
   or
   wdir=/usr/openser_wd</pre>

</div>

<h2 class="sectionedit107" id="dns_parameters">DNS Parameters</h2>
<div class="level2">

<p>
Note: See also file doc/dns.txt for details about Kamailio&#039;s <abbr title="Domain Name System">DNS</abbr> client.
</p>

<p>
SIP-Router has an internal <abbr title="Domain Name System">DNS</abbr> resolver with caching capabilities. If this caching resolver is activated (default setting) then the system&#039;s stub resolver won&#039;t be used. Thus, also local name resolution configuration like /etc/hosts entries will not be used. If the dns cache is deactivated (use_dns_cache=no), then system&#039;s resolver will be used. The <abbr title="Domain Name System">DNS</abbr> failover functionality in tm module references directly records in the <abbr title="Domain Name System">DNS</abbr> cache (which saves a lot of memory) and hence <abbr title="Domain Name System">DNS</abbr> based failover only works if the internal <abbr title="Domain Name System">DNS</abbr> cache is enabled.
</p>
<div class="table sectionedit108"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> <abbr title="Domain Name System">DNS</abbr> resolver comparison   </th><th class="col1"> internal resolver </th><th class="col2"> system resolver </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"> Caching of resolved records </td><td class="col1"> yes </td><td class="col2"> no* </td>
	</tr>
	<tr class="row2">
		<td class="col0"> NAPTR/SRV lookups with correct weighting </td><td class="col1"> yes </td><td class="col2"> yes </td>
	</tr>
	<tr class="row3">
		<td class="col0"> <abbr title="Domain Name System">DNS</abbr> based failover </td><td class="col1"> yes </td><td class="col2"> no </td>
	</tr>
</table></div>

<p>
* Of course you can use the resolving name servers configured in /etc/resolv.conf as caching nameservers.
</p>

<p>
If the internal resolver/cache is enabled you can add/remove records by hand (using sercmd or xmlrpc) using the <abbr title="Domain Name System">DNS</abbr> RPCs, e.g. dns.add_a,
dns.add_srv, dns.delete_a a.s.o. For more info on <abbr title="Domain Name System">DNS</abbr> RPCs see <a href="http://www.kamailio.org/docs/docbooks/devel/rpc_list/rpc_list.html#dns.add_a" class="urlextern" title="http://www.kamailio.org/docs/docbooks/devel/rpc_list/rpc_list.html#dns.add_a"  rel="nofollow">http://www.kamailio.org/docs/docbooks/devel/rpc_list/rpc_list.html#dns.add_a</a>
</p>

<p>
Note: During startup of SIP-Router, before the internal resolver is loaded, the system resolver will be used (it will be used for queries done from module register functions or modparams fixups, but not for queries done from mod_init() or normal fixups). 
</p>

<p>
Note: The dns cache uses the <abbr title="Domain Name System">DNS</abbr> servers configured on your server (/etc/resolv.conf), therefore even if you use the internal resolver you should have a working <abbr title="Domain Name System">DNS</abbr> resolving configuration on your server.
</p>

<p>
SIP-Router also allows you to finetune the <abbr title="Domain Name System">DNS</abbr> resolver settings.
</p>

<p>
The maximum time a dns request can take (before failing) is (if dns_try_ipv6 is yes, mutliply it again by 2; if SRV and NAPTR lookups are enabled, it can take even longer!):
</p>
<pre class="code">(dns_retr_time*(dns_retr_no+1)*dns_servers_no)*(search_list_domains)</pre>

<p>
Note: During <abbr title="Domain Name System">DNS</abbr> lookups, the process which performs the <abbr title="Domain Name System">DNS</abbr> lookup blocks. To minimize the blocked time the following parameters can be used (max 2s):
</p>
<pre class="code">dns_try_ipv6=no
dns_retr_time=1
dns_retr_no=1
dns_use_search_list=no</pre>

</div>

<h3 class="sectionedit109" id="dns">dns</h3>
<div class="level3">

<p>
This parameter controls if the SIP server will try doing a <abbr title="Domain Name System">DNS</abbr> lookup on the address in the Via header of a received sip request to decide if adding a received=&lt;src_ip&gt; parameter to the Via is necessary. Note that Vias containing
<abbr title="Domain Name System">DNS</abbr> names (instead of IPs) should have received= added, so turning dns to yes is not recommended.
</p>

<p>
Default is no.
</p>

</div>

<h3 class="sectionedit110" id="rev_dns">rev_dns</h3>
<div class="level3">

<p>
This parameter controls if the SIP server will try doing a reverse <abbr title="Domain Name System">DNS</abbr> lookup on the source IP of a sip request
to decide if adding a received=&lt;src_ip&gt; parameter to the Via is necessary (if the Via contains a <abbr title="Domain Name System">DNS</abbr> name instead of an IP address, the result of the reverse dns on the source IP will be compared with the <abbr title="Domain Name System">DNS</abbr> name in the Via).
See also dns (the effect is cumulative, both can be turned on and in that case if the <abbr title="Domain Name System">DNS</abbr> lookup test fails the reverse
 <abbr title="Domain Name System">DNS</abbr> test will be tried).
Note that Vias containing <abbr title="Domain Name System">DNS</abbr> names (instead of IPs) should have received= added, so turning rev_dns to yes is not recommended. 
</p>

<p>
Default is no.
</p>

</div>

<h3 class="sectionedit111" id="dns_cache_del_nonexp">dns_cache_del_nonexp</h3>
<div class="level3">

<p>
<strong>Alias name: dns_cache_delete_nonexpired</strong>
</p>
<pre class="code">dns_cache_del_nonexp = yes | no (default: no) 
  allow deletion of non-expired records from the cache when there is no more space
  left for new ones. The last-recently used entries are deleted first.</pre>

</div>

<h3 class="sectionedit112" id="dns_cache_flags">dns_cache_flags</h3>
<div class="level3">
<pre class="code">dns_cache_flags = number (default 0) - 
  dns cache specific resolver flags, used for overriding the default behaviour (low level).
  Possible values:
    1 - ipv4 only: only DNS A requests are performed, even if Kamailio also listens on ipv6 addresses.
    2 - ipv6 only: only DNS AAAA requests are performed. Ignored if dns_try_ipv6 is off or Kamailio 
        doesn&#039;t listen on any ipv6 address.
    4 - prefer ipv6: try first to resolve a host name to an ipv6 address (DNS AAAA request) and only
        if this fails try an ipv4 address (DNS A request). By default the ipv4 addresses are preferred.</pre>

</div>

<h3 class="sectionedit113" id="dns_cache_gc_interval">dns_cache_gc_interval</h3>
<div class="level3">

<p>
Interval in seconds after which the dns cache is garbage collected (default: 120 s)
</p>
<pre class="code">dns_cache_gc_interval = number</pre>

</div>

<h3 class="sectionedit114" id="dns_cache_init">dns_cache_init</h3>
<div class="level3">

<p>
If off, the dns cache is not initialized at startup and cannot be enabled runtime, that saves some memory.
</p>
<pre class="code">dns_cache_init = on | off (default on)</pre>

</div>

<h3 class="sectionedit115" id="dns_cache_max_ttl">dns_cache_max_ttl</h3>
<div class="level3">
<pre class="code">dns_cache_max_ttl = time in seconds (default MAXINT)</pre>

</div>

<h3 class="sectionedit116" id="dns_cache_mem">dns_cache_mem</h3>
<div class="level3">

<p>
Maximum memory used for the dns cache in KB (default 500 K)
</p>
<pre class="code">dns_cache_mem = number</pre>

</div>

<h3 class="sectionedit117" id="dns_cache_min_ttl">dns_cache_min_ttl</h3>
<div class="level3">
<pre class="code">dns_cache_min_ttl = time in seconds (default 0)</pre>

</div>

<h3 class="sectionedit118" id="dns_cache_negative_ttl">dns_cache_negative_ttl</h3>
<div class="level3">

<p>
Tells how long to keep negative <abbr title="Domain Name System">DNS</abbr> responses in cache.  If set to 0, disables caching of negative responses. Default is 60 (seconds).
</p>

</div>

<h3 class="sectionedit119" id="dns_naptr_ignore_rfc">dns_naptr_ignore_rfc</h3>
<div class="level3">

<p>
If the dns lookup should ignore the remote side&#039;s protocol preferences, as indicated by the Order field in the NAPTR records and mandated by <abbr title="Request for Comments">RFC</abbr> 2915.
</p>
<pre class="code">  dns_naptr_ignore rfc = yes | no (default yes)</pre>

</div>

<h3 class="sectionedit120" id="dns_retr_no">dns_retr_no</h3>
<div class="level3">

<p>
Number of dns retransmissions before giving up. Default value is system specific, depends also on the &#039;/etc/resolv.conf&#039; content (usually 4).
</p>

<p>
Example of usage:
</p>
<pre class="code">  dns_retr_no=3</pre>

</div>

<h3 class="sectionedit121" id="dns_retr_time">dns_retr_time</h3>
<div class="level3">

<p>
Time in seconds before retrying a dns request. Default value is system specific, depends also on the &#039;/etc/resolv.conf&#039; content (usually 5s).
</p>

<p>
Example of usage:
</p>
<pre class="code">  dns_retr_time=3</pre>

</div>

<h3 class="sectionedit122" id="dns_search_full_match">dns_search_full_match</h3>
<div class="level3">

<p>
When name was resolved using dns search list, check the domain added in the answer matches with one from the search list (small performance hit, but more safe)
</p>
<pre class="code">dns_search_full_match = yes | no (default yes)</pre>

</div>

<h3 class="sectionedit123" id="dns_servers_no">dns_servers_no</h3>
<div class="level3">

<p>
How many dns servers from the ones defined in &#039;/etc/resolv.conf&#039; will be used. Default value is to use all of them.
</p>

<p>
Example of usage:
</p>
<pre class="code">  dns_servers_no=2</pre>

</div>

<h3 class="sectionedit124" id="dns_srv_lb">dns_srv_lb</h3>
<div class="level3">

<p>
<strong>Alias name: dns_srv_loadbalancing</strong>
</p>

<p>
Enable dns srv weight based load balancing (see doc/dns.txt)
</p>
<pre class="code">dns_srv_lb = yes | no (default no)</pre>

</div>

<h3 class="sectionedit125" id="dns_try_ipv6">dns_try_ipv6</h3>
<div class="level3">

<p>
Can be &#039;yes&#039; or &#039;no&#039;. If it is set to &#039;yes&#039; and a <abbr title="Domain Name System">DNS</abbr> lookup fails, it will retry it
for ipv6 (AAAA record). Default value is &#039;no&#039;.
</p>

<p>
Note: If dns_try_ipv6 is off, no hostname resolving that would result in an ipv6 address would succeed - it doesn&#039;t matter if an actual <abbr title="Domain Name System">DNS</abbr> lookup is to be performed or the host is already an ip address. Thus, if the proxy should forward requests to IPv6 targets, this option must be turned on!
</p>

<p>
Example of usage:
</p>
<pre class="code">  dns_try_ipv6=yes</pre>

</div>

<h3 class="sectionedit126" id="dns_try_naptr">dns_try_naptr</h3>
<div class="level3">

<p>
Enable NAPTR support according to <abbr title="Request for Comments">RFC</abbr> 3263 (see doc/dns.txt for more info)
</p>
<pre class="code">  
dns_try_naptr = yes | no (default no)</pre>

</div>

<h3 class="sectionedit127" id="dns_sctp_pref_dns_tcp_pref_dns_tls_pref_dns_udp_pref">dns_sctp_pref, dns_tcp_pref, dns_tls_pref, dns_udp_pref</h3>
<div class="level3">

<p>
<strong>Alias name: dns_sctp_preference, dns_tcp_preference, dns_tls_preference, dns_udp_preference</strong>
</p>

<p>
Set preference for each protocol when doing naptr lookups. By default dns_udp_pref=30, dns_tcp_pref=20, 
dns_tls_pref=10 and dns_sctp_pref=20. To use the remote site preferences set all dns_*_pref to the same positive value (e.g. dns_udp_pref=1,
dns_tcp_pref=1, dns_tls_pref=1, dns_sctp_pref=1). To completely ignore NAPTR records for a specific protocol, set the corresponding protocol 
preference to -1 (or any other negative number). (see doc/dns.txt for more info)
</p>
<pre class="code">dns_{udp,tcp,tls,sctp}_pref = number</pre>

</div>

<h3 class="sectionedit128" id="dns_use_search_list">dns_use_search_list</h3>
<div class="level3">

<p>
Can be &#039;yes&#039; or &#039;no&#039;. If set to &#039;no&#039;, the search list in &#039;/etc/resolv.conf&#039; will be ignored (? fewer lookups ? gives up faster). Default value is &#039;yes&#039;.
</p>

<p>
HINT: even if you don&#039;t have a search list defined, setting this option to &#039;no&#039; will still be ¡°faster¡±, because an empty search list is in fact search ¡°¡± (so even if the search list is empty/missing there will still be 2 dns queries, eg. foo+&#039;.&#039; and  oo+¡°¡±+&#039;.&#039;)
</p>

<p>
Example of usage:
</p>
<pre class="code">  dns_use_search_list=no</pre>

</div>

<h3 class="sectionedit129" id="use_dns_cache">use_dns_cache</h3>
<div class="level3">

<p>
Tells if <abbr title="Domain Name System">DNS</abbr> responses are cached - this means that the internal <abbr title="Domain Name System">DNS</abbr> resolver (instead of the system&#039;s stub resolver) will be used.  If set to ¡°off¡±, disables caching of <abbr title="Domain Name System">DNS</abbr> responses and, as side effect, <abbr title="Domain Name System">DNS</abbr> failover. Default is ¡°on¡±. Settings can be changed also during runtime (switch from niternal to system resolver and back).
</p>

</div>

<h3 class="sectionedit130" id="use_dns_failover">use_dns_failover</h3>
<div class="level3">

<p>
use_dns_failover = on | off (default off)
</p>

</div>

<h2 class="sectionedit131" id="tcp_parameters">TCP Parameters</h2>
<div class="level2">

<p>
The following parameters allows to tweak the TCP behaviour.
</p>

</div>

<h3 class="sectionedit132" id="disable_tcp">disable_tcp</h3>
<div class="level3">

<p>
Global parameter to disable TCP support in the SIP server. Default value is &#039;no&#039;.
</p>

<p>
Example of usage:
</p>
<pre class="code">  disable_tcp=yes</pre>

</div>

<h3 class="sectionedit133" id="tcp_accept_aliases">tcp_accept_aliases</h3>
<div class="level3">

<p>
If a message received over a tcp connection has ¡°alias¡± in its via a new tcp alias port will be created for the connection the message came from (the alias port will be set to the via one).
</p>

<p>
Based on draft-ietf-sip-connect-reuse-00.txt, but using only the port (host aliases are dangerous, involve extra <abbr title="Domain Name System">DNS</abbr> lookups and the need for them is questionable)
</p>

<p>
See force_tcp_alias for more details.
</p>

<p>
Note: For NAT traversal of TCP clients it is better to not use tcp_accept_aliases but just use nathelper module and fix_nated_[contact|register] functions.
</p>
<pre class="code"> tcp_accept_aliases= yes|no</pre>

</div>

<h3 class="sectionedit134" id="tcp_accept_no_cl">tcp_accept_no_cl</h3>
<div class="level3">

<p>
Control whether to throw or not error when there is no Content-Length header for requests received over TCP. It is required to be set to <strong>yes</strong> for XCAP traffic sent over HTTP/1.1 which does not use Content-Length header, but splits large bodies in many chunks. The module <strong>sanity</strong> can be used then to restrict this permission to HTTP traffic only, testing in route block in order to stay RFC3261 compliant about this mandatory header for SIP requests over TCP.
</p>

<p>
Default value is <strong>no</strong>.
</p>
<pre class="code c">tcp_accept_no_cl<span class="sy0">=</span>yes</pre>

</div>

<h3 class="sectionedit135" id="tcp_async">tcp_async</h3>
<div class="level3">

<p>
<strong>Alias name: tcp_buf_write</strong>
</p>

<p>
If enabled, all the tcp writes that would block / wait for connect to finish, will be queued and attempted latter (see also tcp_conn_wq_max and tcp_wq_max).
</p>

<p>
<strong>Note:</strong> It also applies for TLS.
</p>
<pre class="code">tcp_async = yes | no (default yes)</pre>

</div>

<h3 class="sectionedit136" id="tcp_children">tcp_children</h3>
<div class="level3">

<p>
Number of children processes to be created for reading from TCP connections. If no value is explicitly set, the same number of TCP children as UDP children (see ¡°children¡± parameter) will be used.
</p>

<p>
Example of usage:
</p>
<pre class="code">  tcp_children=4</pre>

</div>

<h3 class="sectionedit137" id="tcp_clone_rcvbuf">tcp_clone_rcvbuf</h3>
<div class="level3">

<p>
Control if the received buffer should be cloned from the TCP stream, needed by functions working inside the SIP message buffer (such as msg_apply_changes()).
</p>

<p>
Default is 0 (don&#039;t clone), set it to 1 for cloning.
</p>

<p>
Example of usage:
</p>
<pre class="code">  tcp_clone_rcvbuf=1</pre>

</div>

<h3 class="sectionedit138" id="tcp_connection_lifetime">tcp_connection_lifetime</h3>
<div class="level3">

<p>
Lifetime in seconds for TCP sessions. TCP sessions which are inactive for longer than <strong>tcp_connection_lifetime</strong> will be closed by sip-router. Default value is defined in tcp_conn.h: #define DEFAULT_TCP_CONNECTION_LIFETIME 120. Setting this value to 0 will close the TCP connection pretty quick <img src="/wiki/lib/images/smileys/icon_wink.gif" class="icon" alt=";-)" />.
</p>

<p>
Note: As many SIP clients are behind NAT/Firewalls, the SIP proxy should not close the TCP connection as it is not capable of opening a new one.
</p>

<p>
Example of usage:
</p>
<pre class="code">  tcp_connection_lifetime=3605</pre>

</div>

<h3 class="sectionedit139" id="tcp_connect_timeout">tcp_connect_timeout</h3>
<div class="level3">

<p>
Time in seconds before an ongoing attempt to establish a new TCP connection will be aborted. Lower this value for faster detection of TCP connection problems. The default value is 10s.
</p>

<p>
Example of usage:
</p>
<pre class="code">  tcp_connect_timeout=5</pre>

</div>

<h3 class="sectionedit140" id="tcp_conn_wq_max">tcp_conn_wq_max</h3>
<div class="level3">

<p>
Maximum bytes queued for write allowed per connection. Attempting to queue more bytes would result in an error and in the connection being closed (too slow). If tcp_async is not enabled, it has no effect.
</p>
<pre class="code">tcp_conn_wq_max = bytes (default 32 K)</pre>

</div>

<h3 class="sectionedit141" id="tcp_crlf_ping">tcp_crlf_ping</h3>
<div class="level3">

<p>
Enable SIP outbound TCP keep-alive using PING-PONG (CRLFCRLF -  CRLF).
</p>
<pre class="code">tcp_crlf_ping = yes | no default: yes)</pre>

</div>

<h3 class="sectionedit142" id="tcp_defer_accept">tcp_defer_accept</h3>
<div class="level3">

<p>
Tcp accepts will be delayed until some data is received (improves performance on proxies with lots of opened tcp connections). See linux tcp(7) TCP_DEFER_ACCEPT or freebsd ACCF_DATA(0). For now linux and freebsd only.
</p>

<p>
WARNING: the  linux TCP_DEFER_ACCEPT is buggy (?2.6.23) and doesn&#039;t work exactly as expected (if no data is received it will retransmit syn acks for ~ 190 s, irrespective of the set timeout and then it will silently drop the connection without sending a RST or FIN). Try to use it together with tcp_syncnt (this way the number of retrans. SYNACKs can be limited ? the timeout can be controlled in some way).
</p>

<p>
On FreeBSD:
</p>
<pre class="code">tcp_defer_accept =  yes | no (default no)</pre>

<p>
On Linux:
</p>
<pre class="code">tcp_defer_accept =  number of seconds before timeout (default disabled)</pre>

</div>

<h3 class="sectionedit143" id="tcp_delayed_ack">tcp_delayed_ack</h3>
<div class="level3">

<p>
Initial ACK for opened connections will be delayed and sent with the first data segment (see linux tcp(7) TCP_QUICKACK). For now linux only.
</p>
<pre class="code">tcp_delayed_ack  = yes | no (default yes when supported)</pre>

</div>

<h3 class="sectionedit144" id="tcp_fd_cache">tcp_fd_cache</h3>
<div class="level3">

<p>
If enabled FDs used for sending will be cached inside the process calling tcp_send (performance increase for sending over tcp at the cost of slightly slower connection closing and extra FDs kept open)
</p>
<pre class="code">tcp_fd_cache = yes | no (default yes)</pre>

</div>

<h3 class="sectionedit145" id="tcp_keepalive">tcp_keepalive</h3>
<div class="level3">

<p>
Enables keepalive for tcp (sets SO_KEEPALIVE socket option)
</p>
<pre class="code">tcp_keepalive = yes | no (default yes)</pre>

</div>

<h3 class="sectionedit146" id="tcp_keepcnt">tcp_keepcnt</h3>
<div class="level3">

<p>
Number of keepalives sent before dropping the connection (TCP_KEEPCNT socket option). Linux only.
</p>
<pre class="code">tcp_keepcnt = number (not set by default)</pre>

</div>

<h3 class="sectionedit147" id="tcp_keepidle">tcp_keepidle</h3>
<div class="level3">

<p>
Time before starting to send keepalives, if the connection is idle (TCP_KEEPIDLE socket option). Linux only.
</p>
<pre class="code">tcp_keepidle  = seconds (not set by default)</pre>

</div>

<h3 class="sectionedit148" id="tcp_keepintvl">tcp_keepintvl</h3>
<div class="level3">

<p>
Time interval between keepalive probes, when the previous probe failed (TCP_KEEPINTVL socket option). Linux only.
</p>
<pre class="code">tcp_keepintvl = seconds (not set by default)</pre>

</div>

<h3 class="sectionedit149" id="tcp_linger2">tcp_linger2</h3>
<div class="level3">

<p>
Lifetime of orphaned sockets in FIN_WAIT2 state (overrides tcp_fin_timeout on, see linux tcp(7) TCP_LINGER2). Linux only.
</p>
<pre class="code">tcp_linger2 = seconds (not set by default)</pre>

</div>

<h3 class="sectionedit150" id="tcp_max_connections">tcp_max_connections</h3>
<div class="level3">

<p>
Maximum number of tcp connections (if the number is exceeded no new tcp connections will be accepted). Default is defined in tcp_conn.h: #define DEFAULT_TCP_MAX_CONNECTIONS 2048
</p>

<p>
Example of usage:
</p>
<pre class="code">  tcp_max_connections=4096</pre>

</div>

<h3 class="sectionedit151" id="tcp_no_connect">tcp_no_connect</h3>
<div class="level3">

<p>
Stop outgoing TCP connects (also stops TLS) by setting tcp_no_connect to yes. You can do this any time, even even if sip-router is already started (in this case using sercmd cfg.set_now_int tcp no_connect 1).
</p>

</div>

<h3 class="sectionedit152" id="tcp_poll_method">tcp_poll_method</h3>
<div class="level3">

<p>
Poll method used (by default the best one for the current <abbr title="Operating System">OS</abbr> is selected). For available types see io_wait.c and poll_types.h: none, poll, epoll_lt, epoll_et, sigio_rt, select, kqueue, /dev/poll
</p>

<p>
Example of usage:
</p>
<pre class="code">  tcp_poll_method=select</pre>

</div>

<h3 class="sectionedit153" id="tcp_rd_buf_size">tcp_rd_buf_size</h3>
<div class="level3">

<p>
Buffer size used for tcp reads. A high buffer size increases performance on server with few connections and lot of traffic on them, but also increases memory consumption (so for lots of connection is better to use a low value). Note also that this value limits the maximum message size (SIP, HTTP) that can be received over tcp. 
</p>

<p>
The value is internally limited to 16MByte, for higher values recompile Kamailio with higher limit in tcp_options.c (search for ¡°rd_buf_size¡± and 16777216). Further, you may need to increase the private memory, and if you process the message stateful you may also have to increase the shared memory.
</p>

<p>
Default: 4096, can be changed at runtime.
</p>
<pre class="code c">tcp_rd_buf_size<span class="sy0">=</span><span class="nu0">65536</span></pre>

</div>

<h3 class="sectionedit154" id="tcp_send_timeout">tcp_send_timeout</h3>
<div class="level3">

<p>
Time in seconds after a TCP connection will be closed if it is not available for writing in this interval (and sip-router wants to send something on it). Lower this value for faster detection of broken TCP connections. The default value is 10s.
</p>

<p>
Example of usage:
</p>
<pre class="code">  tcp_send_timeout=3</pre>

</div>

<h3 class="sectionedit155" id="tcp_source_ipv4_tcp_source_ipv6">tcp_source_ipv4, tcp_source_ipv6</h3>
<div class="level3">

<p>
Set the source IP for all outbound TCP connections. If setting of the IP fails, the TCP connection will use the default IP address.
</p>
<pre class="code">tcp_source_ipv4 = IPv4 address
tcp_source_ipv6 = IPv6 address</pre>

</div>

<h3 class="sectionedit156" id="tcp_syncnt">tcp_syncnt</h3>
<div class="level3">

<p>
Number of SYN retransmissions before aborting a connect attempt (see linux tcp(7) TCP_SYNCNT). Linux only.
</p>
<pre class="code">tcp_syncnt = number of syn retr. (default not set)</pre>

</div>

<h3 class="sectionedit157" id="tcp_wq_blk_size">tcp_wq_blk_size</h3>
<div class="level3">

<p>
Block size used for tcp async writes. It should be big enough to hold a few datagrams. If it&#039;s smaller then a datagram (in fact a tcp write()) size, it will be rounded up. It has no influenced on the number of datagrams queued (for that see tcp_conn_wq_max or tcp_wq_max). It has mostly debugging and testing value (can be ignored).
</p>

<p>
Default: 2100 (~ 2 INVITEs), can be changed at runtime.
</p>

</div>

<h3 class="sectionedit158" id="tcp_wq_max">tcp_wq_max</h3>
<div class="level3">

<p>
Maximum bytes queued for write allowed globally. It has no effect if tcp_async is not enabled.
</p>
<pre class="code">tcp_wq_max = bytes (default 10 Mb)</pre>

</div>

<h2 class="sectionedit159" id="tls_parameters">TLS Parameters</h2>
<div class="level2">

<p>
Most of TLS layer attributes can be configured via TLS module parameters.
</p>

</div>

<h3 class="sectionedit160" id="tls_port_no">tls_port_no</h3>
<div class="level3">

<p>
The port the SIP server listens to for TLS connections.
</p>

<p>
Default value is 5061.
</p>

<p>
Example of usage:
</p>
<pre class="code">  tls_port_no=6061</pre>

</div>

<h3 class="sectionedit161" id="tls_max_connections">tls_max_connections</h3>
<div class="level3">

<p>
Maximum number of ls connections (if the number is exceeded no new ls connections will be accepted). It cannot exceed tcp_max_connections.
</p>

<p>
Default value is 2048.
</p>

<p>
Example of usage:
</p>
<pre class="code">  tls_max_connections=4096</pre>

</div>

<h2 class="sectionedit162" id="sctp_parameters">SCTP Parameters</h2>
<div class="level2">

</div>

<h3 class="sectionedit163" id="disable_sctp">disable_sctp</h3>
<div class="level3">

<p>
Global parameter to disable SCTP support in the SIP server. see enable_sctp
</p>

<p>
Default value is &#039;auto&#039;.
</p>

<p>
Example of usage:
</p>
<pre class="code">  disable_sctp=yes</pre>

</div>

<h3 class="sectionedit164" id="enable_sctp">enable_sctp</h3>
<div class="level3">
<pre class="code">enable_sctp = 0/1/2  - SCTP disabled (0)/ SCTP enabled (1)/auto (2), 
                       default auto (2)</pre>

</div>

<h3 class="sectionedit165" id="sctp_children">sctp_children</h3>
<div class="level3">

<p>
sctp children no (similar to udp children)
</p>
<pre class="code">sctp_children = number </pre>

</div>

<h3 class="sectionedit166" id="sctp_socket_rcvbuf">sctp_socket_rcvbuf</h3>
<div class="level3">

<p>
Size for the sctp socket receive buffer
</p>

<p>
<strong>Alias name: sctp_socket_receive_buffer</strong>
</p>
<pre class="code">sctp_socket_rcvbuf = number </pre>

</div>

<h3 class="sectionedit167" id="sctp_socket_sndbuf">sctp_socket_sndbuf</h3>
<div class="level3">

<p>
Size for the sctp socket send buffer
</p>

<p>
<strong>Alias name: sctp_socket_send_buffer</strong>
</p>
<pre class="code">sctp_socket_sndbuf = number</pre>

</div>

<h3 class="sectionedit168" id="sctp_autoclose">sctp_autoclose</h3>
<div class="level3">

<p>
Number of seconds before autoclosing an idle association (default: 180 s). Can be changed at runtime, but it will affect only new associations. E.g.:
</p>
<pre class="code">$ sercmd cfg.set_now_int sctp autoclose 120</pre>
<pre class="code">sctp_autoclose = seconds</pre>

</div>

<h3 class="sectionedit169" id="sctp_send_ttl">sctp_send_ttl</h3>
<div class="level3">

<p>
Number of milliseconds before an unsent message/chunk is dropped (default: 32000 ms or 32 s). Can be changed at runtime, e.g.:
</p>
<pre class="code">$ sercmd cfg.set_now_int sctp send_ttl 180000</pre>
<pre class="code">sctp_send_ttl = milliseconds - n</pre>

</div>

<h3 class="sectionedit170" id="sctp_send_retries">sctp_send_retries</h3>
<div class="level3">

<p>
How many times to attempt re-sending a message on a re-opened association, if the sctp stack did give up sending it (it&#039;s not related to sctp protocol level retransmission). Useful to improve reliability with peers that reboot/restart or fail over to another machine. 
</p>

<p>
WARNING: use with care and low values (e.g. 1-3) to avoid ¡°multiplying¡± traffic to unresponding hosts (default: 0).Can be changed at runtime.
</p>
<pre class="code">sctp_send_retries = 1</pre>

</div>

<h3 class="sectionedit171" id="sctp_assoc_tracking">sctp_assoc_tracking</h3>
<div class="level3">

<p>
Controls whether or not sctp associations are tracked inside ser/sip-router. Turning it off would result in less memory being used and slightly better performance, but it will also disable some other features that depend on it (e.g. sctp_assoc_reuse). Default: yes.
</p>

<p>
Can be changed at runtime (sercmd sctp assoc_tracking 0), but changes will be allowed only if all the other features that depend on it are turned off (for example it can be turned off only if first sctp_assoc_reuse was turned off).
</p>

<p>
Note: turning sctp_assoc_tracking on/off will delete all the tracking information for all the currently tracked associations and might introduce a small temporary delay in the sctp processing if lots of associations were tracked.
</p>

<p>
Config options depending on sctp_assoc_tracking being on: sctp_assoc_reuse.
</p>
<pre class="code">sctp_assoc_tracking = yes/no</pre>

</div>

<h3 class="sectionedit172" id="sctp_assoc_reuse">sctp_assoc_reuse</h3>
<div class="level3">

<p>
Controls sctp association reuse. For now only association reuse for replies is affected by it. Default: yes.
Depends on sctp_assoc_tracking being on. 
</p>

<p>
Note that even if turned off, if the port in via corresponds to the source port of the association the request was sent on or if rport is turned on (force_rport() or via containing a rport option), the association will be automatically reused by the sctp stack.
Can be changed at runtime (sctp assoc_reuse), but it can be turned on only if sctp_assoc_tracking is on.
</p>
<pre class="code">sctp_assoc_reuse = yes/no</pre>

</div>

<h3 class="sectionedit173" id="sctp_max_assocs">sctp_max_assocs</h3>
<div class="level3">

<p>
Maximum number of allowed open sctp associations. -1 means maximum allowed by the <abbr title="Operating System">OS</abbr>. Default: -1.
Can be changed at runtime (e.g.:  sercmd cfg.set_now_int sctp max_assocs 10 ). When the maximum associations number is exceeded and a new associations is opened by a remote host, the association will be immediately closed. However it is possible that some sip packets get through (especially if they are sent early, as part of the 4-way handshake).
</p>

<p>
When ser/sip-router tries to open a new association and the max_assocs is exceeded the exact behaviour depends on whether or not
sctp_assoc_tracking is on. If on, the send triggering the active open will gracefully fail, before actually opening the new association and no packet will be sent. However if sctp_assoc_tracking is off, the association will first be opened and then immediately closed. In general this means that the initial sip packet will be sent (as part of the 4-way handshake).
</p>
<pre class="code">sctp_max_assocs = number</pre>

</div>

<h3 class="sectionedit174" id="sctp_srto_initial">sctp_srto_initial</h3>
<div class="level3">

<p>
Initial value of the retr. timeout, used in RTO calculations (default: <abbr title="Operating System">OS</abbr> specific). 
</p>

<p>
Can be changed at runtime (sctp srto_initial) but it will affect only new associations.
</p>
<pre class="code">sctp_srto_initial = milliseconds</pre>

</div>

<h3 class="sectionedit175" id="sctp_srto_max">sctp_srto_max</h3>
<div class="level3">

<p>
Maximum value of the retransmission timeout (RTO) (default: <abbr title="Operating System">OS</abbr> specific).
</p>

<p>
WARNING: values lower then the sctp sack_delay will cause lots of retransmissions and connection instability (see sctp_srto_min for more details).
</p>

<p>
Can be changed at runtime (sctp srto_max) but it will affect only new associations.
</p>
<pre class="code">sctp_srto_max = milliseconds</pre>

</div>

<h3 class="sectionedit176" id="sctp_srto_min">sctp_srto_min</h3>
<div class="level3">

<p>
Minimum value of the retransmission timeout (RTO) (default: <abbr title="Operating System">OS</abbr> specific).
</p>

<p>
WARNING: values lower then the sctp sack_delay of any peer might cause retransmissions and possible interoperability problems. According to the standard the sack_delay should be between 200 and 500 ms, so avoid trying values lower then 500 ms unless you control all the possible sctp peers and you do make sure their sack_delay is higher or their sack_freq is 1.
</p>

<p>
Can be changed at runtime (sctp srto_min) but it will affect only new associations.
</p>
<pre class="code">sctp_srto_min = milliseconds</pre>

</div>

<h3 class="sectionedit177" id="sctp_asocmaxrxt">sctp_asocmaxrxt</h3>
<div class="level3">

<p>
Maximum retransmissions attempts per association (default: <abbr title="Operating System">OS</abbr> specific). It should be set to sctp_pathmaxrxt * no. of expected paths.
</p>

<p>
Can be changed at runtime (sctp asocmaxrxt) but it will affect only new associations.
</p>
<pre class="code">sctp_asocmaxrxt   = number</pre>

</div>

<h3 class="sectionedit178" id="sctp_init_max_attempts">sctp_init_max_attempts</h3>
<div class="level3">

<p>
Maximum INIT retransmission attempts (default: <abbr title="Operating System">OS</abbr> specific).
</p>

<p>
Can be changed at runtime (sctp init_max_attempts).
</p>
<pre class="code">sctp_init_max_attempts = number</pre>

</div>

<h3 class="sectionedit179" id="sctp_init_max_timeo">sctp_init_max_timeo</h3>
<div class="level3">

<p>
Maximum INIT retransmission timeout (RTO max for INIT). Default: <abbr title="Operating System">OS</abbr> specific.
</p>

<p>
Can be changed at runtime (sctp init_max_timeo).
</p>
<pre class="code">sctp_init_max_timeo = milliseconds</pre>

</div>

<h3 class="sectionedit180" id="sctp_hbinterval">sctp_hbinterval</h3>
<div class="level3">

<p>
sctp heartbeat interval. Setting it to -1 will disable the heartbeats. Default: <abbr title="Operating System">OS</abbr> specific.
</p>

<p>
Can be changed at runtime (sctp hbinterval) but it will affect only new associations.
</p>
<pre class="code">sctp_hbinterval = milliseconds</pre>

</div>

<h3 class="sectionedit181" id="sctp_pathmaxrxt">sctp_pathmaxrxt</h3>
<div class="level3">

<p>
Maximum retransmission attempts per path (see also sctp_asocmaxrxt). Default: <abbr title="Operating System">OS</abbr> specific.
</p>

<p>
Can be changed at runtime (sctp pathmaxrxt) but it will affect only new associations.
</p>
<pre class="code">sctp_pathmaxrxt = number</pre>

</div>

<h3 class="sectionedit182" id="sctp_sack_delay">sctp_sack_delay</h3>
<div class="level3">

<p>
Delay until an ACK is generated after receiving a packet. Default: <abbr title="Operating System">OS</abbr> specific.
</p>

<p>
WARNING: a value higher then srto_min can cause a lot of retransmissions (and strange problems). A value higher then srto_max will result in very high connections instability. According to the standard the sack_delay value should be between 200 and 500 ms.
</p>

<p>
Can be changed at runtime (sctp sack_delay) but it will affect only new associations.
</p>
<pre class="code">sctp_sack_delay = milliseconds</pre>

</div>

<h3 class="sectionedit183" id="sctp_sack_freq">sctp_sack_freq</h3>
<div class="level3">

<p>
Number of packets received before an ACK is sent (without waiting for the sack_delay to expire).  Default: <abbr title="Operating System">OS</abbr> specific. 
</p>

<p>
Note: on linux with lksctp up to and including 1.0.9 is not possible to set this value (having it in the config will produce a warning on startup).
</p>

<p>
Can be changed at runtime (sctp sack_freq) but it will affect only new associations.
</p>
<pre class="code">sctp_sack_freq = number</pre>

</div>

<h3 class="sectionedit184" id="sctp_max_burst">sctp_max_burst</h3>
<div class="level3">

<p>
Maximum burst of packets that can be emitted by an association. Default: <abbr title="Operating System">OS</abbr> specific.
</p>

<p>
Can be changed at runtime (sctp max_burst) but it will affect only new associations.
</p>
<pre class="code">sctp_max_burst = number</pre>

</div>

<h2 class="sectionedit185" id="udp_parameters">UDP Parameters</h2>
<div class="level2">

</div>

<h3 class="sectionedit186" id="udp4_raw">udp4_raw</h3>
<div class="level3">

<p>
Enables raw socket support for sending UDP IPv4 datagrams (40-50% performance increase on linux multi-cpu).
</p>

<p>
Possible values: 0 - disabled (default), 1 - enabled, -1 auto.
</p>

<p>
In ¡°auto¡± mode it will be enabled if possible (sr started as root or with CAP_NET_RAW). udp4_raw can be used on Linux and FreeBSD. For other BSDs and Darwin one must compile with -DUSE_RAW_SOCKS. On Linux one should also set udp4_raw_mtu if the MTU on any network interface that could be used for sending is smaller then 1500.
</p>

<p>
The parameter can be set at runtime as long as sr was started with enough privileges (core.udp4_raw).
</p>
<pre class="code">udp4_raw = on</pre>

</div>

<h3 class="sectionedit187" id="udp4_raw_mtu">udp4_raw_mtu</h3>
<div class="level3">

<p>
MTU value used for UDP IPv4 packets when udp4_raw is enabled.  It should be set to the minimum MTU of all the network interfaces that could be used for sending. The default value is 1500. Note that on BSDs it does not need to be set (if set it will be ignored, the proper MTU will be used automatically by the kernel). On Linux it should be set.
</p>

<p>
The parameter can be set at runtime (core.udp4_raw_mtu).
</p>

</div>

<h3 class="sectionedit188" id="udp4_raw_ttl">udp4_raw_ttl</h3>
<div class="level3">

<p>
TTL value used for UDP IPv4 packets when udp4_raw is enabled. By default it is set to auto mode (-1), meaning that the same TTL will be used as for normal UDP sockets.
</p>

<p>
The parameter can be set at runtime (core.udp4_raw_ttl).
</p>

</div>

<h2 class="sectionedit189" id="blacklist_parameters">Blacklist Parameters</h2>
<div class="level2">

</div>

<h3 class="sectionedit190" id="dst_blacklist_expire">dst_blacklist_expire</h3>
<div class="level3">

<p>
<strong>Alias name: dst_blacklist_ttl</strong>
</p>

<p>
How much time a blacklisted destination will be kept in the blacklist (w/o any update).
</p>
<pre class="code">dst_blacklist_expire = time in s (default 60 s)</pre>

</div>

<h3 class="sectionedit191" id="dst_blacklist_gc_interval">dst_blacklist_gc_interval</h3>
<div class="level3">

<p>
How often the garbage collection will run (eliminating old, expired entries).
</p>
<pre class="code">dst_blacklist_gc_interval = time in s (default 60 s)</pre>

</div>

<h3 class="sectionedit192" id="dst_blacklist_init">dst_blacklist_init</h3>
<div class="level3">

<p>
If off, the blacklist is not initialized at startup and cannot be enabled runtime, that saves some memory.
</p>
<pre class="code">dst_blacklist_init = on | off (default on)</pre>

</div>

<h3 class="sectionedit193" id="dst_blacklist_mem">dst_blacklist_mem</h3>
<div class="level3">

<p>
Maximum shared memory amount used for keeping the blacklisted destinations.
</p>
<pre class="code">dst_blacklist_mem = size in Kb (default 250 Kb)</pre>

</div>

<h3 class="sectionedit194" id="use_dst_blacklist">use_dst_blacklist</h3>
<div class="level3">

<p>
Enable the destination blacklist: Each failed send attempt will cause the destination to be added to the blacklist. Before any send, this blacklist will be checked and if a match is found, the send is no longer attempted (an error is returned immediately). 
</p>

<p>
Note: using the blacklist incurs a small performance penalty.
</p>

<p>
See also doc/dst_blacklist.txt.
</p>
<pre class="code">use_dst_blacklist = on | off (default off)</pre>

</div>

<h2 class="sectionedit195" id="real-time_parameters">Real-Time Parameters</h2>
<div class="level2">

</div>

<h3 class="sectionedit196" id="real_time">real_time</h3>
<div class="level3">

<p>
Sets real time priority for all the ser processes, or the timers (bitmask). 
</p>
<pre class="code">   Possible values:   0  - off
                      1  - the &quot;fast&quot; timer
                      2  - the &quot;slow&quot; timer
                      4  - all processes, except the timers
   Example: real_time= 7 =&gt; everything switched to real time priority.</pre>
<pre class="code">real_time = &lt;int&gt; (flags) (default off)</pre>

</div>

<h3 class="sectionedit197" id="rt_policy">rt_policy</h3>
<div class="level3">

<p>
Real time scheduling policy, 0 = SCHED_OTHER, 1= SCHED_RR and 2=SCHED_FIFO
</p>
<pre class="code">rt_policy= &lt;0..3&gt; (default 0)</pre>

</div>

<h3 class="sectionedit198" id="rt_prio">rt_prio</h3>
<div class="level3">

<p>
Real time priority used for everything except the timers, if real_time is enabled.
</p>
<pre class="code">rt_prio = &lt;int&gt; (default 0)</pre>

</div>

<h3 class="sectionedit199" id="rt_timer1_policy">rt_timer1_policy</h3>
<div class="level3">

<p>
<strong>Alias name: rt_ftimer_policy</strong>
</p>

<p>
Like rt_policy but for the ¡°fast¡± timer.
</p>
<pre class="code">rt_timer1_policy=&lt;0..3&gt; (default 0)</pre>

</div>

<h3 class="sectionedit200" id="rt_timer1_prio">rt_timer1_prio</h3>
<div class="level3">

<p>
<strong>Alias name: rt_fast_timer_prio, rt_ftimer_prio</strong>
</p>

<p>
Like rt_prio but for the ¡°fast¡± timer process (if real_time &amp; 1).
</p>
<pre class="code">   
rt_timer1_prio=&lt;int&gt; (default 0)</pre>

</div>

<h3 class="sectionedit201" id="rt_timer2_policy">rt_timer2_policy</h3>
<div class="level3">

<p>
<strong>Alias name: rt_stimer_policy</strong>
</p>

<p>
Like rt_policy but for the ¡°slow¡± timer.
</p>
<pre class="code">rt_timer2_policy=&lt;0..3&gt; (default 0)</pre>

</div>

<h3 class="sectionedit202" id="rt_timer2_prio">rt_timer2_prio</h3>
<div class="level3">

<p>
<strong>Alias name: rt_stimer_prio</strong>
</p>

<p>
Like rt_prio but for the ¡°slow¡± timer.
</p>
<pre class="code">rt_timer2_prio=&lt;int&gt; (default 0)</pre>

</div>

<h2 class="sectionedit203" id="core_functions">Core functions</h2>
<div class="level2">

<p>
Functions exported by core that can be used in route blocks.
</p>

</div>

<h3 class="sectionedit204" id="add_local_rport">add_local_rport</h3>
<div class="level3">

<p>
Add <strong>rport</strong> parameter to local generated Via header ¨C see RFC3581. In effect for forwarded SIP requests.
</p>

<p>
Example of usage:
</p>
<pre class="code c">add_local_rport<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

</div>

<h3 class="sectionedit205" id="avpflags">avpflags</h3>
<div class="level3">

</div>

<h3 class="sectionedit206" id="break">break</h3>
<div class="level3">

<p>
&#039;break&#039; statement can be used to end a &#039;case&#039; block in a &#039;switch&#039; statement or exit from a &#039;while&#039; statement.
</p>

</div>

<h3 class="sectionedit207" id="drop">drop</h3>
<div class="level3">

<p>
Stop the execution of the configuration script and alter the implicit action which is done afterwards.
</p>

<p>
If the function is called in a &#039;branch_route&#039; then the branch is discarded (implicit action for &#039;branch_route&#039; is to forward the request).
</p>

<p>
If the function is called in the default &#039;onreply_route&#039; then you can drop any response. If the function is called in a named &#039;onreply_route&#039; (transaction stateful) then any provisional reply is discarded. (Implicit action for &#039;onreply_route&#039; is to send the reply upstream according to Via header.)
</p>

<p>
Example of usage:
</p>
<pre class="code">  onreply_route {
      if(status==&quot;200&quot;) {
          drop(); # this works
      }
  }</pre>
<pre class="code">  onreply_route[FOOBAR] {
      if(status==&quot;200&quot;) {
          drop(); # this is ignored
      }
  }</pre>

</div>

<h3 class="sectionedit208" id="exit">exit</h3>
<div class="level3">

<p>
Stop the execution of the configuration script ¨C it has the same behaviour as return(0). It does not affect the implicit action to be taken after script execution. 
</p>
<pre class="code">route {
  if (route(2)) {
    xlog(&quot;L_NOTICE&quot;,&quot;method $rm is INVITE\n&quot;);
  } else {
    xlog(&quot;L_NOTICE&quot;,&quot;method is $rm\n&quot;);
  };
}</pre>
<pre class="code">route[2] {
  if (is_method(&quot;INVITE&quot;)) {
    return(1);
  } else if (is_method(&quot;REGISTER&quot;)) {
    return(-1);
  } else if (is_method(&quot;MESSAGE&quot;)) {
    sl_send_reply(&quot;403&quot;,&quot;IM not allowed&quot;);
    exit;
  };
}</pre>

</div>

<h3 class="sectionedit209" id="error">error</h3>
<div class="level3">

</div>

<h3 class="sectionedit210" id="exec">exec</h3>
<div class="level3">

</div>

<h3 class="sectionedit211" id="force_rport1">force_rport</h3>
<div class="level3">

<p>
Force_rport() adds the rport parameter to the first Via header of the received message. Thus, sip-router will add the received  port to the top most via header in the SIP message, even if the client does not indicate support for rport. This enables subsequent SIP messages to return to the proper port later on in a SIP transaction.
</p>

<p>
This is useful for NAT traversal, to enforce symmetric response signaling.
</p>

<p>
The rport parameter is defined in <abbr title="Request for Comments">RFC</abbr> 3581.
</p>

<p>
Note: there is also a force_rport parameter which changes the gobal behavior of the SIP proxy.
</p>

<p>
Example of usage:
</p>
<pre class="code">  force_rport();</pre>

</div>

<h3 class="sectionedit212" id="add_rport">add_rport</h3>
<div class="level3">

<p>
Alias for force_rport();
</p>

</div>

<h3 class="sectionedit213" id="force_send_socket">force_send_socket</h3>
<div class="level3">

<p>
Force to send the message from the specified socket (it _must_ be one of the sockets specified with the ¡°listen¡± directive). If the protocol doesn&#039;t match (e.g. UDP message ¡°forced¡± to a TCP socket) the closest socket of the same protocol is used.
</p>

<p>
Example of usage:
</p>
<pre class="code">  force_send_socket(10.10.10.10:5060);</pre>

</div>

<h3 class="sectionedit214" id="force_tcp_alias">force_tcp_alias</h3>
<div class="level3">

<p>
<strong>Alias name: add_tcp_alias</strong>
</p>

<p>
force_tcp_alias(port)      
</p>

<p>
adds a tcp port alias for the current connection (if tcp).
Usefull if you want to send all the trafic to port_alias through
the same connection this request came from [it could help 
for firewall or nat traversal].
With no parameters adds the port from the message via as the alias.
When the ¡°aliased¡± connection is closed (e.g. it&#039;s idle for too
much time), all the port aliases are removed.
</p>

</div>

<h3 class="sectionedit215" id="forward">forward</h3>
<div class="level3">

<p>
Forward the SIP request to destination stored in $du in stateless mode.
</p>

<p>
Example of usage:
</p>
<pre class="code">  $du = &quot;sip:10.0.0.10:5060;transport=tcp&quot;;
  forward();</pre>

</div>

<h3 class="sectionedit216" id="isavpflagset">isavpflagset</h3>
<div class="level3">

</div>

<h3 class="sectionedit217" id="isflagset">isflagset</h3>
<div class="level3">

<p>
Test if a flag is set for current processed message (if the flag value is 1). The value of the parameter can be in range of 0..31.
</p>

<p>
For more see <a href="http://www.kamailio.org/dokuwiki/doku.php/tutorials:openser-flag-operations" class="urlextern" title="http://www.kamailio.org/dokuwiki/doku.php/tutorials:openser-flag-operations"  rel="nofollow">http://www.kamailio.org/dokuwiki/doku.php/tutorials:openser-flag-operations</a> or <a href="/wiki/utils/flags" class="wikilink2" title="utils:flags" rel="nofollow">flags</a>.
</p>

<p>
Example of usage:
</p>
<pre class="code">  if(isflagset(3)) {
      log(&quot;flag 3 is set\n&quot;);
  };</pre>

<p>
SIP-Router also supports named flags. They have to be declared at the beginning of the config file with:
</p>
<pre class="code"> flags  flag1_name[:position],  flag2_name ...</pre>

<p>
Example:
</p>
<pre class="code">     flags test, a:1, b:2 ;
     route{
            setflag(test);
            if (isflagset(a)){ # equiv. to isflagset(1)
              ....
            }
            resetflag(b);  # equiv. to resetflag(2) </pre>

</div>

<h3 class="sectionedit218" id="is_int">is_int</h3>
<div class="level3">

<p>
Checks if a pseudo variable argument contains integer value. 
</p>
<pre class="code">if(is_int(&quot;$avp(foobar)&quot;)) {
  log(&quot;foobar contains an integer\n&quot;);
}</pre>

</div>

<h3 class="sectionedit219" id="log">log</h3>
<div class="level3">

<p>
Write text message to standard error terminal or syslog. You can specify the log level as first parameter.
</p>

<p>
For more see: <a href="http://www.kamailio.org/dokuwiki/doku.php/tutorials:debug-syslog-messages" class="urlextern" title="http://www.kamailio.org/dokuwiki/doku.php/tutorials:debug-syslog-messages"  rel="nofollow">http://www.kamailio.org/dokuwiki/doku.php/tutorials:debug-syslog-messages</a>
</p>

<p>
Example of usage:
</p>
<pre class="code">  log(&quot;just some text message\n&quot;);</pre>

</div>

<h3 class="sectionedit220" id="prefix">prefix</h3>
<div class="level3">

<p>
Add the string parameter in front of username in R-<abbr title="Uniform Resource Identifier">URI</abbr>.
</p>

<p>
Example of usage:
</p>
<pre class="code">  prefix(&quot;00&quot;);</pre>

</div>

<h3 class="sectionedit221" id="resetavpflag">resetavpflag</h3>
<div class="level3">

</div>

<h3 class="sectionedit222" id="resetflag">resetflag</h3>
<div class="level3">

</div>

<h3 class="sectionedit223" id="return">return</h3>
<div class="level3">

<p>
The return() function allows you to return any integer value from a called route() block.
You can test the value returned by a route using <a href="/wiki/cookbooks/4.2.x/devel#retcode" class="wikilink2" title="cookbooks:4.2.x:devel" rel="nofollow">$retcode</a> or $? variable.
</p>

<p>
return(0) is same as <a href="/wiki/cookbooks/4.2.x/devel#exit" class="wikilink2" title="cookbooks:4.2.x:devel" rel="nofollow">exit()</a>;
</p>

<p>
In bool expressions:
</p>
<ul>
<li class="level1"><div class="li"> Negative is FALSE</div>
</li>
<li class="level1"><div class="li"> Positive is TRUE</div>
</li>
</ul>

<p>
If no value is specified, or a route reaches its end without executing a return statement, it returns 1. If return is used in the top level route is equivalent with exit [val].
</p>

<p>
Example usage: 
</p>
<pre class="code">route {
  if (route(2)) {
    xlog(&quot;L_NOTICE&quot;,&quot;method $rm is INVITE\n&quot;);
  } else {
    xlog(&quot;L_NOTICE&quot;,&quot;method $rm is REGISTER\n&quot;);
  };
}</pre>
<pre class="code">route[2] {
  if (is_method(&quot;INVITE&quot;)) {
    return(1);
  } else if (is_method(&quot;REGISTER&quot;)) {
    return(-1);
  } else {
    return(0);
  };
}</pre>

</div>

<h3 class="sectionedit224" id="revert_uri">revert_uri</h3>
<div class="level3">

<p>
Set the R-<abbr title="Uniform Resource Identifier">URI</abbr> to the value of the R-<abbr title="Uniform Resource Identifier">URI</abbr> as it was when the request was received by server (undo all changes of R-<abbr title="Uniform Resource Identifier">URI</abbr>).
</p>

<p>
Example of usage:
</p>
<pre class="code">  revert_uri();</pre>

</div>

<h3 class="sectionedit225" id="rewritehostport">rewritehostport</h3>
<div class="level3">

<p>
<strong>Alias name: sethostport, sethp</strong>
</p>

<p>
Rewrite the domain part and port of the R-<abbr title="Uniform Resource Identifier">URI</abbr> with the value of function&#039;s parameter. Other parts of the R-<abbr title="Uniform Resource Identifier">URI</abbr> like username and <abbr title="Uniform Resource Identifier">URI</abbr> parameters remain unchanged.
</p>

<p>
Example of usage:
</p>
<pre class="code">  rewritehostport(&quot;1.2.3.4:5080&quot;);</pre>

</div>

<h3 class="sectionedit226" id="rewritehostporttrans">rewritehostporttrans</h3>
<div class="level3">

<p>
<strong>Alias name: sethostporttrans, sethpt</strong>
</p>

<p>
Rewrite the domain part and port of the R-<abbr title="Uniform Resource Identifier">URI</abbr> with the value of function&#039;s parameter. Also allows to specify the transport parameter. Other parts of the R-<abbr title="Uniform Resource Identifier">URI</abbr> like username and <abbr title="Uniform Resource Identifier">URI</abbr> parameters remain unchanged.
</p>

<p>
Example of usage:
</p>
<pre class="code">  rewritehostporttrans(&quot;1.2.3.4:5080&quot;);</pre>

</div>

<h3 class="sectionedit227" id="rewritehost">rewritehost</h3>
<div class="level3">

<p>
<strong>Alias name: sethost, seth</strong>
</p>

<p>
Rewrite the domain part of the R-<abbr title="Uniform Resource Identifier">URI</abbr> with the value of function&#039;s parameter. Other parts of the R-<abbr title="Uniform Resource Identifier">URI</abbr> like username, port and <abbr title="Uniform Resource Identifier">URI</abbr> parameters remain unchanged.
</p>

<p>
Example of usage:
</p>
<pre class="code">  rewritehost(&quot;1.2.3.4&quot;);</pre>

</div>

<h3 class="sectionedit228" id="rewriteport">rewriteport</h3>
<div class="level3">

<p>
<strong>Alias name: setport, setp</strong>
</p>

<p>
Rewrites/sets the port part of the R-<abbr title="Uniform Resource Identifier">URI</abbr> with the value of function&#039;s parameter.
</p>

<p>
Example of usage:
</p>
<pre class="code">  rewriteport(&quot;5070&quot;);</pre>

</div>

<h3 class="sectionedit229" id="rewriteuri">rewriteuri</h3>
<div class="level3">

<p>
<strong>Alias name: seturi</strong>
</p>

<p>
Rewrite the request <abbr title="Uniform Resource Identifier">URI</abbr>.
</p>

<p>
Example of usage:
</p>
<pre class="code">  rewriteuri(&quot;sip:test@openser.org&quot;);</pre>

</div>

<h3 class="sectionedit230" id="rewriteuserpass">rewriteuserpass</h3>
<div class="level3">

<p>
<strong>Alias name: setuserpass, setup</strong>
</p>

<p>
Rewrite the password part of the R-<abbr title="Uniform Resource Identifier">URI</abbr> with the value of function&#039;s parameter.
</p>

<p>
Example of usage:
</p>
<pre class="code">  rewriteuserpass(&quot;my_secret_passwd&quot;);</pre>

</div>

<h3 class="sectionedit231" id="rewriteuser">rewriteuser</h3>
<div class="level3">

<p>
<strong>Alias name: setuser, setu</strong>
</p>

<p>
Rewrite the user part of the R-<abbr title="Uniform Resource Identifier">URI</abbr> with the value of function&#039;s parameter.
</p>

<p>
Example of usage:
</p>
<pre class="code">  rewriteuser(&quot;newuser&quot;);</pre>

</div>

<h3 class="sectionedit232" id="route">route</h3>
<div class="level3">

<p>
Execute route block given in parameter.  Parameter may be name of the block or a string valued expression.
</p>

<p>
Examples of usage:
</p>
<pre class="code">  route(REGISTER_REQUEST);
  route(@received.proto + &quot;_proto_&quot; + $var(route_set));</pre>

</div>

<h3 class="sectionedit233" id="set_advertised_address">set_advertised_address</h3>
<div class="level3">

<p>
Same as &#039;advertised_address&#039; but it affects only the current message. It has priority if &#039;advertised_address&#039; is also set.
</p>

<p>
Example of usage:
</p>
<pre class="code">  set_advertised_address(&quot;openser.org&quot;);</pre>

</div>

<h3 class="sectionedit234" id="set_advertised_port">set_advertised_port</h3>
<div class="level3">

<p>
Same as &#039;advertised_port&#039; but it affects only the current message. It has priority over &#039;advertised_port&#039;.
</p>

<p>
Example of usage:
</p>
<pre class="code">  set_advertised_port(5080);</pre>

</div>

<h3 class="sectionedit235" id="set_forward_no_connect">set_forward_no_connect</h3>
<div class="level3">

<p>
The message will be forwarded only if there is already an existing connection to the destination. It applies only to connection oriented protocols like TCP and TLS (TODO: SCTP), for UDP it will be ignored. The behavior depends in which route block the function is called:
</p>
<ul>
<li class="level1"><div class="li"> normal request route: affects stateless forwards and tm. For tm it affects all the branches and the possible retransmissions (in fact there are no retransission for tcp/tls).</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> onreply_route[0] (stateless): equivalent to set_reply_*() (it&#039;s better to use set_reply_* though)</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> onreply_route[!=0] ?: ignored</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> branch_route: affects the current branch only (all messages sent on this branch, like possible retransmissions and CANCELs).</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> onsend_route: like branch route</div>
</li>
</ul>

<p>
Example of usage:
</p>
<pre class="code">  route {
    ...
    if (lookup()) {
      //requests to local users. They are usually behind NAT so it does not make sense to try
      //to establish a new TCP connection 
      set_forward_no_connect();
      t_relay();
    }
    ...
  }</pre>

</div>

<h3 class="sectionedit236" id="set_forward_close">set_forward_close</h3>
<div class="level3">

<p>
Try to close the connection (the one on which the message is sent out) after forwarding the current message. Can be used in same route blocks as set_forward_no_connect().
</p>

<p>
Note: Use with care as you might not receive the replies anymore as the connection is closed.
</p>

</div>

<h3 class="sectionedit237" id="set_reply_no_connect">set_reply_no_connect</h3>
<div class="level3">

<p>
Like set_forward_no_connect(), but for replies to the current message (local generated replies and replies forwarded by tm). The behavior depends in which route block the function is called:
</p>
<ul>
<li class="level1"><div class="li"> normal request route: affects all replies sent back on the transaction (either local or forwarded) and all local stateless replies (sl_reply()).</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> onreply_route: affects the current reply (so the send_flags set in the onreply_route will be used if the reply for which they were set is the winning final reply or it&#039;s a provisional reply that is forwarded)</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> branch_route: ignored.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> onsend_route: ignored</div>
</li>
</ul>

<p>
Example of usage:
</p>
<pre class="code">  route[4] {
    //requests from local users. There are usually behind NAT so it does not make sense to try
    //to establish a new TCP connection for the replies
    set_reply_no_connect();
    // do authentication and call routing
    ...
  }</pre>

</div>

<h3 class="sectionedit238" id="set_reply_close">set_reply_close</h3>
<div class="level3">

<p>
Like set_reply_no_connect, but closes the TCP connection after sending. Can be used in same route blocks as set_reply_no_connect.
</p>

<p>
Example of usage:
</p>
<pre class="code">  route {
    ...
    if (...caller-is-not-registered...) {
      // reject unregistered client
      // if request was received via TCP/TLS close the connection, as
      // this may trigger re-registration of the client.
      set_reply_close();
      sl_send_reply(&quot;403&quot;,&quot;REGISTER first&quot;);
      exit;
    }
    ...
  }</pre>

</div>

<h3 class="sectionedit239" id="setavpflag">setavpflag</h3>
<div class="level3">

</div>

<h3 class="sectionedit240" id="setflag">setflag</h3>
<div class="level3">

<p>
Set a flag for current processed message. The value of the parameter can be in range of 0..31. The flags are used to mark the message for special processing (e.g., accounting) or to keep some state (e.g., message authenticated).
</p>

<p>
For more see <a href="http://www.kamailio.org/dokuwiki/doku.php/tutorials:openser-flag-operations" class="urlextern" title="http://www.kamailio.org/dokuwiki/doku.php/tutorials:openser-flag-operations"  rel="nofollow">http://www.kamailio.org/dokuwiki/doku.php/tutorials:openser-flag-operations</a> .
</p>

<p>
Example of usage:
</p>
<pre class="code">  setflag(3);</pre>

</div>

<h3 class="sectionedit241" id="strip">strip</h3>
<div class="level3">

<p>
Strip the first N-th characters from username of R-<abbr title="Uniform Resource Identifier">URI</abbr> (N is the value of the parameter).
</p>

<p>
Example of usage:
</p>
<pre class="code">  strip(3);</pre>

</div>

<h3 class="sectionedit242" id="strip_tail">strip_tail</h3>
<div class="level3">

<p>
Strip the last N-th characters from username of R-<abbr title="Uniform Resource Identifier">URI</abbr> (N is the value of the parameter).
</p>

<p>
Example of usage:
</p>
<pre class="code">strip_tail(3);</pre>

</div>

<h3 class="sectionedit243" id="udp_mtu_try_proto_proto">udp_mtu_try_proto(proto)</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> proto - TCP|TLS|SCTP|UDP - like udp_mtu_try_proto global parameter but works on a per packet basis and not globally.</div>
</li>
</ul>

<p>
Example:
</p>
<pre class="code">if($rd==&quot;10.10.10.10&quot;)
    udp_mtu_try_proto(SCTP);</pre>

</div>

<h3 class="sectionedit244" id="userphone">userphone</h3>
<div class="level3">

</div>

<h2 class="sectionedit245" id="routing_blocks">Routing blocks</h2>
<div class="level2">

<p>
SIP-Router has support for named routes. Names can be used instead of numbers in all the route commads or route declarations. 
</p>

<p>
Note: route(number) is equivalent to route(¡°number¡±)
</p>

<p>
Example:
</p>
<pre class="code">route{
  ...
  route(&quot;test&quot;);
  ...
}</pre>
<pre class="code">route[&quot;test&quot;]{
  ...
}</pre>

</div>

<h3 class="sectionedit246" id="route1">route</h3>
<div class="level3">

<p>
Request routing block. It contains a set of actions to be taken for SIP requests.
</p>

<p>
The main &#039;route&#039; block identified by &#039;route{¡­}&#039; or &#039;route[0]{¡­}&#039; is executed for each SIP request.
</p>

<p>
The implicit action after execution of the main route block is to drop the SIP request. To send a reply or forward the request, explicit actions must be called inside the route block.
</p>

<p>
Example of usage:
</p>
<pre class="code c">    route <span class="br0">&#123;</span>
         <span class="kw1">if</span><span class="br0">&#40;</span>is_method<span class="br0">&#40;</span><span class="st0">&quot;OPTIONS&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="co2"># send reply for each options request</span>
            sl_send_reply<span class="br0">&#40;</span><span class="st0">&quot;200&quot;</span><span class="sy0">,</span> <span class="st0">&quot;ok&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
            <a href="http://www.opengroup.org/onlinepubs/009695399/functions/exit.html"><span class="kw3">exit</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
         <span class="br0">&#125;</span>
         route<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
    route<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="br0">&#123;</span>
         <span class="co2"># forward according to uri</span>
         forward<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span></pre>

</div>

<h3 class="sectionedit247" id="branch_route">branch_route</h3>
<div class="level3">

<p>
Request&#039;s branch routing block. It contains a set of actions to be taken for each branch of a SIP request. It is executed only by TM module after it was armed via t_on_branch(¡°branch_route_index¡±).
</p>

<p>
Example of usage:
</p>
<pre class="code c">    route <span class="br0">&#123;</span>
        lookup<span class="br0">&#40;</span><span class="st0">&quot;location&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        t_on_branch<span class="br0">&#40;</span><span class="st0">&quot;1&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="kw1">if</span><span class="br0">&#40;</span><span class="sy0">!</span>t_relay<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            sl_send_reply<span class="br0">&#40;</span><span class="st0">&quot;500&quot;</span><span class="sy0">,</span> <span class="st0">&quot;relaying failed&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
    <span class="br0">&#125;</span>
    branch_route<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="br0">&#123;</span>
        <span class="kw1">if</span><span class="br0">&#40;</span>uri<span class="sy0">=</span>~<span class="st0">&quot;10\.10\.10].10&quot;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="co2"># discard branches that go to 10.10.10.10</span>
            drop<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
    <span class="br0">&#125;</span></pre>

</div>

<h3 class="sectionedit248" id="failure_route">failure_route</h3>
<div class="level3">

<p>
Failed transaction routing block. It contains a set of actions to be taken each transaction that received only negative replies (&gt;=300) for all branches. The &#039;failure_route&#039; is executed only by TM module after it was armed via t_on_failure(¡°failure_route_index¡±).
</p>

<p>
Note that in &#039;failure_route&#039; is processed the request that initiated the transaction, not the reply .
</p>

<p>
Example of usage:
</p>
<pre class="code c">    route <span class="br0">&#123;</span>
        lookup<span class="br0">&#40;</span><span class="st0">&quot;location&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        t_on_failure<span class="br0">&#40;</span><span class="st0">&quot;1&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="kw1">if</span><span class="br0">&#40;</span><span class="sy0">!</span>t_relay<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            sl_send_reply<span class="br0">&#40;</span><span class="st0">&quot;500&quot;</span><span class="sy0">,</span> <span class="st0">&quot;relaying failed&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
    <span class="br0">&#125;</span>
    failure_route<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="br0">&#123;</span>
        <span class="kw1">if</span><span class="br0">&#40;</span>is_method<span class="br0">&#40;</span><span class="st0">&quot;INVITE&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
             <span class="co2"># call failed - relay to voice mail</span>
             t_relay_to_udp<span class="br0">&#40;</span><span class="st0">&quot;voicemail.server.com&quot;</span><span class="sy0">,</span><span class="st0">&quot;5060&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
    <span class="br0">&#125;</span></pre>

</div>

<h3 class="sectionedit249" id="onreply_route">onreply_route</h3>
<div class="level3">

<p>
Reply routing block. It contains a set of actions to be taken for SIP replies.
</p>

<p>
The main &#039;onreply_route&#039; identified by &#039;onreply_route {¡­}&#039; or &#039;onreply_route[0] {¡­}&#039; is executed for all replies received.
</p>

<p>
Certain &#039;onreply_route&#039; blocks can be executed by TM module for special replies. For this, the &#039;onreply_route&#039; must be armed for the SIP requests whose replies should be processed within it, via t_on_reply(¡°onreply_route_index¡±).
</p>

<p>
Main &#039;onreply_route&#039; block is executed before a possible tm &#039;onreply_route&#039; block.
</p>
<pre class="code c">  route <span class="br0">&#123;</span>
      lookup<span class="br0">&#40;</span><span class="st0">&quot;location&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
      t_on_reply<span class="br0">&#40;</span><span class="st0">&quot;1&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
      <span class="kw1">if</span><span class="br0">&#40;</span><span class="sy0">!</span>t_relay<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
          sl_send_reply<span class="br0">&#40;</span><span class="st0">&quot;500&quot;</span><span class="sy0">,</span> <span class="st0">&quot;relaying failed&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
      <span class="br0">&#125;</span>
  <span class="br0">&#125;</span>
&nbsp;
  onreply_route <span class="br0">&#123;</span>
      <span class="kw1">if</span><span class="br0">&#40;</span><span class="sy0">!</span>t_check_trans<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
          drop<span class="sy0">;</span>
      <span class="br0">&#125;</span>
  <span class="br0">&#125;</span>
&nbsp;
  onreply_route<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="br0">&#123;</span>
      <span class="kw1">if</span><span class="br0">&#40;</span>status<span class="sy0">=</span>~<span class="st0">&quot;1[0-9][0-9]&quot;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
           <a href="http://www.opengroup.org/onlinepubs/009695399/functions/log.html"><span class="kw3">log</span></a><span class="br0">&#40;</span><span class="st0">&quot;provisional response<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
      <span class="br0">&#125;</span>
  <span class="br0">&#125;</span></pre>

</div>

<h3 class="sectionedit250" id="onsend_route">onsend_route</h3>
<div class="level3">

<p>
The route is executed in when a SIP request is sent out. Only a limited number of commands are allowed (drop, if + all the checks, msg flag manipulations, send(), log(), textops::search()).
</p>

<p>
In this route the final destination of the message is available an can be checked (with snd_ip, snd_port, to_ip, to_port, snd_proto, snd_af).
</p>

<p>
This route is executed only when forwarding requests - it is not executed for replies, retransmissions, or locally generated messages (e.g. via fifo uac).
</p>

<p>
Example:
</p>
<pre class="code">onsend_route{
  if(to_ip==1.2.3.4 &amp;&amp; !isflagset(12)){
    log(1, &quot;message blocked\n&quot;);
    drop;
  }
}</pre>
<ul>
<li class="level1"><div class="li"> snd_ip, snd_port - behave like src_ip/src_port, but contain the ip/port ser will use to send the message</div>
</li>
<li class="level1"><div class="li"> to_ip, to_port - like above, but contain the ip/port the message will be sent to (not to be confused with dst_ip/dst_port, which are the destination of the original received request: ser&#039;s ip and port on which the message was received)</div>
</li>
<li class="level1"><div class="li"> snd_proto, snd_af - behave like proto/af but contain the protocol/address family that ser will use to send the message</div>
</li>
<li class="level1"><div class="li"> msg:len - when used in an onsend_route, msg:len will contain the length of the message on the wire (after all the changes in the script are applied, Vias are added a.s.o) and not the lentgh of the original message.</div>
</li>
</ul>

</div>

<h3 class="sectionedit251" id="event_route">event_route</h3>
<div class="level3">

<p>
Generic type of route executed when specific events happen.
</p>

<p>
Prototype: event_route[groupid:eventid]
</p>
<ul>
<li class="level1"><div class="li"> groupid - should be the name of the module that triggers the event</div>
</li>
<li class="level1"><div class="li"> eventid - some meaningful short text describing the event</div>
</li>
</ul>

<p>
Implementations:
</p>
<ul>
<li class="level1"><div class="li"> <strong>event_route[htable:mod-init]</strong> - executed by <strong>htable</strong> module after all modules have been initialised. Good for initialising values in hash tables.</div>
</li>
</ul>
<pre class="code c">modparam<span class="br0">&#40;</span><span class="st0">&quot;htable&quot;</span><span class="sy0">,</span> <span class="st0">&quot;htable&quot;</span><span class="sy0">,</span> <span class="st0">&quot;a=&gt;size=4;&quot;</span><span class="br0">&#41;</span>
&nbsp;
event_route<span class="br0">&#91;</span>htable<span class="sy0">:</span>mod<span class="sy0">-</span>init<span class="br0">&#93;</span> <span class="br0">&#123;</span>
  $sht<span class="br0">&#40;</span>a<span class="sy0">=&gt;</span>calls<span class="sy0">-</span>to<span class="sy0">::</span>10.10.10.10<span class="br0">&#41;</span> <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span>
  $sht<span class="br0">&#40;</span>a<span class="sy0">=&gt;</span>max<span class="sy0">-</span>calls<span class="sy0">-</span>to<span class="sy0">::</span>10.10.10.10<span class="br0">&#41;</span> <span class="sy0">=</span> <span class="nu0">100</span><span class="sy0">;</span>
<span class="br0">&#125;</span>
&nbsp;
route <span class="br0">&#123;</span>
  <span class="kw1">if</span><span class="br0">&#40;</span>is_method<span class="br0">&#40;</span><span class="st0">&quot;INVITE&quot;</span><span class="br0">&#41;</span> <span class="sy0">&amp;&amp;</span> <span class="sy0">!</span>has_totag<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="kw1">switch</span><span class="br0">&#40;</span>$rd<span class="br0">&#41;</span> <span class="br0">&#123;</span>
      <span class="kw1">case</span> <span class="st0">&quot;10.10.10.10&quot;</span><span class="sy0">:</span>
        lock<span class="br0">&#40;</span><span class="st0">&quot;calls-to::10.10.10.10&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        $sht<span class="br0">&#40;</span>a<span class="sy0">=&gt;</span>calls<span class="sy0">-</span>to<span class="sy0">::</span>10.10.10.10<span class="br0">&#41;</span> <span class="sy0">=</span>
            $sht<span class="br0">&#40;</span>a<span class="sy0">=&gt;</span>calls<span class="sy0">-</span>to<span class="sy0">::</span>10.10.10.10<span class="br0">&#41;</span> <span class="sy0">+</span> <span class="nu0">1</span><span class="sy0">;</span>
        unlock<span class="br0">&#40;</span><span class="st0">&quot;calls-to::10.10.10.10&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="kw1">if</span><span class="br0">&#40;</span>$sht<span class="br0">&#40;</span>a<span class="sy0">=&gt;</span>calls<span class="sy0">-</span>to<span class="sy0">::</span>10.10.10.10<span class="br0">&#41;</span><span class="sy0">&gt;</span>$sht<span class="br0">&#40;</span>a<span class="sy0">=&gt;</span>max<span class="sy0">-</span>calls<span class="sy0">-</span>to<span class="sy0">::</span>10.10.10.10<span class="br0">&#41;</span><span class="br0">&#41;</span>
        <span class="br0">&#123;</span>
           sl_send_reply<span class="br0">&#40;</span><span class="st0">&quot;500&quot;</span><span class="sy0">,</span> <span class="st0">&quot;To many calls to .10&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
           <a href="http://www.opengroup.org/onlinepubs/009695399/functions/exit.html"><span class="kw3">exit</span></a><span class="sy0">;</span>
        <span class="br0">&#125;</span>
      <span class="kw2">break</span><span class="sy0">;</span>
      ...
    <span class="br0">&#125;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
<ul>
<li class="level1"><div class="li"> <strong>event_route [tm:local-request]</strong> - executed on locally generated requests.</div>
</li>
</ul>
<pre class="code c">event_route <span class="br0">&#91;</span>tm<span class="sy0">:</span>local<span class="sy0">-</span>request<span class="br0">&#93;</span> <span class="br0">&#123;</span> <span class="co2"># Handle locally generated requests</span>
  xlog<span class="br0">&#40;</span><span class="st0">&quot;L_INFO&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Routing locally generated $rm to &lt;$ru&gt;<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  t_set_fr<span class="br0">&#40;</span><span class="nu0">10000</span><span class="sy0">,</span> <span class="nu0">10000</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>
<ul>
<li class="level1"><div class="li"> <strong>event_route [tm:branch-failure]</strong> - executed on all failure responses.</div>
</li>
</ul>
<pre class="code c">event_route <span class="br0">&#91;</span>tm<span class="sy0">:</span>failure<span class="sy0">-</span>branch<span class="br0">&#93;</span> <span class="br0">&#123;</span> <span class="co2"># Handle failure response</span>
  xlog<span class="br0">&#40;</span><span class="st0">&quot;L_INFO&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Handling $T_reply_code response to $rm to &lt;$ru&gt;<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="kw1">if</span> <span class="br0">&#40;</span>t_check_status<span class="br0">&#40;</span><span class="st0">&quot;430&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="co2"># Outbound flow failed</span>
    unregister<span class="br0">&#40;</span><span class="st0">&quot;location&quot;</span><span class="sy0">,</span> <span class="st0">&quot;$tu&quot;</span><span class="sy0">,</span> <span class="st0">&quot;$T_reply_ruid&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>t_next_contact_flow<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
      t_relay<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>

</div>

<h2 class="sectionedit252" id="script_statements">Script statements</h2>
<div class="level2">

</div>

<h3 class="sectionedit253" id="if">if</h3>
<div class="level3">

<p>
IF-ELSE statement
</p>

<p>
Prototype:
</p>
<pre class="code">    if(expr) {
       actions;
    } else {
       actions;
    }</pre>

<p>
The &#039;expr&#039; should be a valid logical expression.
</p>

<p>
The logical operators that can be used in &#039;expr&#039;:
</p>
<pre class="code">  ==      equal
  !=      not equal
  =~      regular expression matching: Note: Posix regular expressions will be used, e.g. use [[:digit:]]{3} instead of \d\d\d
  !~      regular expression not-matching (NOT PORTED from Kamailio 1.x, use &#039;!(x =~ y)&#039;)
  &gt;       greater
  &gt;=      greater or equal
  &lt;       less
  &lt;=      less or equal
  &amp;&amp;      logical AND
  ||      logical OR
  !       logical NOT
  [ ... ] test operator - inside can be any arithmetic expression</pre>

<p>
Example of usage:
</p>
<pre class="code">  if(is_method(&quot;INVITE&quot;))
  {
      log(&quot;this sip message is an invite\n&quot;);
  } else {
      log(&quot;this sip message is not an invite\n&quot;);
  }</pre>

</div>

<h3 class="sectionedit254" id="switch">switch</h3>
<div class="level3">

<p>
SWITCH statement - it can be used to test the value of a pseudo-variable. 
</p>

<p>
IMPORTANT NOTE: &#039;break&#039; can be used only to mark the end of a &#039;case&#039; branch (as it is in shell scripts). If you are trying to use &#039;break&#039; outside a &#039;case&#039; block the script will return error ¨C you must use &#039;return&#039; there.
</p>

<p>
Example of usage:
</p>
<pre class="code">    route {
        route(1);
        switch($retcode)
        {
            case -1:
                log(&quot;process INVITE requests here\n&quot;);
            break;
            case 1:
                log(&quot;process REGISTER requests here\n&quot;);
            break;
            case 2:
            case 3:
                log(&quot;process SUBSCRIBE and NOTIFY requests here\n&quot;);
            break;
            default:
                log(&quot;process other requests here\n&quot;);
       }

        # switch of R-URI username
        switch($rU)
        {
            case &quot;101&quot;:
                log(&quot;destination number is 101\n&quot;);
            break;
            case &quot;102&quot;:
                log(&quot;destination number is 102\n&quot;);
            break;
            case &quot;103&quot;:
            case &quot;104&quot;:
                log(&quot;destination number is 103 or 104\n&quot;);
            break;
            default:
                log(&quot;unknown destination number\n&quot;);
       }
    }

    route[1]{
        if(is_method(&quot;INVITE&quot;))
        {
            return(-1);
        };
        if(is_method(&quot;REGISTER&quot;))
            return(1);
        }
        if(is_method(&quot;SUBSCRIBE&quot;))
            return(2);
        }
        if(is_method(&quot;NOTIFY&quot;))
            return(3);
        }
        return(-2);
    }</pre>

<p>
NOTE: take care while using &#039;return&#039; - &#039;return(0)&#039; stops the execution of the script.
</p>

</div>

<h3 class="sectionedit255" id="while">while</h3>
<div class="level3">

<p>
while statement
</p>

<p>
Example of usage:
</p>
<pre class="code">  
  $var(i) = 0;
  while($var(i) &lt; 10)
  {
      xlog(&quot;counter: $var(i)\n&quot;);
      $var(i) = $var(i) + 1;
  }</pre>

</div>

<h2 class="sectionedit256" id="script_operations">Script operations</h2>
<div class="level2">

<p>
Assignments together with string and arithmetic operations can be done directly in configuration file.
</p>

</div>

<h3 class="sectionedit257" id="assignment">Assignment</h3>
<div class="level3">

<p>
Assignments can be done like in C, via &#039;=&#039; (equal). The following pseudo-variables can be used in left side of an assignment:
</p>
<ul>
<li class="level1"><div class="li"> Unordered List Item AVPs - to set the value of an AVP</div>
</li>
<li class="level1"><div class="li"> script variables ($var(¡­)) -  to set the value of a script variable</div>
</li>
<li class="level1"><div class="li"> shared variables ($shv(¡­))</div>
</li>
<li class="level1"><div class="li"> $ru - to set R-<abbr title="Uniform Resource Identifier">URI</abbr></div>
</li>
<li class="level1"><div class="li"> $rd - to set domain part of R-<abbr title="Uniform Resource Identifier">URI</abbr></div>
</li>
<li class="level1"><div class="li"> $rU - to set user part of R-<abbr title="Uniform Resource Identifier">URI</abbr></div>
</li>
<li class="level1"><div class="li"> $rp - to set the port of R-<abbr title="Uniform Resource Identifier">URI</abbr></div>
</li>
<li class="level1"><div class="li"> $du - to set dst <abbr title="Uniform Resource Identifier">URI</abbr></div>
</li>
<li class="level1"><div class="li"> $fs - to set send socket</div>
</li>
<li class="level1"><div class="li"> $br - to set branch</div>
</li>
<li class="level1"><div class="li"> $mf - to set message flags value</div>
</li>
<li class="level1"><div class="li"> $sf - to set script flags value</div>
</li>
<li class="level1"><div class="li"> $bf - to set branch flags value</div>
</li>
</ul>
<pre class="code">$var(a) = 123;</pre>

<p>
For avp&#039;s there a way to remove all values and assign a single value in one statement (in other words, delete existing AVPs with same name, add a new one with the right side value). This replaces the := assignment operator from kamailio &lt; 3.0.
</p>
<pre class="code">$(avp(i:3)[*]) = 123;
$(avp(i:3)[*]) = $null;</pre>

</div>

<h3 class="sectionedit258" id="string_operations">String operations</h3>
<div class="level3">

<p>
For strings, &#039;+&#039; is available to concatenate.
</p>
<pre class="code">$var(a) = &quot;test&quot;;
$var(b) = &quot;sip:&quot; + $var(a) + &quot;@&quot; + $fd;</pre>

</div>

<h3 class="sectionedit259" id="arithmetic_operations">Arithmetic operations</h3>
<div class="level3">

<p>
For numbers, one can use:
</p>
<ul>
<li class="level1"><div class="li"> + : plus</div>
</li>
<li class="level1"><div class="li"> - : minus</div>
</li>
<li class="level1"><div class="li"> / : divide</div>
</li>
<li class="level1"><div class="li"> * : multiply</div>
</li>
<li class="level1"><div class="li"> % : modulo (Kamailio uses &#039;mod&#039; instead of &#039;%&#039;)</div>
</li>
<li class="level1"><div class="li"> | : bitwise OR</div>
</li>
<li class="level1"><div class="li"> &amp; : bitwise AND</div>
</li>
<li class="level1"><div class="li"> ^ : bitwise XOR</div>
</li>
<li class="level1"><div class="li"> ~ : bitwise NOT</div>
</li>
<li class="level1"><div class="li"> ? : bitwise left shift</div>
</li>
<li class="level1"><div class="li"> ? : bitwise right shift</div>
</li>
</ul>

<p>
Example:
</p>
<pre class="code">$var(a) = 4 + ( 7 &amp; ( ~2 ) );</pre>

<p>
NOTE: to ensure the priority of operands in expression evaluations do use <em class="u">parenthesis</em>.
</p>

<p>
Arithmetic expressions can be used in condition expressions via test operator &#039; [ ¡­ ] &#039;.
</p>
<pre class="code">if( [ $var(a) &amp; 4 ] )
    log(&quot;var a has third bit set\n&quot;);</pre>

</div>

<h2 class="sectionedit260" id="operators">Operators</h2>
<div class="level2">
<ol>
<li class="level1"><div class="li"> type casts operators: (int), (str).</div>
</li>
<li class="level1"><div class="li"> string comparison: eq, ne</div>
</li>
<li class="level1"><div class="li"> integer comparison: ieq, ine </div>
</li>
</ol>

<p>
Note: The names are not yet final (use them at your own risk). Future version might use ==/!= only for ints (ieq/ine) and eq/ne for strings (under debate). They are almost equivalent to == or !=, but they force the conversion of their operands (eq to string and ieq to int), allowing among other things better type checking on startup and more optimizations.
</p>

<p>
Non equiv. examples:
</p>

<p>
0 == ¡°¡± (true) is not equivalent to 0 eq ¡°¡± (false: it evaluates to ¡°0¡± eq ¡°¡±).
</p>

<p>
¡°a¡± ieq ¡°b¡± (true: (int)¡°a¡± is 0 and (int)¡°b¡± is 0) is not equivalent to ¡°a¡± == ¡°b¡± (false).
</p>

<p>
Note: internally == and != are converted on startup to eq/ne/ieq/ine  whenever possible (both operand types can be safely determined at start time and they are the same). 
</p>
<ol>
<li class="level1"><div class="li"> sip-router tries to guess what the user wanted when operators that support multiple types are used on different typed operands. In general convert the right operand to the type of the left operand and then perform the operation. Exception: the left operand is undef. This applies to the following operators: +, == and !=.</div>
</li>
</ol>

<p>
     Special case: undef as left operand:
</p>
<pre class="code">   For +: undef + expr -&gt; undef is converted to string =&gt; &quot;&quoquot; + expr.
   For == and !=:   undef == expr -&gt; undef is converted to type_of expr.
   If expr is undef, then undef == undef is true (internally is converted
   to string).</pre>
<ol>
<li class="level1"><div class="li"> expression evaluation changes: sip-router will auto-convert to integer or string in function of the operators: </div>
</li>
</ol>

<p>
       int(undef)==0,  int(¡°¡±)==0, int(¡°123¡±)==123, int(¡°abc¡±)==0
</p>
<pre class="code">     str(undef)==&quot;&quot;, str(123)==&quot;123&quot;.</pre>
<ol>
<li class="level1"><div class="li"> script operators for dealing with empty/undefined variables</div>
</li>
</ol>

<p>
      defined expr - returns true if expr is defined, and false if not.
</p>
<pre class="code">                   Note: only a standalone avp or pvar can be
                   undefined, everything else is defined.
    strlen(expr) - returns the lenght of expr evaluated as string.
    strempty(expr) - returns true if expr evaluates to the empty
                     string (equivalent to expr==&quot;&quot;).
    Example: if (defined $v &amp;&amp; !strempty($v)) $len=strlen($v);</pre>

</div>

                    <!-- wikipage stop -->
                                    </div>

                <div class="docInfo"><bdi>cookbooks/4.2.x/core.txt</bdi> ¡¤ Last modified: 2015/04/15 18:34 by <bdi>miconda</bdi></div>

                            </div></div><!-- /content -->

            <hr class="a11y" />

            <!-- PAGE ACTIONS -->
            <div id="dokuwiki__pagetools">
                <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li><a href="/wiki/cookbooks/4.2.x/core?do=edit"  class="action source" accesskey="v" rel="nofollow" title="Show pagesource [V]"><span>Show pagesource</span></a></li><li><a href="/wiki/cookbooks/4.2.x/core?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Old revisions [O]"><span>Old revisions</span></a></li><li><a href="/wiki/cookbooks/4.2.x/core?do=backlink"  class="action backlink" rel="nofollow" title="Backlinks"><span>Backlinks</span></a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]"><span>Back to top</span></a></li>                    </ul>
                </div>
            </div>
        </div><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer"><div class="pad">
    
    <div class="buttons">
                <a href="http://www.dokuwiki.org/donate" title="Donate" ><img
            src="/wiki/lib/tpl/dokuwiki/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="http://www.php.net" title="Powered by PHP" ><img
            src="/wiki/lib/tpl/dokuwiki/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="http://validator.w3.org/check/referer" title="Valid HTML5" ><img
            src="/wiki/lib/tpl/dokuwiki/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" ><img
            src="/wiki/lib/tpl/dokuwiki/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="http://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="/wiki/lib/tpl/dokuwiki/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
    </div>
</div></div><!-- /footer -->

    </div></div><!-- /site -->

    <div class="no"><img src="/wiki/lib/exe/indexer.php?id=cookbooks%3A4.2.x%3Acore&amp;1437723290" width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div>    <!--[if ( lte IE 7 | IE 8 ) ]></div><![endif]-->
</body>
</html>
